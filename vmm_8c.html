<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>oneOS: src/kernel/mem/vmm/vmm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">oneOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cbd7f246bdf7dc0a50281a272327e6ed.html">kernel</a></li><li class="navelem"><a class="el" href="dir_f6341b0df0d749651e88bef82e0c7acd.html">mem</a></li><li class="navelem"><a class="el" href="dir_f31f8c1ada763d6da9b60bffdaf33485.html">vmm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">vmm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;<a class="el" href="log_8h_source.html">log.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="kmalloc_8h_source.html">mem/kmalloc.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2mem_2vmm_2vmm_8h_source.html">mem/vmm/vmm.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="zoner_8h_source.html">mem/vmm/zoner.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="memmap_8h_source.html">platform/x86/memmap.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="system_8h_source.html">platform/x86/system.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="tasking_8h_source.html">tasking/tasking.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="kassert_8h_source.html">utils/kassert.h</a>&gt;</code><br />
</div>
<p><a href="vmm_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acb0581d576bd40d996ec64ba943d834d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#acb0581d576bd40d996ec64ba943d834d">pdir_t</a>&#160;&#160;&#160;<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a></td></tr>
<tr class="separator:acb0581d576bd40d996ec64ba943d834d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3711dfec5fdda52c3ea8f3884f92e544"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(a)&#160;&#160;&#160;(((a) &gt;&gt; 22) &amp; 0x3ff)</td></tr>
<tr class="separator:a3711dfec5fdda52c3ea8f3884f92e544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef0153575274ce9a5768ce3f2501d81b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#aef0153575274ce9a5768ce3f2501d81b">VMM_OFFSET_IN_TABLE</a>(a)&#160;&#160;&#160;(((a) &gt;&gt; 12) &amp; 0x3ff)</td></tr>
<tr class="separator:aef0153575274ce9a5768ce3f2501d81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3671ae236619055a151e5dbaed3d19fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a3671ae236619055a151e5dbaed3d19fb">VMM_OFFSET_IN_PAGE</a>(a)&#160;&#160;&#160;((a)&amp;0xfff)</td></tr>
<tr class="separator:a3671ae236619055a151e5dbaed3d19fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a64107022044bfe87e55318510db6f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(addr)&#160;&#160;&#160;(addr / <a class="el" href="src_2boot_2x86_2stage2_2mem_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>)</td></tr>
<tr class="separator:a6a64107022044bfe87e55318510db6f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75169164a5502d98dc9b1fe27ec57ff7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a75169164a5502d98dc9b1fe27ec57ff7">PAGE_START</a>(vaddr)&#160;&#160;&#160;((vaddr &gt;&gt; 12) &lt;&lt; 12)</td></tr>
<tr class="separator:a75169164a5502d98dc9b1fe27ec57ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94be9fd98a7a3e28deb2d14841bc5819"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>&#160;&#160;&#160;768</td></tr>
<tr class="separator:a94be9fd98a7a3e28deb2d14841bc5819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f43ad76f35d72d6682c842ed691653"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a29f43ad76f35d72d6682c842ed691653">VMM_USER_TABLES_START</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a29f43ad76f35d72d6682c842ed691653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ae8c00bdaaa9569270b2f22410da7eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a3ae8c00bdaaa9569270b2f22410da7eb">IS_INDIVIDUAL_PER_DIR</a>(index)&#160;&#160;&#160;(index &lt; <a class="el" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a> || (index == <a class="el" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(pspace_zone.start)))</td></tr>
<tr class="separator:a3ae8c00bdaaa9569270b2f22410da7eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae85bc0fd630a61ea106889a6e9588d3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ae85bc0fd630a61ea106889a6e9588d3f">vmm_kernel_pdir_phys2virt</a>(paddr)&#160;&#160;&#160;((void*)((<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)paddr + <a class="el" href="config_8h.html#a0369a136c68b1e47cd6fcfe03cad8c53">KERNEL_BASE</a> - <a class="el" href="memmap_8h.html#a8c46e7070c87b70c8f999bf02aa35c73">KERNEL_PM_BASE</a>))</td></tr>
<tr class="separator:ae85bc0fd630a61ea106889a6e9588d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afa76069bfdaf7ec9602e4c681cc765a8"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#afa76069bfdaf7ec9602e4c681cc765a8">_vmm_pspace_get_vaddr_of_active_pdir</a> ()</td></tr>
<tr class="separator:afa76069bfdaf7ec9602e4c681cc765a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ad998657fdc90229287337385aaa818"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a5ad998657fdc90229287337385aaa818">_vmm_pspace_get_nth_active_ptable</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> n)</td></tr>
<tr class="separator:a5ad998657fdc90229287337385aaa818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadbf1e80ec16fe23449ee1e43d8a6280"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:aadbf1e80ec16fe23449ee1e43d8a6280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d9ffd126bc6c4fe342faa7f58d14f95"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a6d9ffd126bc6c4fe342faa7f58d14f95">_vmm_split_pspace</a> ()</td></tr>
<tr class="separator:a6d9ffd126bc6c4fe342faa7f58d14f95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f394de96dbb406fb49fd21f05870b2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a27f394de96dbb406fb49fd21f05870b2">_vmm_pspace_init</a> ()</td></tr>
<tr class="separator:a27f394de96dbb406fb49fd21f05870b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a719e8c1ccd54ec6a9581f2ddfe71a791"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="src_2boot_2x86_2stage2_2mem_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a719e8c1ccd54ec6a9581f2ddfe71a791">_vmm_pspace_gen</a> ()</td></tr>
<tr class="separator:a719e8c1ccd54ec6a9581f2ddfe71a791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ba5bf10c003badfe62ab1914948633"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a76ba5bf10c003badfe62ab1914948633">_vmm_kernel_convert_vaddr2paddr</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:a76ba5bf10c003badfe62ab1914948633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae922e29314c0d14760e10364e4d06a24"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ae922e29314c0d14760e10364e4d06a24">_vmm_convert_vaddr2paddr</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:ae922e29314c0d14760e10364e4d06a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f6efe6da67baa73c4d68e72d47a97a9"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a8f6efe6da67baa73c4d68e72d47a97a9">_vmm_alloc_kernel_block</a> ()</td></tr>
<tr class="separator:a8f6efe6da67baa73c4d68e72d47a97a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c129dfab11d2a20a093d79f78acdb7a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a1c129dfab11d2a20a093d79f78acdb7a">_vmm_init_switch_to_kernel_pdir</a> ()</td></tr>
<tr class="separator:a1c129dfab11d2a20a093d79f78acdb7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af61bce625271f219e9c1ce3fc240b842"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#af61bce625271f219e9c1ce3fc240b842">_vmm_map_init_kernel_pages</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:af61bce625271f219e9c1ce3fc240b842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f9a860b1f1131d396a2ddbc855064e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a63f9a860b1f1131d396a2ddbc855064e">_vmm_create_kernel_ptables</a> ()</td></tr>
<tr class="separator:a63f9a860b1f1131d396a2ddbc855064e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace837bd97087269efb03120fdfad256c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ace837bd97087269efb03120fdfad256c">_vmm_map_kernel</a> ()</td></tr>
<tr class="separator:ace837bd97087269efb03120fdfad256c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9748d8fe2dac47761d554c0db0757729"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a9748d8fe2dac47761d554c0db0757729">_vmm_round_ceil_to_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> value)</td></tr>
<tr class="separator:a9748d8fe2dac47761d554c0db0757729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f7e06398ef8a3a76bcefc41fcacbf0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a38f7e06398ef8a3a76bcefc41fcacbf0">_vmm_round_floor_to_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> value)</td></tr>
<tr class="separator:a38f7e06398ef8a3a76bcefc41fcacbf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7abcdb4891827beb4b8c16a9434b595"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ac7abcdb4891827beb4b8c16a9434b595">_vmm_is_copy_on_write</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:ac7abcdb4891827beb4b8c16a9434b595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bb7e26783908ccc1e52e0db7a86bada"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a1bb7e26783908ccc1e52e0db7a86bada">_vmm_resolve_copy_on_write</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:a1bb7e26783908ccc1e52e0db7a86bada"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a866d9ff3a2d0fc67212d80c05303ac32"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a866d9ff3a2d0fc67212d80c05303ac32">_vmm_ensure_cow_for_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:a866d9ff3a2d0fc67212d80c05303ac32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9d15e358e8aec9fc1d9691f11ccbf38"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#af9d15e358e8aec9fc1d9691f11ccbf38">_vmm_ensure_cow_for_range</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> length)</td></tr>
<tr class="separator:af9d15e358e8aec9fc1d9691f11ccbf38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9956517ffdd028c63384883de128303"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ad9956517ffdd028c63384883de128303">_vmm_copy_page_to_resolve_cow</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr, <a class="el" href="structptable__t.html">ptable_t</a> *src_ptable)</td></tr>
<tr class="separator:ad9956517ffdd028c63384883de128303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e02799fa4e188139bc5551aa994db5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#af7e02799fa4e188139bc5551aa994db5">_vmm_is_zeroing_on_demand</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:af7e02799fa4e188139bc5551aa994db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c15c4bfaea211a22150f3dbfbdfeea"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a76c15c4bfaea211a22150f3dbfbdfeea">_vmm_resolve_zeroing_on_demand</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:a76c15c4bfaea211a22150f3dbfbdfeea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa9e823e5347e58f73b8d687ba466123"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#afa9e823e5347e58f73b8d687ba466123">_vmm_self_test</a> ()</td></tr>
<tr class="separator:afa9e823e5347e58f73b8d687ba466123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab606d49a29a18ddfe83fb9b270b88dee"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ab606d49a29a18ddfe83fb9b270b88dee">_vmm_free_pspace</a> (<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *pdir)</td></tr>
<tr class="separator:ab606d49a29a18ddfe83fb9b270b88dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ed73aa44bec054aca84591d0510593"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#af4ed73aa44bec054aca84591d0510593">vmm_setup</a> ()</td></tr>
<tr class="separator:af4ed73aa44bec054aca84591d0510593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab22a83d25d138540fce05ecdda830a11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2boot_2x86_2stage2_2mem_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a> (<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *pdir, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:ab22a83d25d138540fce05ecdda830a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35d8684b806f9433a8d62abca47379a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="src_2boot_2x86_2stage2_2mem_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a> (<a class="el" href="structptable__t.html">ptable_t</a> *ptable, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:a35d8684b806f9433a8d62abca47379a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77857596f0bc43a2d578e0ad8a058e98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a77857596f0bc43a2d578e0ad8a058e98">vmm_allocate_ptable</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:a77857596f0bc43a2d578e0ad8a058e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7acf4c80aa9fe5ecd3f0dd5a2d956bc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#af7acf4c80aa9fe5ecd3f0dd5a2d956bc">vmm_free_ptable</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> ptable_indx)</td></tr>
<tr class="separator:af7acf4c80aa9fe5ecd3f0dd5a2d956bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc87f9db4fc5d3811872421588e4dd2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> settings)</td></tr>
<tr class="separator:a5fc87f9db4fc5d3811872421588e4dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae843e6ecc554a821adbd89275b74c41d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ae843e6ecc554a821adbd89275b74c41d">vmm_unmap_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:ae843e6ecc554a821adbd89275b74c41d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a537c53b02c9ab34340c2d3b285a29ca7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a537c53b02c9ab34340c2d3b285a29ca7">vmm_map_pages</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> n_pages, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> settings)</td></tr>
<tr class="separator:a537c53b02c9ab34340c2d3b285a29ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a774ca181f37be6f6c59ad293a5390f90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a774ca181f37be6f6c59ad293a5390f90">vmm_new_user_pdir</a> ()</td></tr>
<tr class="separator:a774ca181f37be6f6c59ad293a5390f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e7e37ce3fa39079507669988c823a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a56e7e37ce3fa39079507669988c823a2">vmm_new_forked_user_pdir</a> ()</td></tr>
<tr class="separator:a56e7e37ce3fa39079507669988c823a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a553d7d0c83eb3254f922e6f983b92748"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a553d7d0c83eb3254f922e6f983b92748">vmm_free_pdir</a> (<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *pdir)</td></tr>
<tr class="separator:a553d7d0c83eb3254f922e6f983b92748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78abef76fad7bf15b21e06caca47ddae"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a78abef76fad7bf15b21e06caca47ddae">vmm_bring_to_kernel</a> (<a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *src, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> length)</td></tr>
<tr class="separator:a78abef76fad7bf15b21e06caca47ddae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27ff36d5e686f99170ec9053e67d2368"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a27ff36d5e686f99170ec9053e67d2368">vmm_copy_to_pdir</a> (<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *pdir, <a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *src, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> dest_vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> length)</td></tr>
<tr class="separator:a27ff36d5e686f99170ec9053e67d2368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb5a566ddf130d9a4f0b49ee6a57b7fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#adb5a566ddf130d9a4f0b49ee6a57b7fe">vmm_zero_user_pages</a> (<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *pdir)</td></tr>
<tr class="separator:adb5a566ddf130d9a4f0b49ee6a57b7fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af410d2e8015ab9e19050defa16c05efb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a> ()</td></tr>
<tr class="separator:af410d2e8015ab9e19050defa16c05efb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a608b32b82fa4ba69fd3fee442f8beb6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a608b32b82fa4ba69fd3fee442f8beb6f">vmm_get_kernel_pdir</a> ()</td></tr>
<tr class="separator:a608b32b82fa4ba69fd3fee442f8beb6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78710242c8a4d6cb0932266aa8700781"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a78710242c8a4d6cb0932266aa8700781">vmm_tune_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> settings)</td></tr>
<tr class="separator:a78710242c8a4d6cb0932266aa8700781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6f63bcf4d688f1ce6fcb8bc782cd32"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a6f6f63bcf4d688f1ce6fcb8bc782cd32">vmm_tune_pages</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> length, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> settings)</td></tr>
<tr class="separator:a6f6f63bcf4d688f1ce6fcb8bc782cd32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cfe8792eb0ed88e04de2397ebb2ddae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a2cfe8792eb0ed88e04de2397ebb2ddae">vmm_load_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> settings)</td></tr>
<tr class="separator:a2cfe8792eb0ed88e04de2397ebb2ddae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb159d2c5072a9db8bddaf464792a4bc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#abb159d2c5072a9db8bddaf464792a4bc">vmm_copy_page</a> (<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> to_vaddr, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> src_vaddr, <a class="el" href="structptable__t.html">ptable_t</a> *src_ptable)</td></tr>
<tr class="separator:abb159d2c5072a9db8bddaf464792a4bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348cee778d57e7d29e0222c42a4fa897"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a348cee778d57e7d29e0222c42a4fa897">vmm_alloc_page</a> (<a class="el" href="src_2boot_2x86_2stage2_2mem_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a> *page)</td></tr>
<tr class="separator:a348cee778d57e7d29e0222c42a4fa897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36800aa16e5a6477b1ec81cafa6c330c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a36800aa16e5a6477b1ec81cafa6c330c">vmm_free_page</a> (<a class="el" href="src_2boot_2x86_2stage2_2mem_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a> *page)</td></tr>
<tr class="separator:a36800aa16e5a6477b1ec81cafa6c330c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ba8dfdae010da851171d247c3eaf8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a16ba8dfdae010da851171d247c3eaf8f">vmm_page_fault_handler</a> (<a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> info, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr)</td></tr>
<tr class="separator:a16ba8dfdae010da851171d247c3eaf8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7f59ea1a3f32fdbcb8e9a322ff098ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ad7f59ea1a3f32fdbcb8e9a322ff098ef">vmm_switch_pdir</a> (<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *pdir)</td></tr>
<tr class="separator:ad7f59ea1a3f32fdbcb8e9a322ff098ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c7da31e77d0ada3ff22ef672db87b46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a1c7da31e77d0ada3ff22ef672db87b46">vmm_enable_paging</a> ()</td></tr>
<tr class="separator:a1c7da31e77d0ada3ff22ef672db87b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a978febf08ddd534ae90c56fc9c93f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a26a978febf08ddd534ae90c56fc9c93f">vmm_disable_paging</a> ()</td></tr>
<tr class="separator:a26a978febf08ddd534ae90c56fc9c93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75361d9553a4cc2b336609f64e4c34c6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a75361d9553a4cc2b336609f64e4c34c6">vmm_test_pspace_vaddr_of_active_ptable</a> ()</td></tr>
<tr class="separator:a75361d9553a4cc2b336609f64e4c34c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0621c6ce03a60c64786fc206880d854f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a></td></tr>
<tr class="separator:a0621c6ce03a60c64786fc206880d854f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80d3bb55f78af993af1528942aec0119"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a></td></tr>
<tr class="separator:a80d3bb55f78af993af1528942aec0119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71f5fd0fba588a759b27cb0fbd63395"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="zoner_8h.html#acffe166c8e6cd29702dbb58801c54ccf">zone_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a></td></tr>
<tr class="separator:ab71f5fd0fba588a759b27cb0fbd63395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91bba8fda41b781948a9379cc516320d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a></td></tr>
<tr class="separator:a91bba8fda41b781948a9379cc516320d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6a64107022044bfe87e55318510db6f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a64107022044bfe87e55318510db6f3">&#9670;&nbsp;</a></span>FRAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAME</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">addr</td><td>)</td>
          <td>&#160;&#160;&#160;(addr / <a class="el" href="src_2boot_2x86_2stage2_2mem_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00025">25</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="a3ae8c00bdaaa9569270b2f22410da7eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ae8c00bdaaa9569270b2f22410da7eb">&#9670;&nbsp;</a></span>IS_INDIVIDUAL_PER_DIR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IS_INDIVIDUAL_PER_DIR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">index</td><td>)</td>
          <td>&#160;&#160;&#160;(index &lt; <a class="el" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a> || (index == <a class="el" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(pspace_zone.start)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00030">30</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="a75169164a5502d98dc9b1fe27ec57ff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75169164a5502d98dc9b1fe27ec57ff7">&#9670;&nbsp;</a></span>PAGE_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PAGE_START</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">vaddr</td><td>)</td>
          <td>&#160;&#160;&#160;((vaddr &gt;&gt; 12) &lt;&lt; 12)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00026">26</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="acb0581d576bd40d996ec64ba943d834d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb0581d576bd40d996ec64ba943d834d">&#9670;&nbsp;</a></span>pdir_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define pdir_t&#160;&#160;&#160;<a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00021">21</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="ae85bc0fd630a61ea106889a6e9588d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae85bc0fd630a61ea106889a6e9588d3f">&#9670;&nbsp;</a></span>vmm_kernel_pdir_phys2virt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vmm_kernel_pdir_phys2virt</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">paddr</td><td>)</td>
          <td>&#160;&#160;&#160;((void*)((<a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)paddr + <a class="el" href="config_8h.html#a0369a136c68b1e47cd6fcfe03cad8c53">KERNEL_BASE</a> - <a class="el" href="memmap_8h.html#a8c46e7070c87b70c8f999bf02aa35c73">KERNEL_PM_BASE</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00037">37</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="a94be9fd98a7a3e28deb2d14841bc5819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94be9fd98a7a3e28deb2d14841bc5819">&#9670;&nbsp;</a></span>VMM_KERNEL_TABLES_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMM_KERNEL_TABLES_START&#160;&#160;&#160;768</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00028">28</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="a3711dfec5fdda52c3ea8f3884f92e544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3711dfec5fdda52c3ea8f3884f92e544">&#9670;&nbsp;</a></span>VMM_OFFSET_IN_DIRECTORY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMM_OFFSET_IN_DIRECTORY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;(((a) &gt;&gt; 22) &amp; 0x3ff)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00022">22</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="a3671ae236619055a151e5dbaed3d19fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3671ae236619055a151e5dbaed3d19fb">&#9670;&nbsp;</a></span>VMM_OFFSET_IN_PAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMM_OFFSET_IN_PAGE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;((a)&amp;0xfff)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00024">24</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="aef0153575274ce9a5768ce3f2501d81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef0153575274ce9a5768ce3f2501d81b">&#9670;&nbsp;</a></span>VMM_OFFSET_IN_TABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMM_OFFSET_IN_TABLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;(((a) &gt;&gt; 12) &amp; 0x3ff)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00023">23</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<a id="a29f43ad76f35d72d6682c842ed691653"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29f43ad76f35d72d6682c842ed691653">&#9670;&nbsp;</a></span>VMM_USER_TABLES_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMM_USER_TABLES_START&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00029">29</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8f6efe6da67baa73c4d68e72d47a97a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f6efe6da67baa73c4d68e72d47a97a9">&#9670;&nbsp;</a></span>_vmm_alloc_kernel_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * _vmm_alloc_kernel_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>VM INITIALIZATION FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00209">209</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vmm_8c.html#ae85bc0fd630a61ea106889a6e9588d3f">vmm_kernel_pdir_phys2virt</a>(<a class="code" href="pmm_8h.html#a2e9d9a39a302ea8faf76fec264983649">pmm_alloc_block</a>());</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="ttc" id="apmm_8h_html_a2e9d9a39a302ea8faf76fec264983649"><div class="ttname"><a href="pmm_8h.html#a2e9d9a39a302ea8faf76fec264983649">pmm_alloc_block</a></div><div class="ttdeci">void * pmm_alloc_block()</div><div class="ttdef"><b>Definition:</b> <a href="pmm_8c_source.html#l00224">pmm.c:224</a></div></div>
<div class="ttc" id="avmm_8c_html_ae85bc0fd630a61ea106889a6e9588d3f"><div class="ttname"><a href="vmm_8c.html#ae85bc0fd630a61ea106889a6e9588d3f">vmm_kernel_pdir_phys2virt</a></div><div class="ttdeci">#define vmm_kernel_pdir_phys2virt(paddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00037">vmm.c:37</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pmm_8c_source.html#l00224">pmm_alloc_block()</a>, and <a class="el" href="vmm_8c_source.html#l00037">vmm_kernel_pdir_phys2virt</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00100">_vmm_split_pspace()</a>.</p>

</div>
</div>
<a id="ae922e29314c0d14760e10364e4d06a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae922e29314c0d14760e10364e4d06a24">&#9670;&nbsp;</a></span>_vmm_convert_vaddr2paddr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * _vmm_convert_vaddr2paddr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is used to traslate a virtual address into physical </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00198">198</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable_vaddr = (<a class="code" href="structptable__t.html">ptable_t</a>*)<a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* page_desc = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable_vaddr, vaddr);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)((<a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame</a>(*page_desc)) | (vaddr &amp; 0xfff));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a1f75ec081d665c51011f32bb291b9081"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a></div><div class="ttdeci">#define page_desc_t</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">pte.h:14</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a282e2fb3846db3de6ed921cd045aaac3"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame</a></div><div class="ttdeci">uint32_t page_desc_get_frame(uint32_t pte)</div></div>
<div class="ttc" id="astructptable__t_html"><div class="ttname"><a href="structptable__t.html">ptable_t</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00045">vmm.h:45</a></div></div>
<div class="ttc" id="avmm_8c_html_a35d8684b806f9433a8d62abca47379a3"><div class="ttname"><a href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a></div><div class="ttdeci">page_desc_t * vmm_ptable_lookup(ptable_t *ptable, uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00330">vmm.c:330</a></div></div>
<div class="ttc" id="avmm_8c_html_aadbf1e80ec16fe23449ee1e43d8a6280"><div class="ttname"><a href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a></div><div class="ttdeci">static void * _vmm_pspace_get_vaddr_of_active_ptable(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00095">vmm.c:95</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00927">_vmm_self_test()</a>, and <a class="el" href="vmm_8c_source.html#l00896">vmm_switch_pdir()</a>.</p>

</div>
</div>
<a id="ad9956517ffdd028c63384883de128303"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9956517ffdd028c63384883de128303">&#9670;&nbsp;</a></span>_vmm_copy_page_to_resolve_cow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _vmm_copy_page_to_resolve_cow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structptable__t.html">ptable_t</a> *&#160;</td>
          <td class="paramname"><em>src_ptable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is supposed to copy a page from @src_ptable to active ptable. The page which is copied has address @vaddr. ONLY TO RESOLVE COW! </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00537">537</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* old_page_desc = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(src_ptable, vaddr);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">/* Based on an old page */</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="vmm_8c.html#a2cfe8792eb0ed88e04de2397ebb2ddae">vmm_load_page</a>(vaddr, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#ab6aec99af24a364f39bf0b0ecf9642ad">page_desc_get_settings_ignore_cow</a>(*old_page_desc));</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">/* Mapping the old page to do a copy */</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="struct____zone.html">zone_t</a> tmp_zone = <a class="code" href="zoner_8h.html#a52687374a0e1777e303c3dadd0e1c9bd">zoner_new_zone</a>(<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> old_page_vaddr = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_zone.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> old_page_paddr = <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame</a>(*old_page_desc);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a>(old_page_vaddr, old_page_paddr, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">/*  We don&#39;t need to check if there is a problem with cow, since this is a special copy function</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">        to resolve cow. So, we know that pages were created recently. Checking cow here would cause an</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">        ub, since table has not been setup correctly yet. */</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>((<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)vaddr, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)old_page_vaddr, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">/* Freeing */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="vmm_8c.html#ae843e6ecc554a821adbd89275b74c41d">vmm_unmap_page</a>(old_page_vaddr);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="zoner_8h.html#a2f1f7bb85c03f839e545ee07f126df36">zoner_free_zone</a>(tmp_zone);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a></div><div class="ttdeci">@ PAGE_READABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00023">vmm.h:23</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a></div><div class="ttdeci">@ PAGE_EXECUTABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00024">vmm.h:24</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a></div><div class="ttdeci">@ PAGE_WRITABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00022">vmm.h:22</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a5f1b9da0ed7c272c7b595fd332483e40"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a></div><div class="ttdeci">#define VMM_PAGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00036">vmm.h:36</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_ab6aec99af24a364f39bf0b0ecf9642ad"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#ab6aec99af24a364f39bf0b0ecf9642ad">page_desc_get_settings_ignore_cow</a></div><div class="ttdeci">uint32_t page_desc_get_settings_ignore_cow(uint32_t pte)</div></div>
<div class="ttc" id="amem_8h_html_ad2da9e2d51c0279601e740bb36ef6156"><div class="ttname"><a href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a></div><div class="ttdeci">void memcpy(uint8_t *dest, const uint8_t *src, uint32_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="string_8c_source.html#l00023">string.c:23</a></div></div>
<div class="ttc" id="astruct____zone_html"><div class="ttname"><a href="struct____zone.html">__zone</a></div><div class="ttdef"><b>Definition:</b> <a href="zoner_8h_source.html#l00014">zoner.h:14</a></div></div>
<div class="ttc" id="astruct____zone_html_aeb749deab54a773b6e22e4ce0747734f"><div class="ttname"><a href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">__zone::start</a></div><div class="ttdeci">uint32_t start</div><div class="ttdef"><b>Definition:</b> <a href="zoner_8h_source.html#l00016">zoner.h:16</a></div></div>
<div class="ttc" id="asyscall__structs_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="syscall__structs_8h_source.html#l00008">syscall_structs.h:8</a></div></div>
<div class="ttc" id="asyscall__structs_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="syscall__structs_8h_source.html#l00010">syscall_structs.h:10</a></div></div>
<div class="ttc" id="avmm_8c_html_a2cfe8792eb0ed88e04de2397ebb2ddae"><div class="ttname"><a href="vmm_8c.html#a2cfe8792eb0ed88e04de2397ebb2ddae">vmm_load_page</a></div><div class="ttdeci">int vmm_load_page(uint32_t vaddr, uint32_t settings)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00775">vmm.c:775</a></div></div>
<div class="ttc" id="avmm_8c_html_a5fc87f9db4fc5d3811872421588e4dd2"><div class="ttname"><a href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a></div><div class="ttdeci">int vmm_map_page(uint32_t vaddr, uint32_t paddr, uint32_t settings)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00393">vmm.c:393</a></div></div>
<div class="ttc" id="avmm_8c_html_ae843e6ecc554a821adbd89275b74c41d"><div class="ttname"><a href="vmm_8c.html#ae843e6ecc554a821adbd89275b74c41d">vmm_unmap_page</a></div><div class="ttdeci">int vmm_unmap_page(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00437">vmm.c:437</a></div></div>
<div class="ttc" id="azoner_8h_html_a2f1f7bb85c03f839e545ee07f126df36"><div class="ttname"><a href="zoner_8h.html#a2f1f7bb85c03f839e545ee07f126df36">zoner_free_zone</a></div><div class="ttdeci">int zoner_free_zone(zone_t zone)</div><div class="ttdef"><b>Definition:</b> <a href="zoner_8c_source.html#l00102">zoner.c:102</a></div></div>
<div class="ttc" id="azoner_8h_html_a52687374a0e1777e303c3dadd0e1c9bd"><div class="ttname"><a href="zoner_8h.html#a52687374a0e1777e303c3dadd0e1c9bd">zoner_new_zone</a></div><div class="ttdeci">zone_t zoner_new_zone(uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="zoner_8c_source.html#l00067">zoner.c:67</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#ab6aec99af24a364f39bf0b0ecf9642ad">page_desc_get_settings_ignore_cow()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="vmm_8c_source.html#l00775">vmm_load_page()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>, <a class="el" href="vmm_8c_source.html#l00437">vmm_unmap_page()</a>, <a class="el" href="zoner_8c_source.html#l00102">zoner_free_zone()</a>, and <a class="el" href="zoner_8c_source.html#l00067">zoner_new_zone()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>.</p>

</div>
</div>
<a id="a63f9a860b1f1131d396a2ddbc855064e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63f9a860b1f1131d396a2ddbc855064e">&#9670;&nbsp;</a></span>_vmm_create_kernel_ptables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _vmm_create_kernel_ptables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is supposed to create all kernel tables and map necessary data into _vmm_kernel_pdir. Used only in the first stage of VM init </p>
<p>VMM_OFFSET_IN_DIRECTORY(pspace_zone.start) shows number of table where pspace starts. Since pspace is right after kernel, let's protect them and not give user access to the whole ptable (and since ptable is not user, all pages inside it are not user too).</p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00246">246</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;{</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> table_coverage = <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a> * 1024;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> kernel_ptabels_vaddr = <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a> * table_coverage;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>; i &lt; 1024; i++, kernel_ptabels_vaddr += table_coverage) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// updating table descriptor of kernel&#39;s pdir</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a>, kernel_ptabels_vaddr);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paddr = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="pmm_8h.html#a2e9d9a39a302ea8faf76fec264983649">pmm_alloc_block</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (!paddr) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;PADDR_5546 : BUG\n&quot;</span>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a>(ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e">TABLE_DESC_PRESENT</a> | <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b">TABLE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> (i &gt; <a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>)) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a>(ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a9e85457c66cd628b5a74e5d6deb48648">TABLE_DESC_USER</a>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a8e073bd39fb1230d4d47f74ae5f162a9">table_desc_set_frame</a>(ptable_desc, <a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(paddr));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="vmm_8c.html#af61bce625271f219e9c1ce3fc240b842">_vmm_map_init_kernel_pages</a>(0x00100000, 0xc0000000);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="vmm_8c.html#af61bce625271f219e9c1ce3fc240b842">_vmm_map_init_kernel_pages</a>(0x00000000, 0xffc00000);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a26415a58766c2bb02c5b17a457b214e7"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a></div><div class="ttdeci">#define table_desc_t</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">pde.h:14</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a8e073bd39fb1230d4d47f74ae5f162a9"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a8e073bd39fb1230d4d47f74ae5f162a9">table_desc_set_frame</a></div><div class="ttdeci">void table_desc_set_frame(uint32_t *pde, uint32_t frame)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a9933e6ff769513e9fd19aed787ea994d"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a></div><div class="ttdeci">void table_desc_set_attrs(uint32_t *pde, uint32_t attrs)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e">TABLE_DESC_PRESENT</a></div><div class="ttdeci">@ TABLE_DESC_PRESENT</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00020">pde.h:20</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a9dae1b6be624dbeb728e098b25490623a9e85457c66cd628b5a74e5d6deb48648"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a9e85457c66cd628b5a74e5d6deb48648">TABLE_DESC_USER</a></div><div class="ttdeci">@ TABLE_DESC_USER</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00022">pde.h:22</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b">TABLE_DESC_WRITABLE</a></div><div class="ttdeci">@ TABLE_DESC_WRITABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00021">pde.h:21</a></div></div>
<div class="ttc" id="akassert_8h_html_a43cb62099c428c65d943851885a07d6a"><div class="ttname"><a href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a></div><div class="ttdeci">void kpanic(char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="kassert_8c_source.html#l00011">kassert.c:11</a></div></div>
<div class="ttc" id="avmm_8c_html_a0621c6ce03a60c64786fc206880d854f"><div class="ttname"><a href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a></div><div class="ttdeci">static pdirectory_t * _vmm_kernel_pdir</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00032">vmm.c:32</a></div></div>
<div class="ttc" id="avmm_8c_html_a3711dfec5fdda52c3ea8f3884f92e544"><div class="ttname"><a href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a></div><div class="ttdeci">#define VMM_OFFSET_IN_DIRECTORY(a)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00022">vmm.c:22</a></div></div>
<div class="ttc" id="avmm_8c_html_a6a64107022044bfe87e55318510db6f3"><div class="ttname"><a href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a></div><div class="ttdeci">#define FRAME(addr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00025">vmm.c:25</a></div></div>
<div class="ttc" id="avmm_8c_html_a94be9fd98a7a3e28deb2d14841bc5819"><div class="ttname"><a href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a></div><div class="ttdeci">#define VMM_KERNEL_TABLES_START</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00028">vmm.c:28</a></div></div>
<div class="ttc" id="avmm_8c_html_ab22a83d25d138540fce05ecdda830a11"><div class="ttname"><a href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a></div><div class="ttdeci">table_desc_t * vmm_pdirectory_lookup(pdirectory_t *pdir, uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00322">vmm.c:322</a></div></div>
<div class="ttc" id="avmm_8c_html_ab71f5fd0fba588a759b27cb0fbd63395"><div class="ttname"><a href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a></div><div class="ttdeci">static zone_t pspace_zone</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00034">vmm.c:34</a></div></div>
<div class="ttc" id="avmm_8c_html_af61bce625271f219e9c1ce3fc240b842"><div class="ttname"><a href="vmm_8c.html#af61bce625271f219e9c1ce3fc240b842">_vmm_map_init_kernel_pages</a></div><div class="ttdeci">static void _vmm_map_init_kernel_pages(uint32_t paddr, uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00232">vmm.c:232</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00032">_vmm_kernel_pdir</a>, <a class="el" href="vmm_8c_source.html#l00232">_vmm_map_init_kernel_pages()</a>, <a class="el" href="vmm_8c_source.html#l00025">FRAME</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="pmm_8c_source.html#l00224">pmm_alloc_block()</a>, <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00020">TABLE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a8e073bd39fb1230d4d47f74ae5f162a9">table_desc_set_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00022">TABLE_DESC_USER</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00021">TABLE_DESC_WRITABLE</a>, <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>, <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, and <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00288">vmm_setup()</a>.</p>

</div>
</div>
<a id="a866d9ff3a2d0fc67212d80c05303ac32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a866d9ff3a2d0fc67212d80c05303ac32">&#9670;&nbsp;</a></span>_vmm_ensure_cow_for_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _vmm_ensure_cow_for_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00517">517</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;{</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#ac7abcdb4891827beb4b8c16a9434b595">_vmm_is_copy_on_write</a>(vaddr)) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="vmm_8c.html#a1bb7e26783908ccc1e52e0db7a86bada">_vmm_resolve_copy_on_write</a>(vaddr);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="ttc" id="avmm_8c_html_a1bb7e26783908ccc1e52e0db7a86bada"><div class="ttname"><a href="vmm_8c.html#a1bb7e26783908ccc1e52e0db7a86bada">_vmm_resolve_copy_on_write</a></div><div class="ttdeci">static int _vmm_resolve_copy_on_write(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00488">vmm.c:488</a></div></div>
<div class="ttc" id="avmm_8c_html_ac7abcdb4891827beb4b8c16a9434b595"><div class="ttname"><a href="vmm_8c.html#ac7abcdb4891827beb4b8c16a9434b595">_vmm_is_copy_on_write</a></div><div class="ttdeci">static bool _vmm_is_copy_on_write(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00481">vmm.c:481</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00481">_vmm_is_copy_on_write()</a>, and <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00524">_vmm_ensure_cow_for_range()</a>, and <a class="el" href="vmm_8c_source.html#l00792">vmm_copy_page()</a>.</p>

</div>
</div>
<a id="af9d15e358e8aec9fc1d9691f11ccbf38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9d15e358e8aec9fc1d9691f11ccbf38">&#9670;&nbsp;</a></span>_vmm_ensure_cow_for_range()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _vmm_ensure_cow_for_range </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00524">524</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> page_addr = <a class="code" href="vmm_8c.html#a75169164a5502d98dc9b1fe27ec57ff7">PAGE_START</a>(vaddr);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">while</span> (page_addr &lt; vaddr + length) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="vmm_8c.html#a866d9ff3a2d0fc67212d80c05303ac32">_vmm_ensure_cow_for_page</a>(page_addr);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        page_addr += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
<div class="ttc" id="avmm_8c_html_a75169164a5502d98dc9b1fe27ec57ff7"><div class="ttname"><a href="vmm_8c.html#a75169164a5502d98dc9b1fe27ec57ff7">PAGE_START</a></div><div class="ttdeci">#define PAGE_START(vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00026">vmm.c:26</a></div></div>
<div class="ttc" id="avmm_8c_html_a866d9ff3a2d0fc67212d80c05303ac32"><div class="ttname"><a href="vmm_8c.html#a866d9ff3a2d0fc67212d80c05303ac32">_vmm_ensure_cow_for_page</a></div><div class="ttdeci">static void _vmm_ensure_cow_for_page(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00517">vmm.c:517</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00517">_vmm_ensure_cow_for_page()</a>, <a class="el" href="vmm_8c_source.html#l00026">PAGE_START</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00694">vmm_copy_to_pdir()</a>.</p>

</div>
</div>
<a id="ab606d49a29a18ddfe83fb9b270b88dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab606d49a29a18ddfe83fb9b270b88dee">&#9670;&nbsp;</a></span>_vmm_free_pspace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _vmm_free_pspace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td>
          <td class="paramname"><em>pdir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00174">174</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = &amp;pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>)];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs</a>(*ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e">TABLE_DESC_PRESENT</a>)) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="pmm_8h.html#aa466e3fd01afb4f0add04b695299ebcc">pmm_free_block</a>((<span class="keywordtype">void</span>*)<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#ae5f5d84ed4918c5b78cd60f9984b3b79">table_desc_get_frame</a>(*ptable_desc));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a2dd298c523f13a55432dbe6d8f436db3">table_desc_del_frame</a>(ptable_desc);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a2dd298c523f13a55432dbe6d8f436db3"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a2dd298c523f13a55432dbe6d8f436db3">table_desc_del_frame</a></div><div class="ttdeci">void table_desc_del_frame(uint32_t *pde)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a4035d34c84237c3b4dbfe3e82b3d1814"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs</a></div><div class="ttdeci">bool table_desc_has_attrs(uint32_t pde, uint32_t attrs)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_ae5f5d84ed4918c5b78cd60f9984b3b79"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#ae5f5d84ed4918c5b78cd60f9984b3b79">table_desc_get_frame</a></div><div class="ttdeci">uint32_t table_desc_get_frame(uint32_t pde)</div></div>
<div class="ttc" id="apmm_8h_html_aa466e3fd01afb4f0add04b695299ebcc"><div class="ttname"><a href="pmm_8h.html#aa466e3fd01afb4f0add04b695299ebcc">pmm_free_block</a></div><div class="ttdeci">bool pmm_free_block(void *t_block)</div><div class="ttdef"><b>Definition:</b> <a href="pmm_8c_source.html#l00237">pmm.c:237</a></div></div>
<div class="ttc" id="astructpdirectory_html_af0b06d8b8ed771ab45e5e9de95363bdf"><div class="ttname"><a href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">pdirectory::entities</a></div><div class="ttdeci">table_desc_t entities[(1024)]</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00050">vmm.h:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00050">pdirectory::entities</a>, <a class="el" href="pmm_8c_source.html#l00237">pmm_free_block()</a>, <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a2dd298c523f13a55432dbe6d8f436db3">table_desc_del_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#ae5f5d84ed4918c5b78cd60f9984b3b79">table_desc_get_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00020">TABLE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, and <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00657">vmm_free_pdir()</a>.</p>

</div>
</div>
<a id="a1c129dfab11d2a20a093d79f78acdb7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c129dfab11d2a20a093d79f78acdb7a">&#9670;&nbsp;</a></span>_vmm_init_switch_to_kernel_pdir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _vmm_init_switch_to_kernel_pdir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is used to update active pdir Used only in the first stage of VM init </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00218">218</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a> = <a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="system_8h.html#a703bc6b45945b4d70aea606f7fbf26d6">system_disable_interrupts</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">/* Should have :Memory here? */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="system_8h.html#a7ef51a49f2d93b076c43404b918f0bf1">system_set_pdir</a>((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#a76ba5bf10c003badfe62ab1914948633">_vmm_kernel_convert_vaddr2paddr</a>((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="system_8h.html#a18251f86dd00a2f140019744e32329c2">system_enable_interrupts</a>();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="ttc" id="asystem_8h_html_a18251f86dd00a2f140019744e32329c2"><div class="ttname"><a href="system_8h.html#a18251f86dd00a2f140019744e32329c2">system_enable_interrupts</a></div><div class="ttdeci">void system_enable_interrupts()</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00021">system.c:21</a></div></div>
<div class="ttc" id="asystem_8h_html_a703bc6b45945b4d70aea606f7fbf26d6"><div class="ttname"><a href="system_8h.html#a703bc6b45945b4d70aea606f7fbf26d6">system_disable_interrupts</a></div><div class="ttdeci">void system_disable_interrupts()</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00015">system.c:15</a></div></div>
<div class="ttc" id="asystem_8h_html_a7ef51a49f2d93b076c43404b918f0bf1"><div class="ttname"><a href="system_8h.html#a7ef51a49f2d93b076c43404b918f0bf1">system_set_pdir</a></div><div class="ttdeci">static void system_set_pdir(uint32_t pdir)</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00027">system.h:27</a></div></div>
<div class="ttc" id="avmm_8c_html_a76ba5bf10c003badfe62ab1914948633"><div class="ttname"><a href="vmm_8c.html#a76ba5bf10c003badfe62ab1914948633">_vmm_kernel_convert_vaddr2paddr</a></div><div class="ttdeci">static void * _vmm_kernel_convert_vaddr2paddr(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00188">vmm.c:188</a></div></div>
<div class="ttc" id="avmm_8c_html_a80d3bb55f78af993af1528942aec0119"><div class="ttname"><a href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a></div><div class="ttdeci">static pdirectory_t * _vmm_active_pdir</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00033">vmm.c:33</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00188">_vmm_kernel_convert_vaddr2paddr()</a>, <a class="el" href="vmm_8c_source.html#l00032">_vmm_kernel_pdir</a>, <a class="el" href="system_8c_source.html#l00015">system_disable_interrupts()</a>, <a class="el" href="system_8c_source.html#l00021">system_enable_interrupts()</a>, and <a class="el" href="system_8h_source.html#l00027">system_set_pdir()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00288">vmm_setup()</a>.</p>

</div>
</div>
<a id="ac7abcdb4891827beb4b8c16a9434b595"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7abcdb4891827beb4b8c16a9434b595">&#9670;&nbsp;</a></span>_vmm_is_copy_on_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _vmm_is_copy_on_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>COPY ON WRITE FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00481">481</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;{</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, vaddr);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a8f84b559d0a491b93251a2df8d3aed52">table_desc_is_copy_on_write</a>(*ptable_desc);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a8f84b559d0a491b93251a2df8d3aed52"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a8f84b559d0a491b93251a2df8d3aed52">table_desc_is_copy_on_write</a></div><div class="ttdeci">bool table_desc_is_copy_on_write(uint32_t pde)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a8f84b559d0a491b93251a2df8d3aed52">table_desc_is_copy_on_write()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, and <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00517">_vmm_ensure_cow_for_page()</a>, and <a class="el" href="vmm_8c_source.html#l00841">vmm_page_fault_handler()</a>.</p>

</div>
</div>
<a id="af7e02799fa4e188139bc5551aa994db5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7e02799fa4e188139bc5551aa994db5">&#9670;&nbsp;</a></span>_vmm_is_zeroing_on_demand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _vmm_is_zeroing_on_demand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ZEROING ON DEMAND FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00565">565</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, vaddr);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs</a>(*ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a33ae2ce1c381ac617bd271d9b5502b94">TABLE_DESC_ZEROING_ON_DEMAND</a>)) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable = <a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ppage_desc = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable, vaddr);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a4a62c11446bf9a1c01694330c42393f3">page_desc_has_attrs</a>(*ppage_desc, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a1ef972d92b56f886388a8e11577ba96a">PAGE_DESC_ZEROING_ON_DEMAND</a>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a9dae1b6be624dbeb728e098b25490623a33ae2ce1c381ac617bd271d9b5502b94"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a33ae2ce1c381ac617bd271d9b5502b94">TABLE_DESC_ZEROING_ON_DEMAND</a></div><div class="ttdeci">@ TABLE_DESC_ZEROING_ON_DEMAND</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00032">pde.h:31</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a4a62c11446bf9a1c01694330c42393f3"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a4a62c11446bf9a1c01694330c42393f3">page_desc_has_attrs</a></div><div class="ttdeci">bool page_desc_has_attrs(uint32_t pte, uint32_t attr)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_aff135280ad5a239c3a322a707bf547e7a1ef972d92b56f886388a8e11577ba96a"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a1ef972d92b56f886388a8e11577ba96a">PAGE_DESC_ZEROING_ON_DEMAND</a></div><div class="ttdeci">@ PAGE_DESC_ZEROING_ON_DEMAND</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00032">pte.h:31</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a4a62c11446bf9a1c01694330c42393f3">page_desc_has_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00031">PAGE_DESC_ZEROING_ON_DEMAND</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00031">TABLE_DESC_ZEROING_ON_DEMAND</a>, <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00841">vmm_page_fault_handler()</a>.</p>

</div>
</div>
<a id="a76ba5bf10c003badfe62ab1914948633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ba5bf10c003badfe62ab1914948633">&#9670;&nbsp;</a></span>_vmm_kernel_convert_vaddr2paddr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * _vmm_kernel_convert_vaddr2paddr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is used to traslate a virtual address into physical Used only in the first stage of VM init </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00188">188</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable_vaddr = (<a class="code" href="structptable__t.html">ptable_t</a>*)(<a class="code" href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a> + (<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(vaddr) - <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>) * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* page_desc = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable_vaddr, vaddr);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)((<a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame</a>(*page_desc)) | (vaddr &amp; 0xfff));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="ttc" id="avmm_8c_html_a91bba8fda41b781948a9379cc516320d"><div class="ttname"><a href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a></div><div class="ttdeci">static uint32_t kernel_ptables_start_paddr</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00035">vmm.c:35</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00035">kernel_ptables_start_paddr</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>, <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00218">_vmm_init_switch_to_kernel_pdir()</a>.</p>

</div>
</div>
<a id="af61bce625271f219e9c1ce3fc240b842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af61bce625271f219e9c1ce3fc240b842">&#9670;&nbsp;</a></span>_vmm_map_init_kernel_pages()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _vmm_map_init_kernel_pages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is used to map kernel pages Used only in the first stage of VM init </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00232">232</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable_paddr = (<a class="code" href="structptable__t.html">ptable_t</a>*)(<a class="code" href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a> + (<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(vaddr) - <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>) * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> phyz = paddr, virt = vaddr, i = 0; i &lt; 1024; phyz += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>, virt += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>, i++) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a8b110296237af252ecb2fe8202392d82">pte_t</a> new_page = (<a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(phyz) &lt;&lt; 12) | 3;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        ptable_paddr-&gt;<a class="code" href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">entities</a>[i] = new_page;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a8b110296237af252ecb2fe8202392d82"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a8b110296237af252ecb2fe8202392d82">pte_t</a></div><div class="ttdeci">#define pte_t</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00015">pte.h:15</a></div></div>
<div class="ttc" id="astructptable__t_html_a3e7450748f2661e4b025c2bda937617f"><div class="ttname"><a href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">ptable_t::entities</a></div><div class="ttdeci">page_desc_t entities[(1024)]</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00046">vmm.h:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00046">ptable_t::entities</a>, <a class="el" href="vmm_8c_source.html#l00025">FRAME</a>, <a class="el" href="vmm_8c_source.html#l00035">kernel_ptables_start_paddr</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00015">pte_t</a>, <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>, <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00246">_vmm_create_kernel_ptables()</a>.</p>

</div>
</div>
<a id="ace837bd97087269efb03120fdfad256c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace837bd97087269efb03120fdfad256c">&#9670;&nbsp;</a></span>_vmm_map_kernel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _vmm_map_kernel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is supposed to map secondary data for kernel's pdir. Used only in the first stage of VM init </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00282">282</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="vmm_8c.html#a537c53b02c9ab34340c2d3b285a29ca7">vmm_map_pages</a>(0x00000000, 0x00000000, 1024, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="ttc" id="avmm_8c_html_a537c53b02c9ab34340c2d3b285a29ca7"><div class="ttname"><a href="vmm_8c.html#a537c53b02c9ab34340c2d3b285a29ca7">vmm_map_pages</a></div><div class="ttdeci">int vmm_map_pages(uint32_t vaddr, uint32_t paddr, uint32_t n_pages, uint32_t settings)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00461">vmm.c:461</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, and <a class="el" href="vmm_8c_source.html#l00461">vmm_map_pages()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00288">vmm_setup()</a>.</p>

</div>
</div>
<a id="a719e8c1ccd54ec6a9581f2ddfe71a791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a719e8c1ccd54ec6a9581f2ddfe71a791">&#9670;&nbsp;</a></span>_vmm_pspace_gen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="src_2boot_2x86_2stage2_2mem_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a> _vmm_pspace_gen </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is used to generate new pspace. The function returns the table of itself. </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00144">144</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* cur_ptable = (<a class="code" href="structptable__t.html">ptable_t</a>*)<a class="code" href="vmm_8c.html#a5ad998657fdc90229287337385aaa818">_vmm_pspace_get_nth_active_ptable</a>(<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> ptable_paddr = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="pmm_8h.html#a2e9d9a39a302ea8faf76fec264983649">pmm_alloc_block</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="struct____zone.html">zone_t</a> tmp_zone = <a class="code" href="zoner_8h.html#a52687374a0e1777e303c3dadd0e1c9bd">zoner_new_zone</a>(<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* new_ptable = (<a class="code" href="structptable__t.html">ptable_t</a>*)tmp_zone.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a>((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)new_ptable, ptable_paddr, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1024; i++) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// coping all pages</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        new_ptable-&gt;<a class="code" href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">entities</a>[i] = cur_ptable-&gt;<a class="code" href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">entities</a>[i];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a> pspace_page = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(&amp;pspace_page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a> | <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame</a>(&amp;pspace_page, <a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(ptable_paddr));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    new_ptable-&gt;<a class="code" href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">entities</a>[<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>)] = pspace_page;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a> pspace_table = 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a>(&amp;pspace_table, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e">TABLE_DESC_PRESENT</a> | <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b">TABLE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a8e073bd39fb1230d4d47f74ae5f162a9">table_desc_set_frame</a>(&amp;pspace_table, <a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(ptable_paddr));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="vmm_8c.html#ae843e6ecc554a821adbd89275b74c41d">vmm_unmap_page</a>((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)new_ptable);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="zoner_8h.html#a2f1f7bb85c03f839e545ee07f126df36">zoner_free_zone</a>(tmp_zone);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> pspace_table;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a6ce813aa0419e83a181be2ee7f8d673a"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame</a></div><div class="ttdeci">void page_desc_set_frame(uint32_t *pte, uint32_t frame)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_abebdb4783fd1015ea6c6e6fa4635ccdc"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a></div><div class="ttdeci">void page_desc_set_attrs(uint32_t *pte, uint32_t attrs)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a></div><div class="ttdeci">@ PAGE_DESC_WRITABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00021">pte.h:21</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a></div><div class="ttdeci">@ PAGE_DESC_PRESENT</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">pte.h:20</a></div></div>
<div class="ttc" id="avmm_8c_html_a5ad998657fdc90229287337385aaa818"><div class="ttname"><a href="vmm_8c.html#a5ad998657fdc90229287337385aaa818">_vmm_pspace_get_nth_active_ptable</a></div><div class="ttdeci">static void * _vmm_pspace_get_nth_active_ptable(uint32_t n)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00090">vmm.c:90</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00090">_vmm_pspace_get_nth_active_ptable()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00046">ptable_t::entities</a>, <a class="el" href="vmm_8c_source.html#l00025">FRAME</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">PAGE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00021">PAGE_DESC_WRITABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, <a class="el" href="pmm_8c_source.html#l00224">pmm_alloc_block()</a>, <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00020">TABLE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a8e073bd39fb1230d4d47f74ae5f162a9">table_desc_set_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00021">TABLE_DESC_WRITABLE</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, <a class="el" href="vmm_8c_source.html#l00437">vmm_unmap_page()</a>, <a class="el" href="zoner_8c_source.html#l00102">zoner_free_zone()</a>, and <a class="el" href="zoner_8c_source.html#l00067">zoner_new_zone()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00628">vmm_new_forked_user_pdir()</a>, and <a class="el" href="vmm_8c_source.html#l00605">vmm_new_user_pdir()</a>.</p>

</div>
</div>
<a id="a5ad998657fdc90229287337385aaa818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ad998657fdc90229287337385aaa818">&#9670;&nbsp;</a></span>_vmm_pspace_get_nth_active_ptable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * _vmm_pspace_get_nth_active_ptable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00090">90</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a> + n * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00144">_vmm_pspace_gen()</a>, and <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>.</p>

</div>
</div>
<a id="afa76069bfdaf7ec9602e4c681cc765a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa76069bfdaf7ec9602e4c681cc765a8">&#9670;&nbsp;</a></span>_vmm_pspace_get_vaddr_of_active_pdir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * _vmm_pspace_get_vaddr_of_active_pdir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>PRIVATE FUNCTIONS</p>
<p>PSPACE FUNCTIONS</p>
<p>Pspace is a space with all current tables mapped there. The space starts from @pspace_zone.start and length is 4mb The function is supposed to setup pspace_zone.start Every virtual space has its own user's ptables in the area. The kernel's patables are the same. </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00085">85</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>.</p>

</div>
</div>
<a id="aadbf1e80ec16fe23449ee1e43d8a6280"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadbf1e80ec16fe23449ee1e43d8a6280">&#9670;&nbsp;</a></span>_vmm_pspace_get_vaddr_of_active_ptable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * _vmm_pspace_get_vaddr_of_active_ptable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00095">95</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)<a class="code" href="vmm_8c.html#a5ad998657fdc90229287337385aaa818">_vmm_pspace_get_nth_active_ptable</a>(<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(vaddr));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00090">_vmm_pspace_get_nth_active_ptable()</a>, and <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00198">_vmm_convert_vaddr2paddr()</a>, <a class="el" href="vmm_8c_source.html#l00565">_vmm_is_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00576">_vmm_resolve_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00342">vmm_allocate_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00792">vmm_copy_page()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, <a class="el" href="vmm_8c_source.html#l00941">vmm_test_pspace_vaddr_of_active_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00741">vmm_tune_page()</a>, and <a class="el" href="vmm_8c_source.html#l00437">vmm_unmap_page()</a>.</p>

</div>
</div>
<a id="a27f394de96dbb406fb49fd21f05870b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27f394de96dbb406fb49fd21f05870b2">&#9670;&nbsp;</a></span>_vmm_pspace_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _vmm_pspace_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function is used to init pspace Used only in the first stage of VM init </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00121">121</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> kernel_ptabels_vaddr = <a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a> + <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a> * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>; <span class="comment">// map what</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> kernel_ptabels_paddr = <a class="code" href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a>; <span class="comment">// map to</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>; i &lt; 1024; i++) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, kernel_ptabels_vaddr);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#aab37e1fdbf4ced79e2592a39d99c0373">table_desc_is_present</a>(*ptable_desc)) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="comment">// must present</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;PSPACE_6335 : BUG\n&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="structptable__t.html">ptable_t</a>* ptable_vaddr = (<a class="code" href="structptable__t.html">ptable_t</a>*)(<a class="code" href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a> + (<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(kernel_ptabels_vaddr) - <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>) * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* page = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable_vaddr, kernel_ptabels_vaddr);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a> | <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame</a>(page, <a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(kernel_ptabels_paddr));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        kernel_ptabels_vaddr += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        kernel_ptabels_paddr += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_aab37e1fdbf4ced79e2592a39d99c0373"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#aab37e1fdbf4ced79e2592a39d99c0373">table_desc_is_present</a></div><div class="ttdeci">bool table_desc_is_present(uint32_t pde)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00025">FRAME</a>, <a class="el" href="vmm_8c_source.html#l00035">kernel_ptables_start_paddr</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">PAGE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00021">PAGE_DESC_WRITABLE</a>, <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#aab37e1fdbf4ced79e2592a39d99c0373">table_desc_is_present()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>, <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00288">vmm_setup()</a>.</p>

</div>
</div>
<a id="a1bb7e26783908ccc1e52e0db7a86bada"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bb7e26783908ccc1e52e0db7a86bada">&#9670;&nbsp;</a></span>_vmm_resolve_copy_on_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _vmm_resolve_copy_on_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00488">488</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, vaddr);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">/* copying old ptable to kernel */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* src_ptable = <a class="code" href="kmalloc_8h.html#a37b5ea24f8f86ad539ca27fd9f16a7b5">kmalloc_page_aligned</a>();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* root_ptable = <a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>((<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)src_ptable, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)root_ptable, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">/* setting up new ptable */</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">int</span> res = <a class="code" href="vmm_8c.html#a77857596f0bc43a2d578e0ad8a058e98">vmm_allocate_ptable</a>(vaddr);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (res != 0) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* new_ptable = <a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">/* FIXME: Currently we do that for all pages in the table. */</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1024; i++) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> page_vaddr = ((vaddr &gt;&gt; 22) &lt;&lt; 22) + (i * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* page_desc = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(src_ptable, page_vaddr);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)*page_desc != 0) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <a class="code" href="vmm_8c.html#ad9956517ffdd028c63384883de128303">_vmm_copy_page_to_resolve_cow</a>(page_vaddr, src_ptable);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="kmalloc_8h.html#ac07722db4c00209a68b9103bba7cd751">kfree_aligned</a>(src_ptable);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="ttc" id="akmalloc_8h_html_a37b5ea24f8f86ad539ca27fd9f16a7b5"><div class="ttname"><a href="kmalloc_8h.html#a37b5ea24f8f86ad539ca27fd9f16a7b5">kmalloc_page_aligned</a></div><div class="ttdeci">void * kmalloc_page_aligned()</div><div class="ttdef"><b>Definition:</b> <a href="kmalloc_8c_source.html#l00082">kmalloc.c:82</a></div></div>
<div class="ttc" id="akmalloc_8h_html_ac07722db4c00209a68b9103bba7cd751"><div class="ttname"><a href="kmalloc_8h.html#ac07722db4c00209a68b9103bba7cd751">kfree_aligned</a></div><div class="ttdeci">void kfree_aligned(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="kmalloc_8c_source.html#l00094">kmalloc.c:94</a></div></div>
<div class="ttc" id="avmm_8c_html_a77857596f0bc43a2d578e0ad8a058e98"><div class="ttname"><a href="vmm_8c.html#a77857596f0bc43a2d578e0ad8a058e98">vmm_allocate_ptable</a></div><div class="ttdeci">int vmm_allocate_ptable(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00342">vmm.c:342</a></div></div>
<div class="ttc" id="avmm_8c_html_ad9956517ffdd028c63384883de128303"><div class="ttname"><a href="vmm_8c.html#ad9956517ffdd028c63384883de128303">_vmm_copy_page_to_resolve_cow</a></div><div class="ttdeci">static int _vmm_copy_page_to_resolve_cow(uint32_t vaddr, ptable_t *src_ptable)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00537">vmm.c:537</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00537">_vmm_copy_page_to_resolve_cow()</a>, <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="kmalloc_8c_source.html#l00094">kfree_aligned()</a>, <a class="el" href="kmalloc_8c_source.html#l00082">kmalloc_page_aligned()</a>, <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="vmm_8c_source.html#l00342">vmm_allocate_ptable()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00517">_vmm_ensure_cow_for_page()</a>, and <a class="el" href="vmm_8c_source.html#l00841">vmm_page_fault_handler()</a>.</p>

</div>
</div>
<a id="a76c15c4bfaea211a22150f3dbfbdfeea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c15c4bfaea211a22150f3dbfbdfeea">&#9670;&nbsp;</a></span>_vmm_resolve_zeroing_on_demand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _vmm_resolve_zeroing_on_demand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00576">576</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;{</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, vaddr);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable = <a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs</a>(*ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a33ae2ce1c381ac617bd271d9b5502b94">TABLE_DESC_ZEROING_ON_DEMAND</a>)) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1024; i++) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(&amp;ptable-&gt;<a class="code" href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">entities</a>[i], <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a1ef972d92b56f886388a8e11577ba96a">PAGE_DESC_ZEROING_ON_DEMAND</a>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(&amp;ptable-&gt;<a class="code" href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">entities</a>[i], <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs</a>(ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a33ae2ce1c381ac617bd271d9b5502b94">TABLE_DESC_ZEROING_ON_DEMAND</a>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ppage_desc = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable, vaddr);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* dest = (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="vmm_8c.html#a38f7e06398ef8a3a76bcefc41fcacbf0">_vmm_round_floor_to_page</a>(vaddr);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a>(dest, 0, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(ppage_desc, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a1ef972d92b56f886388a8e11577ba96a">PAGE_DESC_ZEROING_ON_DEMAND</a>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(ppage_desc, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a639c25a7d911a4c2afb81e0769507772"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs</a></div><div class="ttdeci">void table_desc_del_attrs(uint32_t *pde, uint32_t attrs)</div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a55c71b867e7b987b105f520099710bf8"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a></div><div class="ttdeci">void page_desc_del_attrs(uint32_t *pte, uint32_t attrs)</div></div>
<div class="ttc" id="amem_8h_html_a6008112cc5f333e4e7d75b66bf81c89c"><div class="ttname"><a href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a></div><div class="ttdeci">void memset(uint8_t *dest, uint8_t fll, uint32_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="string_8c_source.html#l00003">string.c:3</a></div></div>
<div class="ttc" id="avmm_8c_html_a38f7e06398ef8a3a76bcefc41fcacbf0"><div class="ttname"><a href="vmm_8c.html#a38f7e06398ef8a3a76bcefc41fcacbf0">_vmm_round_floor_to_page</a></div><div class="ttdeci">static uint32_t _vmm_round_floor_to_page(uint32_t value)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00317">vmm.c:317</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00317">_vmm_round_floor_to_page()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00046">ptable_t::entities</a>, <a class="el" href="string_8c_source.html#l00003">memset()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00021">PAGE_DESC_WRITABLE</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00031">PAGE_DESC_ZEROING_ON_DEMAND</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00031">TABLE_DESC_ZEROING_ON_DEMAND</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00841">vmm_page_fault_handler()</a>.</p>

</div>
</div>
<a id="a9748d8fe2dac47761d554c0db0757729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9748d8fe2dac47761d554c0db0757729">&#9670;&nbsp;</a></span>_vmm_round_ceil_to_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _vmm_round_ceil_to_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>VM TOOLS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00308">308</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> ((value &amp; (<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a> - 1)) != 0) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        value += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        value &amp;= (0xffffffff - (<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a> - 1));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

</div>
</div>
<a id="a38f7e06398ef8a3a76bcefc41fcacbf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38f7e06398ef8a3a76bcefc41fcacbf0">&#9670;&nbsp;</a></span>_vmm_round_floor_to_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _vmm_round_floor_to_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00317">317</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">return</span> (value &amp; (0xffffffff - (<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a> - 1)));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00576">_vmm_resolve_zeroing_on_demand()</a>, and <a class="el" href="vmm_8c_source.html#l00775">vmm_load_page()</a>.</p>

</div>
</div>
<a id="afa9e823e5347e58f73b8d687ba466123"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa9e823e5347e58f73b8d687ba466123">&#9670;&nbsp;</a></span>_vmm_self_test()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _vmm_self_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>VM SELF TEST FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00927">927</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;{</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <a class="code" href="vmm_8c.html#a537c53b02c9ab34340c2d3b285a29ca7">vmm_map_pages</a>(0x00f0000, 0x8f000000, 1, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordtype">bool</span> correct = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    correct &amp;= ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#ae922e29314c0d14760e10364e4d06a24">_vmm_convert_vaddr2paddr</a>(<a class="code" href="memmap_8h.html#a0369a136c68b1e47cd6fcfe03cad8c53">KERNEL_BASE</a>) == <a class="code" href="memmap_8h.html#a8c46e7070c87b70c8f999bf02aa35c73">KERNEL_PM_BASE</a>);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    correct &amp;= ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#ae922e29314c0d14760e10364e4d06a24">_vmm_convert_vaddr2paddr</a>(0xffc00000) == 0x0);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    correct &amp;= ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#ae922e29314c0d14760e10364e4d06a24">_vmm_convert_vaddr2paddr</a>(0x100) == 0x100);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    correct &amp;= ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#ae922e29314c0d14760e10364e4d06a24">_vmm_convert_vaddr2paddr</a>(0x8f000000) == 0x00f0000);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (correct) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;}</div>
<div class="ttc" id="amemmap_8h_html_a0369a136c68b1e47cd6fcfe03cad8c53"><div class="ttname"><a href="memmap_8h.html#a0369a136c68b1e47cd6fcfe03cad8c53">KERNEL_BASE</a></div><div class="ttdeci">#define KERNEL_BASE</div><div class="ttdef"><b>Definition:</b> <a href="memmap_8h_source.html#l00005">memmap.h:5</a></div></div>
<div class="ttc" id="amemmap_8h_html_a8c46e7070c87b70c8f999bf02aa35c73"><div class="ttname"><a href="memmap_8h.html#a8c46e7070c87b70c8f999bf02aa35c73">KERNEL_PM_BASE</a></div><div class="ttdeci">#define KERNEL_PM_BASE</div><div class="ttdef"><b>Definition:</b> <a href="memmap_8h_source.html#l00004">memmap.h:4</a></div></div>
<div class="ttc" id="avmm_8c_html_ae922e29314c0d14760e10364e4d06a24"><div class="ttname"><a href="vmm_8c.html#ae922e29314c0d14760e10364e4d06a24">_vmm_convert_vaddr2paddr</a></div><div class="ttdeci">static void * _vmm_convert_vaddr2paddr(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00198">vmm.c:198</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00198">_vmm_convert_vaddr2paddr()</a>, <a class="el" href="memmap_8h_source.html#l00005">KERNEL_BASE</a>, <a class="el" href="memmap_8h_source.html#l00004">KERNEL_PM_BASE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, and <a class="el" href="vmm_8c_source.html#l00461">vmm_map_pages()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00288">vmm_setup()</a>.</p>

</div>
</div>
<a id="a6d9ffd126bc6c4fe342faa7f58d14f95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d9ffd126bc6c4fe342faa7f58d14f95">&#9670;&nbsp;</a></span>_vmm_split_pspace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _vmm_split_pspace </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00100">100</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a> = <a class="code" href="zoner_8h.html#a52687374a0e1777e303c3dadd0e1c9bd">zoner_new_zone</a>(4 * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#aa6b38d492364d98453284934ed7caee9">MB</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#aef0153575274ce9a5768ce3f2501d81b">VMM_OFFSET_IN_TABLE</a>(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>) != 0) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;WRONG PSPACE START ADDR&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// FIXME: remove constant basing on kernel len.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a> = 0x220000;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">while</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="pmm_8h.html#a2e9d9a39a302ea8faf76fec264983649">pmm_alloc_block</a>() &lt; (<a class="code" href="vmm_8c.html#a91bba8fda41b781948a9379cc516320d">kernel_ptables_start_paddr</a> - 2 * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a> = (<a class="code" href="vmm_8c.html#acb0581d576bd40d996ec64ba943d834d">pdir_t</a>*)<a class="code" href="vmm_8c.html#a8f6efe6da67baa73c4d68e72d47a97a9">_vmm_alloc_kernel_block</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a> = (<a class="code" href="vmm_8c.html#acb0581d576bd40d996ec64ba943d834d">pdir_t</a>*)<a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a>((<span class="keywordtype">void</span>*)<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, 0, <span class="keyword">sizeof</span>(*<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>)); <span class="comment">// TODO problem for now</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_aa6b38d492364d98453284934ed7caee9"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#aa6b38d492364d98453284934ed7caee9">MB</a></div><div class="ttdeci">#define MB</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00018">vmm.h:18</a></div></div>
<div class="ttc" id="avmm_8c_html_a8f6efe6da67baa73c4d68e72d47a97a9"><div class="ttname"><a href="vmm_8c.html#a8f6efe6da67baa73c4d68e72d47a97a9">_vmm_alloc_kernel_block</a></div><div class="ttdeci">static void * _vmm_alloc_kernel_block()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00209">vmm.c:209</a></div></div>
<div class="ttc" id="avmm_8c_html_acb0581d576bd40d996ec64ba943d834d"><div class="ttname"><a href="vmm_8c.html#acb0581d576bd40d996ec64ba943d834d">pdir_t</a></div><div class="ttdeci">#define pdir_t</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00021">vmm.c:21</a></div></div>
<div class="ttc" id="avmm_8c_html_aef0153575274ce9a5768ce3f2501d81b"><div class="ttname"><a href="vmm_8c.html#aef0153575274ce9a5768ce3f2501d81b">VMM_OFFSET_IN_TABLE</a></div><div class="ttdeci">#define VMM_OFFSET_IN_TABLE(a)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00023">vmm.c:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00209">_vmm_alloc_kernel_block()</a>, <a class="el" href="vmm_8c_source.html#l00032">_vmm_kernel_pdir</a>, <a class="el" href="vmm_8c_source.html#l00035">kernel_ptables_start_paddr</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00018">MB</a>, <a class="el" href="string_8c_source.html#l00003">memset()</a>, <a class="el" href="vmm_8c_source.html#l00021">pdir_t</a>, <a class="el" href="pmm_8c_source.html#l00224">pmm_alloc_block()</a>, <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="vmm_8c_source.html#l00023">VMM_OFFSET_IN_TABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, and <a class="el" href="zoner_8c_source.html#l00067">zoner_new_zone()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00288">vmm_setup()</a>.</p>

</div>
</div>
<a id="a348cee778d57e7d29e0222c42a4fa897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a348cee778d57e7d29e0222c42a4fa897">&#9670;&nbsp;</a></span>vmm_alloc_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_alloc_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="src_2boot_2x86_2stage2_2mem_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a> *&#160;</td>
          <td class="paramname"><em>page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00821">821</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;{</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordtype">void</span>* new_block = <a class="code" href="kmalloc_8h.html#a37b5ea24f8f86ad539ca27fd9f16a7b5">kmalloc_page_aligned</a>();</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (!new_block) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694a5df299d936831e328ee52c83f45a4eec">VMM_ERR_BAD_ADDR</a>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a>);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame</a>(page, <a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)new_block));</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;}</div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_ad883d0ea3e855fecd156a84e04a7f694a5df299d936831e328ee52c83f45a4eec"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694a5df299d936831e328ee52c83f45a4eec">VMM_ERR_BAD_ADDR</a></div><div class="ttdeci">@ VMM_ERR_BAD_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00042">vmm.h:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00025">FRAME</a>, <a class="el" href="kmalloc_8c_source.html#l00082">kmalloc_page_aligned()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">PAGE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame()</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00042">VMM_ERR_BAD_ADDR</a>.</p>

</div>
</div>
<a id="a77857596f0bc43a2d578e0ad8a058e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77857596f0bc43a2d578e0ad8a058e98">&#9670;&nbsp;</a></span>vmm_allocate_ptable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_allocate_ptable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function is supposed to create new ptable (not kernel) and rebuild pspace to match to the new setup </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00342">342</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a> == 0) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694ae84da6fb51c8a731a03f2bc5a17c372c">VMM_ERR_PDIR</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> ptable_paddr = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="pmm_8h.html#a2e9d9a39a302ea8faf76fec264983649">pmm_alloc_block</a>();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (!ptable_paddr) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="log_8h.html#a01de98826735d07d7d41604a2ced9a64">log_error</a>(<span class="stringliteral">&quot; vmm_allocate_ptable: No free space in pmm&quot;</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694afa96043f6b0bcb76c4b7b36e4410aafb">VMM_ERR_NO_SPACE</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> ptable_vaddr = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, vaddr);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#aa8e1509aa0864a67d6072aff1733e8b2">table_desc_clear</a>(ptable_desc);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a>(ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e">TABLE_DESC_PRESENT</a> | <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b">TABLE_DESC_WRITABLE</a> | <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a9e85457c66cd628b5a74e5d6deb48648">TABLE_DESC_USER</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a8e073bd39fb1230d4d47f74ae5f162a9">table_desc_set_frame</a>(ptable_desc, <a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(ptable_paddr));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a>(ptable_vaddr, ptable_paddr, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a1f2e603f3d376b89fc0f0754483167eb">PAGE_CHOOSE_OWNER</a>(vaddr));</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a>((<span class="keywordtype">void</span>*)ptable_vaddr, 0, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a1f2e603f3d376b89fc0f0754483167eb"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a1f2e603f3d376b89fc0f0754483167eb">PAGE_CHOOSE_OWNER</a></div><div class="ttdeci">#define PAGE_CHOOSE_OWNER(vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00032">vmm.h:32</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_ad883d0ea3e855fecd156a84e04a7f694ae84da6fb51c8a731a03f2bc5a17c372c"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694ae84da6fb51c8a731a03f2bc5a17c372c">VMM_ERR_PDIR</a></div><div class="ttdeci">@ VMM_ERR_PDIR</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00039">vmm.h:39</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_ad883d0ea3e855fecd156a84e04a7f694afa96043f6b0bcb76c4b7b36e4410aafb"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694afa96043f6b0bcb76c4b7b36e4410aafb">VMM_ERR_NO_SPACE</a></div><div class="ttdeci">@ VMM_ERR_NO_SPACE</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00041">vmm.h:41</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_aa8e1509aa0864a67d6072aff1733e8b2"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#aa8e1509aa0864a67d6072aff1733e8b2">table_desc_clear</a></div><div class="ttdeci">void table_desc_clear(uint32_t *pde)</div></div>
<div class="ttc" id="alog_8h_html_a01de98826735d07d7d41604a2ced9a64"><div class="ttname"><a href="log_8h.html#a01de98826735d07d7d41604a2ced9a64">log_error</a></div><div class="ttdeci">void log_error(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00122">log.c:122</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00025">FRAME</a>, <a class="el" href="log_8c_source.html#l00122">log_error()</a>, <a class="el" href="string_8c_source.html#l00003">memset()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00032">PAGE_CHOOSE_OWNER</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, <a class="el" href="pmm_8c_source.html#l00224">pmm_alloc_block()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#aa8e1509aa0864a67d6072aff1733e8b2">table_desc_clear()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00020">TABLE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a8e073bd39fb1230d4d47f74ae5f162a9">table_desc_set_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00022">TABLE_DESC_USER</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00021">TABLE_DESC_WRITABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00041">VMM_ERR_NO_SPACE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00039">VMM_ERR_PDIR</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, and <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>, and <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>.</p>

</div>
</div>
<a id="a78abef76fad7bf15b21e06caca47ddae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78abef76fad7bf15b21e06caca47ddae">&#9670;&nbsp;</a></span>vmm_bring_to_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* vmm_bring_to_kernel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00684">684</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)src &gt;= <a class="code" href="memmap_8h.html#a0369a136c68b1e47cd6fcfe03cad8c53">KERNEL_BASE</a>) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">return</span> src;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* kaddr = <a class="code" href="kmalloc_8h.html#afec98775e8113dc6d98f75a582c3646f">kmalloc</a>(length);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>(kaddr, src, length);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span>*)kaddr;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;}</div>
<div class="ttc" id="akmalloc_8h_html_afec98775e8113dc6d98f75a582c3646f"><div class="ttname"><a href="kmalloc_8h.html#afec98775e8113dc6d98f75a582c3646f">kmalloc</a></div><div class="ttdeci">void * kmalloc(uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="kmalloc_8c_source.html#l00053">kmalloc.c:53</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="memmap_8h_source.html#l00005">KERNEL_BASE</a>, <a class="el" href="kmalloc_8c_source.html#l00053">kmalloc()</a>, and <a class="el" href="string_8c_source.html#l00023">memcpy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00694">vmm_copy_to_pdir()</a>.</p>

</div>
</div>
<a id="abb159d2c5072a9db8bddaf464792a4bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb159d2c5072a9db8bddaf464792a4bc">&#9670;&nbsp;</a></span>vmm_copy_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_copy_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>to_vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>src_vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structptable__t.html">ptable_t</a> *&#160;</td>
          <td class="paramname"><em>src_ptable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function is supposed to copy a page from @src_ptable to active ptable. The page which is copied has address @vaddr. ONLY TO RESOLVE COW! </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00792">792</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;{</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* old_page_desc = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(src_ptable, src_vaddr);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">/* Based on an old page */</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* cur_ptable = (<a class="code" href="structptable__t.html">ptable_t</a>*)<a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(to_vaddr);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* cur_page = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(cur_ptable, to_vaddr);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a3b36e04616b3bc47dbbd2c74c91cf0cd">page_desc_is_present</a>(*cur_page)) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <a class="code" href="vmm_8c.html#a2cfe8792eb0ed88e04de2397ebb2ddae">vmm_load_page</a>(to_vaddr, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#ab6aec99af24a364f39bf0b0ecf9642ad">page_desc_get_settings_ignore_cow</a>(*old_page_desc));</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <a class="code" href="vmm_8c.html#a866d9ff3a2d0fc67212d80c05303ac32">_vmm_ensure_cow_for_page</a>(to_vaddr);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">/* Mapping the old page to do a copy */</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="struct____zone.html">zone_t</a> tmp_zone = <a class="code" href="zoner_8h.html#a52687374a0e1777e303c3dadd0e1c9bd">zoner_new_zone</a>(<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> old_page_vaddr = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_zone.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> old_page_paddr = <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame</a>(*old_page_desc);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <a class="code" href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a>(old_page_vaddr, old_page_paddr, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>((<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)to_vaddr, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)old_page_vaddr, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">/* Freeing */</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="vmm_8c.html#ae843e6ecc554a821adbd89275b74c41d">vmm_unmap_page</a>(old_page_vaddr);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="zoner_8h.html#a2f1f7bb85c03f839e545ee07f126df36">zoner_free_zone</a>(tmp_zone);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a3b36e04616b3bc47dbbd2c74c91cf0cd"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a3b36e04616b3bc47dbbd2c74c91cf0cd">page_desc_is_present</a></div><div class="ttdeci">bool page_desc_is_present(uint32_t pte)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00517">_vmm_ensure_cow_for_page()</a>, <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#ab6aec99af24a364f39bf0b0ecf9642ad">page_desc_get_settings_ignore_cow()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a3b36e04616b3bc47dbbd2c74c91cf0cd">page_desc_is_present()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="vmm_8c_source.html#l00775">vmm_load_page()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>, <a class="el" href="vmm_8c_source.html#l00437">vmm_unmap_page()</a>, <a class="el" href="zoner_8c_source.html#l00102">zoner_free_zone()</a>, and <a class="el" href="zoner_8c_source.html#l00067">zoner_new_zone()</a>.</p>

</div>
</div>
<a id="a27ff36d5e686f99170ec9053e67d2368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27ff36d5e686f99170ec9053e67d2368">&#9670;&nbsp;</a></span>vmm_copy_to_pdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vmm_copy_to_pdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td>
          <td class="paramname"><em>pdir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>dest_vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00694">694</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="structpdirectory.html">pdirectory_t</a>* prev_pdir = <a class="code" href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a>();</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* ksrc;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)src &lt; <a class="code" href="memmap_8h.html#a0369a136c68b1e47cd6fcfe03cad8c53">KERNEL_BASE</a>) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="comment">/* Means that it&#39;s in user space, so it should be copied here. */</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        ksrc = <a class="code" href="vmm_8c.html#a78abef76fad7bf15b21e06caca47ddae">vmm_bring_to_kernel</a>(src, length);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        ksrc = src;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="vmm_8c.html#ad7f59ea1a3f32fdbcb8e9a322ff098ef">vmm_switch_pdir</a>(pdir);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="vmm_8c.html#af9d15e358e8aec9fc1d9691f11ccbf38">_vmm_ensure_cow_for_range</a>(dest_vaddr, length);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* dest = (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)dest_vaddr;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>(dest, ksrc, length);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)src &lt; <a class="code" href="memmap_8h.html#a0369a136c68b1e47cd6fcfe03cad8c53">KERNEL_BASE</a>) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <a class="code" href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(ksrc);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="vmm_8c.html#ad7f59ea1a3f32fdbcb8e9a322ff098ef">vmm_switch_pdir</a>(prev_pdir);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div>
<div class="ttc" id="akmalloc_8h_html_a069f85a5001d71bc44d8be6532a4e432"><div class="ttname"><a href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a></div><div class="ttdeci">void kfree(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="kmalloc_8c_source.html#l00087">kmalloc.c:87</a></div></div>
<div class="ttc" id="astructpdirectory_html"><div class="ttname"><a href="structpdirectory.html">pdirectory</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00049">vmm.h:49</a></div></div>
<div class="ttc" id="avmm_8c_html_a78abef76fad7bf15b21e06caca47ddae"><div class="ttname"><a href="vmm_8c.html#a78abef76fad7bf15b21e06caca47ddae">vmm_bring_to_kernel</a></div><div class="ttdeci">void * vmm_bring_to_kernel(uint8_t *src, uint32_t length)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00684">vmm.c:684</a></div></div>
<div class="ttc" id="avmm_8c_html_ad7f59ea1a3f32fdbcb8e9a322ff098ef"><div class="ttname"><a href="vmm_8c.html#ad7f59ea1a3f32fdbcb8e9a322ff098ef">vmm_switch_pdir</a></div><div class="ttdeci">int vmm_switch_pdir(pdirectory_t *pdir)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00896">vmm.c:896</a></div></div>
<div class="ttc" id="avmm_8c_html_af410d2e8015ab9e19050defa16c05efb"><div class="ttname"><a href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a></div><div class="ttdeci">pdirectory_t * vmm_get_active_pdir()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00727">vmm.c:727</a></div></div>
<div class="ttc" id="avmm_8c_html_af9d15e358e8aec9fc1d9691f11ccbf38"><div class="ttname"><a href="vmm_8c.html#af9d15e358e8aec9fc1d9691f11ccbf38">_vmm_ensure_cow_for_range</a></div><div class="ttdeci">static void _vmm_ensure_cow_for_range(uint32_t vaddr, uint32_t length)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00524">vmm.c:524</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00524">_vmm_ensure_cow_for_range()</a>, <a class="el" href="memmap_8h_source.html#l00005">KERNEL_BASE</a>, <a class="el" href="kmalloc_8c_source.html#l00087">kfree()</a>, <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="vmm_8c_source.html#l00684">vmm_bring_to_kernel()</a>, <a class="el" href="vmm_8c_source.html#l00727">vmm_get_active_pdir()</a>, and <a class="el" href="vmm_8c_source.html#l00896">vmm_switch_pdir()</a>.</p>

<p class="reference">Referenced by <a class="el" href="proc_8c_source.html#l00156">_proc_load_bin()</a>, and <a class="el" href="thread_8c_source.html#l00139">thread_fill_up_stack()</a>.</p>

</div>
</div>
<a id="a26a978febf08ddd534ae90c56fc9c93f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a978febf08ddd534ae90c56fc9c93f">&#9670;&nbsp;</a></span>vmm_disable_paging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vmm_disable_paging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00918">918</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;{</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <a class="code" href="system_8h.html#afbf0b0be05851fea16ed1d3dd421aedf">system_disable_paging</a>();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;}</div>
<div class="ttc" id="asystem_8h_html_afbf0b0be05851fea16ed1d3dd421aedf"><div class="ttname"><a href="system_8h.html#afbf0b0be05851fea16ed1d3dd421aedf">system_disable_paging</a></div><div class="ttdeci">static void system_disable_paging()</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00066">system.h:66</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_8h_source.html#l00066">system_disable_paging()</a>.</p>

</div>
</div>
<a id="a1c7da31e77d0ada3ff22ef672db87b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c7da31e77d0ada3ff22ef672db87b46">&#9670;&nbsp;</a></span>vmm_enable_paging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vmm_enable_paging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00913">913</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;{</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="system_8h.html#a17716f761fc769dbf7e737bf0c4aa02a">system_enable_paging</a>();</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;}</div>
<div class="ttc" id="asystem_8h_html_a17716f761fc769dbf7e737bf0c4aa02a"><div class="ttname"><a href="system_8h.html#a17716f761fc769dbf7e737bf0c4aa02a">system_enable_paging</a></div><div class="ttdeci">static void system_enable_paging()</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00059">system.h:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_8h_source.html#l00059">system_enable_paging()</a>.</p>

</div>
</div>
<a id="a36800aa16e5a6477b1ec81cafa6c330c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36800aa16e5a6477b1ec81cafa6c330c">&#9670;&nbsp;</a></span>vmm_free_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_free_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="src_2boot_2x86_2stage2_2mem_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a> *&#160;</td>
          <td class="paramname"><em>page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00833">833</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;{</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> frame = <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame</a>(*page);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="pmm_8h.html#aa466e3fd01afb4f0add04b695299ebcc">pmm_free_block</a>((<span class="keywordtype">void</span>*)(frame * <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>));</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a>);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a282e2fb3846db3de6ed921cd045aaac3">page_desc_get_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">PAGE_DESC_PRESENT</a>, <a class="el" href="pmm_8c_source.html#l00237">pmm_free_block()</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

</div>
</div>
<a id="a553d7d0c83eb3254f922e6f983b92748"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a553d7d0c83eb3254f922e6f983b92748">&#9670;&nbsp;</a></span>vmm_free_pdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_free_pdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td>
          <td class="paramname"><em>pdir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00657">657</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">if</span> (!pdir) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">if</span> (pdir == <a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a>) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#ac2a2e9fa555401f94478f74e01868032">EACCES</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="structpdirectory.html">pdirectory_t</a>* cur_pdir = <a class="code" href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a>();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="vmm_8c.html#ad7f59ea1a3f32fdbcb8e9a322ff098ef">vmm_switch_pdir</a>(pdir);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>; i++) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="vmm_8c.html#af7acf4c80aa9fe5ecd3f0dd5a2d956bc">vmm_free_ptable</a>(i);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> (cur_pdir == pdir) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="vmm_8c.html#ad7f59ea1a3f32fdbcb8e9a322ff098ef">vmm_switch_pdir</a>(<a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a>);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="vmm_8c.html#ad7f59ea1a3f32fdbcb8e9a322ff098ef">vmm_switch_pdir</a>(cur_pdir);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="vmm_8c.html#ab606d49a29a18ddfe83fb9b270b88dee">_vmm_free_pspace</a>(pdir);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="kmalloc_8h.html#ac07722db4c00209a68b9103bba7cd751">kfree_aligned</a>(pdir);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div>
<div class="ttc" id="ainclude_2errno_8h_html_a2d1678d5a7cc8ce499643f3b8957def4"><div class="ttname"><a href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a></div><div class="ttdeci">#define EINVAL</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00025">errno.h:25</a></div></div>
<div class="ttc" id="ainclude_2errno_8h_html_ac2a2e9fa555401f94478f74e01868032"><div class="ttname"><a href="include_2errno_8h.html#ac2a2e9fa555401f94478f74e01868032">EACCES</a></div><div class="ttdeci">#define EACCES</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00016">errno.h:16</a></div></div>
<div class="ttc" id="avmm_8c_html_ab606d49a29a18ddfe83fb9b270b88dee"><div class="ttname"><a href="vmm_8c.html#ab606d49a29a18ddfe83fb9b270b88dee">_vmm_free_pspace</a></div><div class="ttdeci">static void _vmm_free_pspace(pdirectory_t *pdir)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00174">vmm.c:174</a></div></div>
<div class="ttc" id="avmm_8c_html_af7acf4c80aa9fe5ecd3f0dd5a2d956bc"><div class="ttname"><a href="vmm_8c.html#af7acf4c80aa9fe5ecd3f0dd5a2d956bc">vmm_free_ptable</a></div><div class="ttdeci">static int vmm_free_ptable(uint32_t ptable_indx)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00367">vmm.c:367</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00174">_vmm_free_pspace()</a>, <a class="el" href="vmm_8c_source.html#l00032">_vmm_kernel_pdir</a>, <a class="el" href="include_2errno_8h_source.html#l00016">EACCES</a>, <a class="el" href="include_2errno_8h_source.html#l00025">EINVAL</a>, <a class="el" href="kmalloc_8c_source.html#l00094">kfree_aligned()</a>, <a class="el" href="vmm_8c_source.html#l00367">vmm_free_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00727">vmm_get_active_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>, and <a class="el" href="vmm_8c_source.html#l00896">vmm_switch_pdir()</a>.</p>

<p class="reference">Referenced by <a class="el" href="proc_8c_source.html#l00232">proc_free()</a>, and <a class="el" href="proc_8c_source.html#l00193">proc_load()</a>.</p>

</div>
</div>
<a id="af7acf4c80aa9fe5ecd3f0dd5a2d956bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7acf4c80aa9fe5ecd3f0dd5a2d956bc">&#9670;&nbsp;</a></span>vmm_free_ptable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int vmm_free_ptable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>ptable_indx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00367">367</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a> == 0) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694ae84da6fb51c8a731a03f2bc5a17c372c">VMM_ERR_PDIR</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = &amp;<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[ptable_indx];</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs</a>(*ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e">TABLE_DESC_PRESENT</a>)) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs</a>(*ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a42d7fd3c28b1387ab619bd0796e5352b">TABLE_DESC_COPY_ON_WRITE</a>)) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="pmm_8h.html#aa466e3fd01afb4f0add04b695299ebcc">pmm_free_block</a>((<span class="keywordtype">void</span>*)<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#ae5f5d84ed4918c5b78cd60f9984b3b79">table_desc_get_frame</a>(*ptable_desc));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a2dd298c523f13a55432dbe6d8f436db3">table_desc_del_frame</a>(ptable_desc);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="ttc" id="ainclude_2errno_8h_html_a3f317946e043623f9d6b93dbf60e6316"><div class="ttname"><a href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a></div><div class="ttdeci">#define EFAULT</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00017">errno.h:17</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pde_8h_html_a9dae1b6be624dbeb728e098b25490623a42d7fd3c28b1387ab619bd0796e5352b"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a42d7fd3c28b1387ab619bd0796e5352b">TABLE_DESC_COPY_ON_WRITE</a></div><div class="ttdeci">@ TABLE_DESC_COPY_ON_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00030">pde.h:30</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00050">pdirectory::entities</a>, <a class="el" href="pmm_8c_source.html#l00237">pmm_free_block()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00030">TABLE_DESC_COPY_ON_WRITE</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a2dd298c523f13a55432dbe6d8f436db3">table_desc_del_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#ae5f5d84ed4918c5b78cd60f9984b3b79">table_desc_get_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00020">TABLE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00039">VMM_ERR_PDIR</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00657">vmm_free_pdir()</a>.</p>

</div>
</div>
<a id="af410d2e8015ab9e19050defa16c05efb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af410d2e8015ab9e19050defa16c05efb">&#9670;&nbsp;</a></span>vmm_get_active_pdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a>* vmm_get_active_pdir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00727">727</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;{</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>.</p>

<p class="reference">Referenced by <a class="el" href="signal_8c_source.html#l00123">signal_setup_stack_to_handle_signal()</a>, <a class="el" href="vmm_8c_source.html#l00694">vmm_copy_to_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00657">vmm_free_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, and <a class="el" href="vmm_8c_source.html#l00841">vmm_page_fault_handler()</a>.</p>

</div>
</div>
<a id="a608b32b82fa4ba69fd3fee442f8beb6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a608b32b82fa4ba69fd3fee442f8beb6f">&#9670;&nbsp;</a></span>vmm_get_kernel_pdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a>* vmm_get_kernel_pdir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00732">732</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;{</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00032">_vmm_kernel_pdir</a>.</p>

<p class="reference">Referenced by <a class="el" href="tasking_8c_source.html#l00118">tasking_create_kernel_thread()</a>, and <a class="el" href="vmm_8c_source.html#l00841">vmm_page_fault_handler()</a>.</p>

</div>
</div>
<a id="a2cfe8792eb0ed88e04de2397ebb2ddae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cfe8792eb0ed88e04de2397ebb2ddae">&#9670;&nbsp;</a></span>vmm_load_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_load_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00775">775</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;{</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> paddr = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="pmm_8h.html#a2e9d9a39a302ea8faf76fec264983649">pmm_alloc_block</a>();</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> (!paddr) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="comment">/* TODO: Swap pages to make it able to allocate. */</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;NO PHYSICAL SPACE&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordtype">int</span> res = <a class="code" href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a>(vaddr, paddr, settings);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* dest = (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="vmm_8c.html#a38f7e06398ef8a3a76bcefc41fcacbf0">_vmm_round_floor_to_page</a>(vaddr);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a>(dest, 0, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00317">_vmm_round_floor_to_page()</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="string_8c_source.html#l00003">memset()</a>, <a class="el" href="pmm_8c_source.html#l00224">pmm_alloc_block()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="signal_8c_source.html#l00036">_signal_init_caller()</a>, <a class="el" href="vmm_8c_source.html#l00537">_vmm_copy_page_to_resolve_cow()</a>, <a class="el" href="vmm_8c_source.html#l00792">vmm_copy_page()</a>, <a class="el" href="vmm_8c_source.html#l00841">vmm_page_fault_handler()</a>, and <a class="el" href="vmm_8c_source.html#l00741">vmm_tune_page()</a>.</p>

</div>
</div>
<a id="a5fc87f9db4fc5d3811872421588e4dd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fc87f9db4fc5d3811872421588e4dd2">&#9670;&nbsp;</a></span>vmm_map_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_map_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function is supposed to map vaddr to paddr </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00393">393</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;{</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694ae84da6fb51c8a731a03f2bc5a17c372c">VMM_ERR_PDIR</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">bool</span> is_writable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">bool</span> is_readable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordtype">bool</span> is_executable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">bool</span> is_not_cacheable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07dad3edcfb281d2d1a53c180f4675ebf330">PAGE_NOT_CACHEABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">bool</span> is_cow = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da79b8a359b1365250e9ce934bc893e57f">PAGE_COW</a>) &gt; 0);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">bool</span> is_user = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da95fc312a8636805454c8ff4f8b872042">PAGE_USER</a>) &gt; 0);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, vaddr);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#aab37e1fdbf4ced79e2592a39d99c0373">table_desc_is_present</a>(*ptable_desc)) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="vmm_8c.html#a77857596f0bc43a2d578e0ad8a058e98">vmm_allocate_ptable</a>(vaddr);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable = (<a class="code" href="structptable__t.html">ptable_t</a>*)<a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* page = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable, vaddr);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame</a>(page, <a class="code" href="vmm_8c.html#a6a64107022044bfe87e55318510db6f3">FRAME</a>(paddr));</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">if</span> (is_writable) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (is_user) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a7ca7102ce672ea81bbd1a9c2ed308a21">PAGE_DESC_USER</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (is_not_cacheable) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7ab96692f27bbdcfc83b9dbf290c1cae67">PAGE_DESC_NOT_CACHEABLE</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#ifdef VMM_DEBUG</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="log_8h.html#a5ed8e2adc6340d877478a62cc1d448c9">log</a>(<span class="stringliteral">&quot;Page mapped %x in pdir: %x&quot;</span>, vaddr, <a class="code" href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a>());</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="system_8h.html#ad5cf99cf03af1b1723d99768a6f4745c">system_flush_tlb_entry</a>(vaddr);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a5a48a1c50700ac0a546b1d10b4a8a07da79b8a359b1365250e9ce934bc893e57f"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da79b8a359b1365250e9ce934bc893e57f">PAGE_COW</a></div><div class="ttdeci">@ PAGE_COW</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00026">vmm.h:26</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a5a48a1c50700ac0a546b1d10b4a8a07da95fc312a8636805454c8ff4f8b872042"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da95fc312a8636805454c8ff4f8b872042">PAGE_USER</a></div><div class="ttdeci">@ PAGE_USER</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00027">vmm.h:27</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_a5a48a1c50700ac0a546b1d10b4a8a07dad3edcfb281d2d1a53c180f4675ebf330"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07dad3edcfb281d2d1a53c180f4675ebf330">PAGE_NOT_CACHEABLE</a></div><div class="ttdeci">@ PAGE_NOT_CACHEABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00025">vmm.h:25</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_aff135280ad5a239c3a322a707bf547e7a7ca7102ce672ea81bbd1a9c2ed308a21"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a7ca7102ce672ea81bbd1a9c2ed308a21">PAGE_DESC_USER</a></div><div class="ttdeci">@ PAGE_DESC_USER</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00022">pte.h:22</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_aff135280ad5a239c3a322a707bf547e7ab96692f27bbdcfc83b9dbf290c1cae67"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7ab96692f27bbdcfc83b9dbf290c1cae67">PAGE_DESC_NOT_CACHEABLE</a></div><div class="ttdeci">@ PAGE_DESC_NOT_CACHEABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00024">pte.h:24</a></div></div>
<div class="ttc" id="alog_8h_html_a5ed8e2adc6340d877478a62cc1d448c9"><div class="ttname"><a href="log_8h.html#a5ed8e2adc6340d877478a62cc1d448c9">log</a></div><div class="ttdeci">void log(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00062">log.c:62</a></div></div>
<div class="ttc" id="asystem_8h_html_ad5cf99cf03af1b1723d99768a6f4745c"><div class="ttname"><a href="system_8h.html#ad5cf99cf03af1b1723d99768a6f4745c">system_flush_tlb_entry</a></div><div class="ttdeci">static void system_flush_tlb_entry(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00034">system.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00025">FRAME</a>, <a class="el" href="log_8c_source.html#l00062">log()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00026">PAGE_COW</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00024">PAGE_DESC_NOT_CACHEABLE</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">PAGE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a6ce813aa0419e83a181be2ee7f8d673a">page_desc_set_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00022">PAGE_DESC_USER</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00021">PAGE_DESC_WRITABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00025">PAGE_NOT_CACHEABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00027">PAGE_USER</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, <a class="el" href="system_8h_source.html#l00034">system_flush_tlb_entry()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#aab37e1fdbf4ced79e2592a39d99c0373">table_desc_is_present()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="vmm_8c_source.html#l00342">vmm_allocate_ptable()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00039">VMM_ERR_PDIR</a>, <a class="el" href="vmm_8c_source.html#l00727">vmm_get_active_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="bga_8c_source.html#l00079">_bga_mmap()</a>, <a class="el" href="vmm_8c_source.html#l00537">_vmm_copy_page_to_resolve_cow()</a>, <a class="el" href="vmm_8c_source.html#l00144">_vmm_pspace_gen()</a>, <a class="el" href="vmm_8c_source.html#l00342">vmm_allocate_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00792">vmm_copy_page()</a>, <a class="el" href="vmm_8c_source.html#l00775">vmm_load_page()</a>, and <a class="el" href="vmm_8c_source.html#l00461">vmm_map_pages()</a>.</p>

</div>
</div>
<a id="a537c53b02c9ab34340c2d3b285a29ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a537c53b02c9ab34340c2d3b285a29ca7">&#9670;&nbsp;</a></span>vmm_map_pages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_map_pages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>paddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>n_pages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function is supposed to map a sequence of vaddrs to paddrs </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00461">461</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">if</span> ((paddr &amp; 0xfff) || (vaddr &amp; 0xfff)) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694a5df299d936831e328ee52c83f45a4eec">VMM_ERR_BAD_ADDR</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">for</span> (; n_pages; paddr += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>, vaddr += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>, n_pages--) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">if</span> (status = <a class="code" href="vmm_8c.html#a5fc87f9db4fc5d3811872421588e4dd2">vmm_map_page</a>(vaddr, paddr, settings) &lt; 0) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00042">VMM_ERR_BAD_ADDR</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00282">_vmm_map_kernel()</a>, and <a class="el" href="vmm_8c_source.html#l00927">_vmm_self_test()</a>.</p>

</div>
</div>
<a id="a56e7e37ce3fa39079507669988c823a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e7e37ce3fa39079507669988c823a2">&#9670;&nbsp;</a></span>vmm_new_forked_user_pdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a>* vmm_new_forked_user_pdir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function created a new user's pdir from the active pdir. After copying the task we need to flush tlb. To do that we have to to reload cr3 tlb entries. </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00628">628</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;{</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="structpdirectory.html">pdirectory_t</a>* new_pdir = (<a class="code" href="structpdirectory.html">pdirectory_t</a>*)<a class="code" href="kmalloc_8h.html#a37b5ea24f8f86ad539ca27fd9f16a7b5">kmalloc_page_aligned</a>();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// coping all tables</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1024; i++) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        new_pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i] = <a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i];</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    new_pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>)] = <a class="code" href="vmm_8c.html#a719e8c1ccd54ec6a9581f2ddfe71a791">_vmm_pspace_gen</a>();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>; i++) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* act_ptable_desc = &amp;<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i];</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs</a>(*act_ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a709771184ce5446a42c57ed9c1fce28e">TABLE_DESC_PRESENT</a>)) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="comment">// COW: blocking current pdir</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs</a>(act_ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b">TABLE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a>(act_ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a42d7fd3c28b1387ab619bd0796e5352b">TABLE_DESC_COPY_ON_WRITE</a>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="comment">// COW: blocking new pdir</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* new_ptable_desc = &amp;new_pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs</a>(new_ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b">TABLE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a>(new_ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a42d7fd3c28b1387ab619bd0796e5352b">TABLE_DESC_COPY_ON_WRITE</a>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="system_8h.html#ad8900a7a71aa23e95fb4ba594cd7a8e4">system_flush_whole_tlb</a>();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">return</span> new_pdir;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div>
<div class="ttc" id="asystem_8h_html_ad8900a7a71aa23e95fb4ba594cd7a8e4"><div class="ttname"><a href="system_8h.html#ad8900a7a71aa23e95fb4ba594cd7a8e4">system_flush_whole_tlb</a></div><div class="ttdeci">static void system_flush_whole_tlb()</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00040">system.h:40</a></div></div>
<div class="ttc" id="avmm_8c_html_a719e8c1ccd54ec6a9581f2ddfe71a791"><div class="ttname"><a href="vmm_8c.html#a719e8c1ccd54ec6a9581f2ddfe71a791">_vmm_pspace_gen</a></div><div class="ttdeci">static table_desc_t _vmm_pspace_gen()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00144">vmm.c:144</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00144">_vmm_pspace_gen()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00050">pdirectory::entities</a>, <a class="el" href="kmalloc_8c_source.html#l00082">kmalloc_page_aligned()</a>, <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="system_8h_source.html#l00040">system_flush_whole_tlb()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00030">TABLE_DESC_COPY_ON_WRITE</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a4035d34c84237c3b4dbfe3e82b3d1814">table_desc_has_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00020">TABLE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00021">TABLE_DESC_WRITABLE</a>, <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>, and <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>.</p>

<p class="reference">Referenced by <a class="el" href="tasking_8c_source.html#l00153">tasking_fork()</a>.</p>

</div>
</div>
<a id="a774ca181f37be6f6c59ad293a5390f90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a774ca181f37be6f6c59ad293a5390f90">&#9670;&nbsp;</a></span>vmm_new_user_pdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a>* vmm_new_user_pdir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>USER PDIR FUNCTIONS The function is supposed to create all new user's pdir. </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00605">605</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;{</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="structpdirectory.html">pdirectory_t</a>* pdir = (<a class="code" href="structpdirectory.html">pdirectory_t</a>*)<a class="code" href="kmalloc_8h.html#a37b5ea24f8f86ad539ca27fd9f16a7b5">kmalloc_page_aligned</a>();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="vmm_8c.html#a29f43ad76f35d72d6682c842ed691653">VMM_USER_TABLES_START</a>; i &lt; <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>; i++) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i] = 0;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>; i &lt; 1024; i++) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="vmm_8c.html#a3ae8c00bdaaa9569270b2f22410da7eb">IS_INDIVIDUAL_PER_DIR</a>(i)) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i] = <a class="code" href="vmm_8c.html#a0621c6ce03a60c64786fc206880d854f">_vmm_kernel_pdir</a>-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i];</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(<a class="code" href="vmm_8c.html#ab71f5fd0fba588a759b27cb0fbd63395">pspace_zone</a>.<a class="code" href="struct____zone.html#aeb749deab54a773b6e22e4ce0747734f">start</a>)] = <a class="code" href="vmm_8c.html#a719e8c1ccd54ec6a9581f2ddfe71a791">_vmm_pspace_gen</a>();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">return</span> pdir;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div>
<div class="ttc" id="avmm_8c_html_a29f43ad76f35d72d6682c842ed691653"><div class="ttname"><a href="vmm_8c.html#a29f43ad76f35d72d6682c842ed691653">VMM_USER_TABLES_START</a></div><div class="ttdeci">#define VMM_USER_TABLES_START</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00029">vmm.c:29</a></div></div>
<div class="ttc" id="avmm_8c_html_a3ae8c00bdaaa9569270b2f22410da7eb"><div class="ttname"><a href="vmm_8c.html#a3ae8c00bdaaa9569270b2f22410da7eb">IS_INDIVIDUAL_PER_DIR</a></div><div class="ttdeci">#define IS_INDIVIDUAL_PER_DIR(index)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00030">vmm.c:30</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00032">_vmm_kernel_pdir</a>, <a class="el" href="vmm_8c_source.html#l00144">_vmm_pspace_gen()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00050">pdirectory::entities</a>, <a class="el" href="vmm_8c_source.html#l00030">IS_INDIVIDUAL_PER_DIR</a>, <a class="el" href="kmalloc_8c_source.html#l00082">kmalloc_page_aligned()</a>, <a class="el" href="vmm_8c_source.html#l00034">pspace_zone</a>, <a class="el" href="zoner_8h_source.html#l00016">__zone::start</a>, <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>, <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>, and <a class="el" href="vmm_8c_source.html#l00029">VMM_USER_TABLES_START</a>.</p>

<p class="reference">Referenced by <a class="el" href="proc_8c_source.html#l00193">proc_load()</a>, and <a class="el" href="tasking_8c_source.html#l00102">tasking_start_init_proc()</a>.</p>

</div>
</div>
<a id="a16ba8dfdae010da851171d247c3eaf8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ba8dfdae010da851171d247c3eaf8f">&#9670;&nbsp;</a></span>vmm_page_fault_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_page_fault_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00841">841</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;{</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> ((info &amp; 0b11) == 0b11) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordtype">bool</span> visited = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#ac7abcdb4891827beb4b8c16a9434b595">_vmm_is_copy_on_write</a>(vaddr)) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <a class="code" href="vmm_8c.html#a1bb7e26783908ccc1e52e0db7a86bada">_vmm_resolve_copy_on_write</a>(vaddr);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            visited = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#af7e02799fa4e188139bc5551aa994db5">_vmm_is_zeroing_on_demand</a>(vaddr)) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <a class="code" href="vmm_8c.html#a76c15c4bfaea211a22150f3dbfbdfeea">_vmm_resolve_zeroing_on_demand</a>(vaddr);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            visited = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">if</span> (!visited) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <a class="code" href="log_8h.html#a01de98826735d07d7d41604a2ced9a64">log_error</a>(<span class="stringliteral">&quot;Write to not writable page&quot;</span>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2mem_2vmm_2vmm_8h.html#add64a97a33270588ebcd987a547c3187a7627fb8ef9db1c88c2a50d7e3d66e250">SHOULD_CRASH</a>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span> ((info &amp; 1) == 0) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a1f2e603f3d376b89fc0f0754483167eb">PAGE_CHOOSE_OWNER</a>(vaddr) == <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da95fc312a8636805454c8ff4f8b872042">PAGE_USER</a> &amp;&amp; <a class="code" href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a>() != <a class="code" href="vmm_8c.html#a608b32b82fa4ba69fd3fee442f8beb6f">vmm_get_kernel_pdir</a>()) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <a class="code" href="structproc.html">proc_t</a>* holder_proc = <a class="code" href="tasking_8h.html#a1e585446aa6f4074801e0251b5d26014">tasking_get_proc_by_pdir</a>(<a class="code" href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a>());</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <span class="keywordflow">if</span> (!holder_proc) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;No proc with the pdir\n&quot;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <a class="code" href="structproc__zone.html">proc_zone_t</a>* zone = <a class="code" href="proc_8h.html#a2eabc72a1102e0bc35213eda25d78b94">proc_find_zone</a>(holder_proc, vaddr);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="keywordflow">if</span> (!zone) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2mem_2vmm_2vmm_8h.html#add64a97a33270588ebcd987a547c3187a7627fb8ef9db1c88c2a50d7e3d66e250">SHOULD_CRASH</a>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="preprocessor">#ifdef VMM_DEBUG</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <a class="code" href="log_8h.html#a5ed8e2adc6340d877478a62cc1d448c9">log</a>(<span class="stringliteral">&quot;Mmap page %x for %d pid: %x&quot;</span>, vaddr, <a class="code" href="tasking_8h.html#a5ec587856ddd0b69124e4fa40258ae0d">RUNNIG_THREAD</a>-&gt;process-&gt;pid, zone-&gt;<a class="code" href="structproc__zone.html#a3501ea528702334625a5356e54b0db7f">flags</a>);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                <a class="code" href="vmm_8c.html#a2cfe8792eb0ed88e04de2397ebb2ddae">vmm_load_page</a>(vaddr, zone-&gt;<a class="code" href="structproc__zone.html#a3501ea528702334625a5356e54b0db7f">flags</a>);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">if</span> (zone-&gt;<a class="code" href="structproc__zone.html#acfc64b72b2c0eaea34fd59a0a8d9718c">type</a> == <a class="code" href="proc_8h.html#a00bb41d1f5d1e8fcf71575c7caed5e3ca31e2cd759ec1c6d18618adb81616b179">ZONE_TYPE_MAPPED_FILE_PRIVATLY</a>) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    zone-&gt;<a class="code" href="structproc__zone.html#aaeafa2c9109f7640240bd9b8e2b56b0b">fd</a>-&gt;<a class="code" href="structfile__descriptor.html#a537de8e2d8331e8edab1ea47ca577418">offset</a> = <a class="code" href="vmm_8c.html#a75169164a5502d98dc9b1fe27ec57ff7">PAGE_START</a>(vaddr) - zone-&gt;<a class="code" href="structproc__zone.html#a70a87d8b8e6e888cfc346bd56dd9bce5">start</a>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    <a class="code" href="vfs_8h.html#ae4bfac60e58e9b1f2ab2a8119d485b56">vfs_read</a>(zone-&gt;<a class="code" href="structproc__zone.html#aaeafa2c9109f7640240bd9b8e2b56b0b">fd</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="vmm_8c.html#a75169164a5502d98dc9b1fe27ec57ff7">PAGE_START</a>(vaddr), <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="comment">/* FIXME: Now we have a standard zone for kernel, but it&#39;s better to do the same thing as for user&#39;s pages */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                <a class="code" href="vmm_8c.html#a2cfe8792eb0ed88e04de2397ebb2ddae">vmm_load_page</a>(vaddr, <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a> | <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <a class="code" href="structproc__zone.html">proc_zone_t</a>* zone = <a class="code" href="proc_8h.html#a2eabc72a1102e0bc35213eda25d78b94">proc_find_zone</a>(<a class="code" href="tasking_8h.html#a5ec587856ddd0b69124e4fa40258ae0d">RUNNIG_THREAD</a>-&gt;process, vaddr);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <a class="code" href="log_8h.html#a01de98826735d07d7d41604a2ced9a64">log_error</a>(<span class="stringliteral">&quot;PF: info %d vaddr %x pdir %x pid %d&quot;</span>, info, vaddr, <a class="code" href="vmm_8c.html#af410d2e8015ab9e19050defa16c05efb">vmm_get_active_pdir</a>(), <a class="code" href="tasking_8h.html#a5ec587856ddd0b69124e4fa40258ae0d">RUNNIG_THREAD</a>-&gt;process-&gt;pid);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2mem_2vmm_2vmm_8h.html#add64a97a33270588ebcd987a547c3187a7627fb8ef9db1c88c2a50d7e3d66e250">SHOULD_CRASH</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="include_2mem_2vmm_2vmm_8h.html#add64a97a33270588ebcd987a547c3187a2bc49ec37d6a5715dd23e85f1ff5bb59">OK</a>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_add64a97a33270588ebcd987a547c3187a2bc49ec37d6a5715dd23e85f1ff5bb59"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#add64a97a33270588ebcd987a547c3187a2bc49ec37d6a5715dd23e85f1ff5bb59">OK</a></div><div class="ttdeci">@ OK</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00054">vmm.h:54</a></div></div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_add64a97a33270588ebcd987a547c3187a7627fb8ef9db1c88c2a50d7e3d66e250"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#add64a97a33270588ebcd987a547c3187a7627fb8ef9db1c88c2a50d7e3d66e250">SHOULD_CRASH</a></div><div class="ttdeci">@ SHOULD_CRASH</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00055">vmm.h:55</a></div></div>
<div class="ttc" id="aproc_8h_html_a00bb41d1f5d1e8fcf71575c7caed5e3ca31e2cd759ec1c6d18618adb81616b179"><div class="ttname"><a href="proc_8h.html#a00bb41d1f5d1e8fcf71575c7caed5e3ca31e2cd759ec1c6d18618adb81616b179">ZONE_TYPE_MAPPED_FILE_PRIVATLY</a></div><div class="ttdeci">@ ZONE_TYPE_MAPPED_FILE_PRIVATLY</div><div class="ttdef"><b>Definition:</b> <a href="proc_8h_source.html#l00037">proc.h:37</a></div></div>
<div class="ttc" id="aproc_8h_html_a2eabc72a1102e0bc35213eda25d78b94"><div class="ttname"><a href="proc_8h.html#a2eabc72a1102e0bc35213eda25d78b94">proc_find_zone</a></div><div class="ttdeci">proc_zone_t * proc_find_zone(proc_t *p, uint32_t addr)</div><div class="ttdef"><b>Definition:</b> <a href="proc__zoner_8c_source.html#l00127">proc_zoner.c:127</a></div></div>
<div class="ttc" id="astructfile__descriptor_html_a537de8e2d8331e8edab1ea47ca577418"><div class="ttname"><a href="structfile__descriptor.html#a537de8e2d8331e8edab1ea47ca577418">file_descriptor::offset</a></div><div class="ttdeci">uint32_t offset</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00130">vfs.h:130</a></div></div>
<div class="ttc" id="astructproc__zone_html"><div class="ttname"><a href="structproc__zone.html">proc_zone</a></div><div class="ttdef"><b>Definition:</b> <a href="proc_8h_source.html#l00041">proc.h:41</a></div></div>
<div class="ttc" id="astructproc__zone_html_a3501ea528702334625a5356e54b0db7f"><div class="ttname"><a href="structproc__zone.html#a3501ea528702334625a5356e54b0db7f">proc_zone::flags</a></div><div class="ttdeci">uint32_t flags</div><div class="ttdef"><b>Definition:</b> <a href="proc_8h_source.html#l00045">proc.h:45</a></div></div>
<div class="ttc" id="astructproc__zone_html_a70a87d8b8e6e888cfc346bd56dd9bce5"><div class="ttname"><a href="structproc__zone.html#a70a87d8b8e6e888cfc346bd56dd9bce5">proc_zone::start</a></div><div class="ttdeci">uint32_t start</div><div class="ttdef"><b>Definition:</b> <a href="proc_8h_source.html#l00042">proc.h:42</a></div></div>
<div class="ttc" id="astructproc__zone_html_aaeafa2c9109f7640240bd9b8e2b56b0b"><div class="ttname"><a href="structproc__zone.html#aaeafa2c9109f7640240bd9b8e2b56b0b">proc_zone::fd</a></div><div class="ttdeci">file_descriptor_t * fd</div><div class="ttdef"><b>Definition:</b> <a href="proc_8h_source.html#l00046">proc.h:46</a></div></div>
<div class="ttc" id="astructproc__zone_html_acfc64b72b2c0eaea34fd59a0a8d9718c"><div class="ttname"><a href="structproc__zone.html#acfc64b72b2c0eaea34fd59a0a8d9718c">proc_zone::type</a></div><div class="ttdeci">uint32_t type</div><div class="ttdef"><b>Definition:</b> <a href="proc_8h_source.html#l00044">proc.h:44</a></div></div>
<div class="ttc" id="astructproc_html"><div class="ttname"><a href="structproc.html">proc</a></div><div class="ttdef"><b>Definition:</b> <a href="proc_8h_source.html#l00059">proc.h:59</a></div></div>
<div class="ttc" id="atasking_8h_html_a1e585446aa6f4074801e0251b5d26014"><div class="ttname"><a href="tasking_8h.html#a1e585446aa6f4074801e0251b5d26014">tasking_get_proc_by_pdir</a></div><div class="ttdeci">proc_t * tasking_get_proc_by_pdir(pdirectory_t *pdir)</div><div class="ttdef"><b>Definition:</b> <a href="tasking_8c_source.html#l00067">tasking.c:67</a></div></div>
<div class="ttc" id="atasking_8h_html_a5ec587856ddd0b69124e4fa40258ae0d"><div class="ttname"><a href="tasking_8h.html#a5ec587856ddd0b69124e4fa40258ae0d">RUNNIG_THREAD</a></div><div class="ttdeci">#define RUNNIG_THREAD</div><div class="ttdef"><b>Definition:</b> <a href="tasking_8h_source.html#l00022">tasking.h:22</a></div></div>
<div class="ttc" id="avfs_8h_html_ae4bfac60e58e9b1f2ab2a8119d485b56"><div class="ttname"><a href="vfs_8h.html#ae4bfac60e58e9b1f2ab2a8119d485b56">vfs_read</a></div><div class="ttdeci">int vfs_read(file_descriptor_t *fd, uint8_t *buf, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8c_source.html#l00299">vfs.c:299</a></div></div>
<div class="ttc" id="avmm_8c_html_a608b32b82fa4ba69fd3fee442f8beb6f"><div class="ttname"><a href="vmm_8c.html#a608b32b82fa4ba69fd3fee442f8beb6f">vmm_get_kernel_pdir</a></div><div class="ttdeci">pdirectory_t * vmm_get_kernel_pdir()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00732">vmm.c:732</a></div></div>
<div class="ttc" id="avmm_8c_html_a76c15c4bfaea211a22150f3dbfbdfeea"><div class="ttname"><a href="vmm_8c.html#a76c15c4bfaea211a22150f3dbfbdfeea">_vmm_resolve_zeroing_on_demand</a></div><div class="ttdeci">static void _vmm_resolve_zeroing_on_demand(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00576">vmm.c:576</a></div></div>
<div class="ttc" id="avmm_8c_html_af7e02799fa4e188139bc5551aa994db5"><div class="ttname"><a href="vmm_8c.html#af7e02799fa4e188139bc5551aa994db5">_vmm_is_zeroing_on_demand</a></div><div class="ttdeci">static bool _vmm_is_zeroing_on_demand(uint32_t vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00565">vmm.c:565</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00481">_vmm_is_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00565">_vmm_is_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00576">_vmm_resolve_zeroing_on_demand()</a>, <a class="el" href="proc_8h_source.html#l00046">proc_zone::fd</a>, <a class="el" href="proc_8h_source.html#l00045">proc_zone::flags</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="log_8c_source.html#l00062">log()</a>, <a class="el" href="log_8c_source.html#l00122">log_error()</a>, <a class="el" href="vfs_8h_source.html#l00130">file_descriptor::offset</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00054">OK</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00032">PAGE_CHOOSE_OWNER</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="vmm_8c_source.html#l00026">PAGE_START</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00027">PAGE_USER</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, <a class="el" href="proc__zoner_8c_source.html#l00127">proc_find_zone()</a>, <a class="el" href="tasking_8h_source.html#l00022">RUNNIG_THREAD</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00055">SHOULD_CRASH</a>, <a class="el" href="proc_8h_source.html#l00042">proc_zone::start</a>, <a class="el" href="tasking_8c_source.html#l00067">tasking_get_proc_by_pdir()</a>, <a class="el" href="proc_8h_source.html#l00044">proc_zone::type</a>, <a class="el" href="vfs_8c_source.html#l00299">vfs_read()</a>, <a class="el" href="vmm_8c_source.html#l00727">vmm_get_active_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00732">vmm_get_kernel_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00775">vmm_load_page()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, and <a class="el" href="proc_8h_source.html#l00037">ZONE_TYPE_MAPPED_FILE_PRIVATLY</a>.</p>

<p class="reference">Referenced by <a class="el" href="isr__handler_8c_source.html#l00046">isr_handler()</a>.</p>

</div>
</div>
<a id="ab22a83d25d138540fce05ecdda830a11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22a83d25d138540fce05ecdda830a11">&#9670;&nbsp;</a></span>vmm_pdirectory_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2boot_2x86_2stage2_2mem_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* vmm_pdirectory_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td>
          <td class="paramname"><em>pdir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00322">322</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (pdir) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">return</span> &amp;pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[<a class="code" href="vmm_8c.html#a3711dfec5fdda52c3ea8f3884f92e544">VMM_OFFSET_IN_DIRECTORY</a>(vaddr)];</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00050">pdirectory::entities</a>, and <a class="el" href="vmm_8c_source.html#l00022">VMM_OFFSET_IN_DIRECTORY</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00246">_vmm_create_kernel_ptables()</a>, <a class="el" href="vmm_8c_source.html#l00481">_vmm_is_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00565">_vmm_is_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00121">_vmm_pspace_init()</a>, <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00576">_vmm_resolve_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00342">vmm_allocate_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, and <a class="el" href="vmm_8c_source.html#l00437">vmm_unmap_page()</a>.</p>

</div>
</div>
<a id="a35d8684b806f9433a8d62abca47379a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35d8684b806f9433a8d62abca47379a3">&#9670;&nbsp;</a></span>vmm_ptable_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="src_2boot_2x86_2stage2_2mem_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* vmm_ptable_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structptable__t.html">ptable_t</a> *&#160;</td>
          <td class="paramname"><em>ptable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00330">330</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (ptable) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">return</span> &amp;ptable-&gt;<a class="code" href="structptable__t.html#a3e7450748f2661e4b025c2bda937617f">entities</a>[<a class="code" href="vmm_8c.html#aef0153575274ce9a5768ce3f2501d81b">VMM_OFFSET_IN_TABLE</a>(vaddr)];</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00046">ptable_t::entities</a>, and <a class="el" href="vmm_8c_source.html#l00023">VMM_OFFSET_IN_TABLE</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00198">_vmm_convert_vaddr2paddr()</a>, <a class="el" href="vmm_8c_source.html#l00537">_vmm_copy_page_to_resolve_cow()</a>, <a class="el" href="vmm_8c_source.html#l00565">_vmm_is_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00188">_vmm_kernel_convert_vaddr2paddr()</a>, <a class="el" href="vmm_8c_source.html#l00121">_vmm_pspace_init()</a>, <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00576">_vmm_resolve_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00792">vmm_copy_page()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, <a class="el" href="vmm_8c_source.html#l00941">vmm_test_pspace_vaddr_of_active_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00741">vmm_tune_page()</a>, and <a class="el" href="vmm_8c_source.html#l00437">vmm_unmap_page()</a>.</p>

</div>
</div>
<a id="af4ed73aa44bec054aca84591d0510593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ed73aa44bec054aca84591d0510593">&#9670;&nbsp;</a></span>vmm_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PUBLIC FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00288">288</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="zoner_8h.html#ac10e627cdfbf62f57da7faae31edc5ab">zoner_init</a>(0xc0400000);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="vmm_8c.html#a6d9ffd126bc6c4fe342faa7f58d14f95">_vmm_split_pspace</a>();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="vmm_8c.html#a63f9a860b1f1131d396a2ddbc855064e">_vmm_create_kernel_ptables</a>();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="vmm_8c.html#a27f394de96dbb406fb49fd21f05870b2">_vmm_pspace_init</a>();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="vmm_8c.html#a1c129dfab11d2a20a093d79f78acdb7a">_vmm_init_switch_to_kernel_pdir</a>();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="vmm_8c.html#ace837bd97087269efb03120fdfad256c">_vmm_map_kernel</a>();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="zoner_8h.html#a53bd706786baff3a2828d0fff3017160">zoner_place_bitmap</a>();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="kmalloc_8h.html#a5333a86fa531afe56c03b5a5efe51805">kmalloc_init</a>();</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#afa9e823e5347e58f73b8d687ba466123">_vmm_self_test</a>() &lt; 0) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;VMM SELF TEST Not passed&quot;</span>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="ttc" id="akmalloc_8h_html_a5333a86fa531afe56c03b5a5efe51805"><div class="ttname"><a href="kmalloc_8h.html#a5333a86fa531afe56c03b5a5efe51805">kmalloc_init</a></div><div class="ttdeci">void kmalloc_init()</div><div class="ttdef"><b>Definition:</b> <a href="kmalloc_8c_source.html#l00047">kmalloc.c:47</a></div></div>
<div class="ttc" id="avmm_8c_html_a1c129dfab11d2a20a093d79f78acdb7a"><div class="ttname"><a href="vmm_8c.html#a1c129dfab11d2a20a093d79f78acdb7a">_vmm_init_switch_to_kernel_pdir</a></div><div class="ttdeci">static bool _vmm_init_switch_to_kernel_pdir()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00218">vmm.c:218</a></div></div>
<div class="ttc" id="avmm_8c_html_a27f394de96dbb406fb49fd21f05870b2"><div class="ttname"><a href="vmm_8c.html#a27f394de96dbb406fb49fd21f05870b2">_vmm_pspace_init</a></div><div class="ttdeci">static void _vmm_pspace_init()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00121">vmm.c:121</a></div></div>
<div class="ttc" id="avmm_8c_html_a63f9a860b1f1131d396a2ddbc855064e"><div class="ttname"><a href="vmm_8c.html#a63f9a860b1f1131d396a2ddbc855064e">_vmm_create_kernel_ptables</a></div><div class="ttdeci">static bool _vmm_create_kernel_ptables()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00246">vmm.c:246</a></div></div>
<div class="ttc" id="avmm_8c_html_a6d9ffd126bc6c4fe342faa7f58d14f95"><div class="ttname"><a href="vmm_8c.html#a6d9ffd126bc6c4fe342faa7f58d14f95">_vmm_split_pspace</a></div><div class="ttdeci">static bool _vmm_split_pspace()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00100">vmm.c:100</a></div></div>
<div class="ttc" id="avmm_8c_html_ace837bd97087269efb03120fdfad256c"><div class="ttname"><a href="vmm_8c.html#ace837bd97087269efb03120fdfad256c">_vmm_map_kernel</a></div><div class="ttdeci">static bool _vmm_map_kernel()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00282">vmm.c:282</a></div></div>
<div class="ttc" id="avmm_8c_html_afa9e823e5347e58f73b8d687ba466123"><div class="ttname"><a href="vmm_8c.html#afa9e823e5347e58f73b8d687ba466123">_vmm_self_test</a></div><div class="ttdeci">static int _vmm_self_test()</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00927">vmm.c:927</a></div></div>
<div class="ttc" id="azoner_8h_html_a53bd706786baff3a2828d0fff3017160"><div class="ttname"><a href="zoner_8h.html#a53bd706786baff3a2828d0fff3017160">zoner_place_bitmap</a></div><div class="ttdeci">void zoner_place_bitmap()</div><div class="ttdef"><b>Definition:</b> <a href="zoner_8c_source.html#l00049">zoner.c:49</a></div></div>
<div class="ttc" id="azoner_8h_html_ac10e627cdfbf62f57da7faae31edc5ab"><div class="ttname"><a href="zoner_8h.html#ac10e627cdfbf62f57da7faae31edc5ab">zoner_init</a></div><div class="ttdeci">void zoner_init(uint32_t start_vaddr)</div><div class="ttdef"><b>Definition:</b> <a href="zoner_8c_source.html#l00058">zoner.c:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00246">_vmm_create_kernel_ptables()</a>, <a class="el" href="vmm_8c_source.html#l00218">_vmm_init_switch_to_kernel_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00282">_vmm_map_kernel()</a>, <a class="el" href="vmm_8c_source.html#l00121">_vmm_pspace_init()</a>, <a class="el" href="vmm_8c_source.html#l00927">_vmm_self_test()</a>, <a class="el" href="vmm_8c_source.html#l00100">_vmm_split_pspace()</a>, <a class="el" href="kmalloc_8c_source.html#l00047">kmalloc_init()</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="zoner_8c_source.html#l00058">zoner_init()</a>, and <a class="el" href="zoner_8c_source.html#l00049">zoner_place_bitmap()</a>.</p>

<p class="reference">Referenced by <a class="el" href="kernel_8c_source.html#l00066">stage3()</a>.</p>

</div>
</div>
<a id="ad7f59ea1a3f32fdbcb8e9a322ff098ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7f59ea1a3f32fdbcb8e9a322ff098ef">&#9670;&nbsp;</a></span>vmm_switch_pdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_switch_pdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td>
          <td class="paramname"><em>pdir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>CPU BASED FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00896">896</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;{</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)pdir &amp; (<a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a> - 1)) != 0) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;vmm_switch_pdir: wrong pdir&quot;</span>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <a class="code" href="system_8h.html#a703bc6b45945b4d70aea606f7fbf26d6">system_disable_interrupts</a>();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a> == pdir) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <a class="code" href="system_8h.html#a18251f86dd00a2f140019744e32329c2">system_enable_interrupts</a>();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a> = pdir;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="system_8h.html#a7ef51a49f2d93b076c43404b918f0bf1">system_set_pdir</a>((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="vmm_8c.html#ae922e29314c0d14760e10364e4d06a24">_vmm_convert_vaddr2paddr</a>((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)pdir));</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="system_8h.html#a18251f86dd00a2f140019744e32329c2">system_enable_interrupts</a>();</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00198">_vmm_convert_vaddr2paddr()</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="system_8c_source.html#l00015">system_disable_interrupts()</a>, <a class="el" href="system_8c_source.html#l00021">system_enable_interrupts()</a>, <a class="el" href="system_8h_source.html#l00027">system_set_pdir()</a>, and <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="proc_8c_source.html#l00193">proc_load()</a>, <a class="el" href="signal_8c_source.html#l00123">signal_setup_stack_to_handle_signal()</a>, <a class="el" href="switchvm_8c_source.html#l00008">switchuvm()</a>, <a class="el" href="vmm_8c_source.html#l00694">vmm_copy_to_pdir()</a>, and <a class="el" href="vmm_8c_source.html#l00657">vmm_free_pdir()</a>.</p>

</div>
</div>
<a id="a75361d9553a4cc2b336609f64e4c34c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75361d9553a4cc2b336609f64e4c34c6">&#9670;&nbsp;</a></span>vmm_test_pspace_vaddr_of_active_ptable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> vmm_test_pspace_vaddr_of_active_ptable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00941">941</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;{</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> vaddr = 0xc0000000;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* pt = <a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* ppage = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(pt, vaddr);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(ppage, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a>);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>* kek1 = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>*)vaddr;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    *kek1 = 1;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// should cause PF</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">PAGE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

</div>
</div>
<a id="a78710242c8a4d6cb0932266aa8700781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78710242c8a4d6cb0932266aa8700781">&#9670;&nbsp;</a></span>vmm_tune_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_tune_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PF HANDLER FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00741">741</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;{</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordtype">bool</span> is_writable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da9c2267316b5684a340c1ae0e4631f625">PAGE_WRITABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordtype">bool</span> is_readable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da23985d6a3a437bf06507732842042c0b">PAGE_READABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordtype">bool</span> is_executable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da47ca21a302e99e0b8286b0ba10d8040f">PAGE_EXECUTABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordtype">bool</span> is_not_cacheable = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07dad3edcfb281d2d1a53c180f4675ebf330">PAGE_NOT_CACHEABLE</a>) &gt; 0);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordtype">bool</span> is_cow = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da79b8a359b1365250e9ce934bc893e57f">PAGE_COW</a>) &gt; 0);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordtype">bool</span> is_user = ((settings &amp; <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5a48a1c50700ac0a546b1d10b4a8a07da95fc312a8636805454c8ff4f8b872042">PAGE_USER</a>) &gt; 0);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable = (<a class="code" href="structptable__t.html">ptable_t</a>*)<a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* page = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable, vaddr);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a3b36e04616b3bc47dbbd2c74c91cf0cd">page_desc_is_present</a>(*page)) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        is_user ? <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a7ca7102ce672ea81bbd1a9c2ed308a21">PAGE_DESC_USER</a>) : <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a7ca7102ce672ea81bbd1a9c2ed308a21">PAGE_DESC_USER</a>);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        is_writable ? <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>) : <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        is_not_cacheable ? <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7ab96692f27bbdcfc83b9dbf290c1cae67">PAGE_DESC_NOT_CACHEABLE</a>) : <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7ab96692f27bbdcfc83b9dbf290c1cae67">PAGE_DESC_NOT_CACHEABLE</a>);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <a class="code" href="vmm_8c.html#a2cfe8792eb0ed88e04de2397ebb2ddae">vmm_load_page</a>(vaddr, settings);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="system_8h.html#ad5cf99cf03af1b1723d99768a6f4745c">system_flush_tlb_entry</a>(vaddr);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00026">PAGE_COW</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a3b36e04616b3bc47dbbd2c74c91cf0cd">page_desc_is_present()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00024">PAGE_DESC_NOT_CACHEABLE</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#abebdb4783fd1015ea6c6e6fa4635ccdc">page_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00022">PAGE_DESC_USER</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00021">PAGE_DESC_WRITABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00024">PAGE_EXECUTABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00025">PAGE_NOT_CACHEABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00023">PAGE_READABLE</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00027">PAGE_USER</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00022">PAGE_WRITABLE</a>, <a class="el" href="system_8h_source.html#l00034">system_flush_tlb_entry()</a>, <a class="el" href="vmm_8c_source.html#l00775">vmm_load_page()</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="signal_8c_source.html#l00036">_signal_init_caller()</a>, and <a class="el" href="vmm_8c_source.html#l00765">vmm_tune_pages()</a>.</p>

</div>
</div>
<a id="a6f6f63bcf4d688f1ce6fcb8bc782cd32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f6f63bcf4d688f1ce6fcb8bc782cd32">&#9670;&nbsp;</a></span>vmm_tune_pages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_tune_pages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00765">765</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;{</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> page_addr = <a class="code" href="vmm_8c.html#a75169164a5502d98dc9b1fe27ec57ff7">PAGE_START</a>(vaddr);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">while</span> (page_addr &lt; vaddr + length) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <a class="code" href="vmm_8c.html#a78710242c8a4d6cb0932266aa8700781">vmm_tune_page</a>(page_addr, settings);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        page_addr += <a class="code" href="include_2mem_2vmm_2vmm_8h.html#a5f1b9da0ed7c272c7b595fd332483e40">VMM_PAGE_SIZE</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div>
<div class="ttc" id="avmm_8c_html_a78710242c8a4d6cb0932266aa8700781"><div class="ttname"><a href="vmm_8c.html#a78710242c8a4d6cb0932266aa8700781">vmm_tune_page</a></div><div class="ttdeci">int vmm_tune_page(uint32_t vaddr, uint32_t settings)</div><div class="ttdef"><b>Definition:</b> <a href="vmm_8c_source.html#l00741">vmm.c:741</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00026">PAGE_START</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00036">VMM_PAGE_SIZE</a>, and <a class="el" href="vmm_8c_source.html#l00741">vmm_tune_page()</a>.</p>

<p class="reference">Referenced by <a class="el" href="shared__buffer_8c_source.html#l00074">shared_buffer_create()</a>.</p>

</div>
</div>
<a id="ae843e6ecc554a821adbd89275b74c41d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae843e6ecc554a821adbd89275b74c41d">&#9670;&nbsp;</a></span>vmm_unmap_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vmm_unmap_page </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>vaddr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00437">437</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;{</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694ae84da6fb51c8a731a03f2bc5a17c372c">VMM_ERR_PDIR</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = <a class="code" href="vmm_8c.html#ab22a83d25d138540fce05ecdda830a11">vmm_pdirectory_lookup</a>(<a class="code" href="vmm_8c.html#a80d3bb55f78af993af1528942aec0119">_vmm_active_pdir</a>, vaddr);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#aab37e1fdbf4ced79e2592a39d99c0373">table_desc_is_present</a>(*ptable_desc)) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694a2d2fe040e3d909d423d8efc94e7bc068">VMM_ERR_PTABLE</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="structptable__t.html">ptable_t</a>* ptable = (<a class="code" href="structptable__t.html">ptable_t</a>*)<a class="code" href="vmm_8c.html#aadbf1e80ec16fe23449ee1e43d8a6280">_vmm_pspace_get_vaddr_of_active_ptable</a>(vaddr);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a1f75ec081d665c51011f32bb291b9081">page_desc_t</a>* page = <a class="code" href="vmm_8c.html#a35d8684b806f9433a8d62abca47379a3">vmm_ptable_lookup</a>(ptable, vaddr);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a9f540589bfc32eb8405535bf6952a57a">PAGE_DESC_PRESENT</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs</a>(page, <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#aff135280ad5a239c3a322a707bf547e7a4380fd009f06de944dde32e3be67e0d7">PAGE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="include_2platform_2x86_2vmm_2pte_8h.html#a4fbb97c8134efed8c8eb0e113c98a35b">page_desc_del_frame</a>(page);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="system_8h.html#ad5cf99cf03af1b1723d99768a6f4745c">system_flush_tlb_entry</a>(vaddr);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div>
<div class="ttc" id="ainclude_2mem_2vmm_2vmm_8h_html_ad883d0ea3e855fecd156a84e04a7f694a2d2fe040e3d909d423d8efc94e7bc068"><div class="ttname"><a href="include_2mem_2vmm_2vmm_8h.html#ad883d0ea3e855fecd156a84e04a7f694a2d2fe040e3d909d423d8efc94e7bc068">VMM_ERR_PTABLE</a></div><div class="ttdeci">@ VMM_ERR_PTABLE</div><div class="ttdef"><b>Definition:</b> <a href="include_2mem_2vmm_2vmm_8h_source.html#l00040">vmm.h:40</a></div></div>
<div class="ttc" id="ainclude_2platform_2x86_2vmm_2pte_8h_html_a4fbb97c8134efed8c8eb0e113c98a35b"><div class="ttname"><a href="include_2platform_2x86_2vmm_2pte_8h.html#a4fbb97c8134efed8c8eb0e113c98a35b">page_desc_del_frame</a></div><div class="ttdeci">void page_desc_del_frame(uint32_t *pte)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vmm_8c_source.html#l00033">_vmm_active_pdir</a>, <a class="el" href="vmm_8c_source.html#l00095">_vmm_pspace_get_vaddr_of_active_ptable()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a55c71b867e7b987b105f520099710bf8">page_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h.html#a4fbb97c8134efed8c8eb0e113c98a35b">page_desc_del_frame()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00020">PAGE_DESC_PRESENT</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00014">page_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pte_8h_source.html#l00021">PAGE_DESC_WRITABLE</a>, <a class="el" href="system_8h_source.html#l00034">system_flush_tlb_entry()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#aab37e1fdbf4ced79e2592a39d99c0373">table_desc_is_present()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00039">VMM_ERR_PDIR</a>, <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00040">VMM_ERR_PTABLE</a>, <a class="el" href="vmm_8c_source.html#l00322">vmm_pdirectory_lookup()</a>, and <a class="el" href="vmm_8c_source.html#l00330">vmm_ptable_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00537">_vmm_copy_page_to_resolve_cow()</a>, <a class="el" href="vmm_8c_source.html#l00144">_vmm_pspace_gen()</a>, and <a class="el" href="vmm_8c_source.html#l00792">vmm_copy_page()</a>.</p>

</div>
</div>
<a id="adb5a566ddf130d9a4f0b49ee6a57b7fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb5a566ddf130d9a4f0b49ee6a57b7fe">&#9670;&nbsp;</a></span>vmm_zero_user_pages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vmm_zero_user_pages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a> *&#160;</td>
          <td class="paramname"><em>pdir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00718">718</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="vmm_8c.html#a94be9fd98a7a3e28deb2d14841bc5819">VMM_KERNEL_TABLES_START</a>; i++) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a26415a58766c2bb02c5b17a457b214e7">table_desc_t</a>* ptable_desc = &amp;pdir-&gt;<a class="code" href="structpdirectory.html#af0b06d8b8ed771ab45e5e9de95363bdf">entities</a>[i];</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs</a>(ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623ada2e38ff60d1cb45c4b270216e71037b">TABLE_DESC_WRITABLE</a>);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs</a>(ptable_desc, <a class="code" href="include_2platform_2x86_2vmm_2pde_8h.html#a9dae1b6be624dbeb728e098b25490623a33ae2ce1c381ac617bd271d9b5502b94">TABLE_DESC_ZEROING_ON_DEMAND</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2mem_2vmm_2vmm_8h_source.html#l00050">pdirectory::entities</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a639c25a7d911a4c2afb81e0769507772">table_desc_del_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h.html#a9933e6ff769513e9fd19aed787ea994d">table_desc_set_attrs()</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00014">table_desc_t</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00021">TABLE_DESC_WRITABLE</a>, <a class="el" href="include_2platform_2x86_2vmm_2pde_8h_source.html#l00031">TABLE_DESC_ZEROING_ON_DEMAND</a>, and <a class="el" href="vmm_8c_source.html#l00028">VMM_KERNEL_TABLES_START</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a80d3bb55f78af993af1528942aec0119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80d3bb55f78af993af1528942aec0119">&#9670;&nbsp;</a></span>_vmm_active_pdir</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a>* _vmm_active_pdir</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00033">33</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00218">_vmm_init_switch_to_kernel_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00481">_vmm_is_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00565">_vmm_is_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00085">_vmm_pspace_get_vaddr_of_active_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00121">_vmm_pspace_init()</a>, <a class="el" href="vmm_8c_source.html#l00488">_vmm_resolve_copy_on_write()</a>, <a class="el" href="vmm_8c_source.html#l00576">_vmm_resolve_zeroing_on_demand()</a>, <a class="el" href="vmm_8c_source.html#l00100">_vmm_split_pspace()</a>, <a class="el" href="vmm_8c_source.html#l00342">vmm_allocate_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00367">vmm_free_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00727">vmm_get_active_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00393">vmm_map_page()</a>, <a class="el" href="vmm_8c_source.html#l00628">vmm_new_forked_user_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00896">vmm_switch_pdir()</a>, and <a class="el" href="vmm_8c_source.html#l00437">vmm_unmap_page()</a>.</p>

</div>
</div>
<a id="a0621c6ce03a60c64786fc206880d854f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0621c6ce03a60c64786fc206880d854f">&#9670;&nbsp;</a></span>_vmm_kernel_pdir</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2mem_2vmm_2vmm_8h.html#ab35e582fd27e71d9d959b59686ab4fa1">pdirectory_t</a>* _vmm_kernel_pdir</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00032">32</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00246">_vmm_create_kernel_ptables()</a>, <a class="el" href="vmm_8c_source.html#l00218">_vmm_init_switch_to_kernel_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00100">_vmm_split_pspace()</a>, <a class="el" href="vmm_8c_source.html#l00657">vmm_free_pdir()</a>, <a class="el" href="vmm_8c_source.html#l00732">vmm_get_kernel_pdir()</a>, and <a class="el" href="vmm_8c_source.html#l00605">vmm_new_user_pdir()</a>.</p>

</div>
</div>
<a id="a91bba8fda41b781948a9379cc516320d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91bba8fda41b781948a9379cc516320d">&#9670;&nbsp;</a></span>kernel_ptables_start_paddr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> kernel_ptables_start_paddr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00035">35</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00188">_vmm_kernel_convert_vaddr2paddr()</a>, <a class="el" href="vmm_8c_source.html#l00232">_vmm_map_init_kernel_pages()</a>, <a class="el" href="vmm_8c_source.html#l00121">_vmm_pspace_init()</a>, and <a class="el" href="vmm_8c_source.html#l00100">_vmm_split_pspace()</a>.</p>

</div>
</div>
<a id="ab71f5fd0fba588a759b27cb0fbd63395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71f5fd0fba588a759b27cb0fbd63395">&#9670;&nbsp;</a></span>pspace_zone</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="zoner_8h.html#acffe166c8e6cd29702dbb58801c54ccf">zone_t</a> pspace_zone</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmm_8c_source.html#l00034">34</a> of file <a class="el" href="vmm_8c_source.html">vmm.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="vmm_8c_source.html#l00246">_vmm_create_kernel_ptables()</a>, <a class="el" href="vmm_8c_source.html#l00174">_vmm_free_pspace()</a>, <a class="el" href="vmm_8c_source.html#l00144">_vmm_pspace_gen()</a>, <a class="el" href="vmm_8c_source.html#l00090">_vmm_pspace_get_nth_active_ptable()</a>, <a class="el" href="vmm_8c_source.html#l00121">_vmm_pspace_init()</a>, <a class="el" href="vmm_8c_source.html#l00100">_vmm_split_pspace()</a>, <a class="el" href="vmm_8c_source.html#l00628">vmm_new_forked_user_pdir()</a>, and <a class="el" href="vmm_8c_source.html#l00605">vmm_new_user_pdir()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 26 2021 19:11:30 for oneOS by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
