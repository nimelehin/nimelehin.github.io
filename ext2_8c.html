<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>oneOS: src/kernel/fs/ext2/ext2.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">oneOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cbd7f246bdf7dc0a50281a272327e6ed.html">kernel</a></li><li class="navelem"><a class="el" href="dir_f848a285e60993dcb3189737897d2857.html">fs</a></li><li class="navelem"><a class="el" href="dir_f9643893121623801faf5d4a81130ae9.html">ext2</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ext2.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;<a class="el" href="vfs_8h_source.html">fs/vfs.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="log_8h_source.html">log.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="kmalloc_8h_source.html">mem/kmalloc.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="time__manager_8h_source.html">time/time_manager.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="kassert_8h_source.html">utils/kassert.h</a>&gt;</code><br />
</div>
<p><a href="ext2_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:adce1205ff8b13b823ae9ff542dcb5b00"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:adce1205ff8b13b823ae9ff542dcb5b00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f3678bf5eae3684fc497130b946eae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(X,  Y)&#160;&#160;&#160;(((X) &lt; (Y)) ? (X) : (Y))</td></tr>
<tr class="separator:ad2f3678bf5eae3684fc497130b946eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4cb8adac167448da16a169f41dbbc4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#abc4cb8adac167448da16a169f41dbbc4">SUPERBLOCK</a>&#160;&#160;&#160;<a class="el" href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a>[dev-&gt;dev-&gt;id]</td></tr>
<tr class="separator:abc4cb8adac167448da16a169f41dbbc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc69b6e5d0cec1c42f5c7365ab30ef32"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#afc69b6e5d0cec1c42f5c7365ab30ef32">GROUP_TABLES</a>&#160;&#160;&#160;<a class="el" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a>[dev-&gt;dev-&gt;id].table</td></tr>
<tr class="separator:afc69b6e5d0cec1c42f5c7365ab30ef32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11d5ade1069f3f4d7a086be6679b044"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(sb)&#160;&#160;&#160;(1024 &lt;&lt; (sb-&gt;log_block_size))</td></tr>
<tr class="separator:af11d5ade1069f3f4d7a086be6679b044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dc3a65e10750e9b6a798a7b54918186"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(sb,  x)&#160;&#160;&#160;(x / (2 &lt;&lt; (sb-&gt;log_block_size)))</td></tr>
<tr class="separator:a9dc3a65e10750e9b6a798a7b54918186"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0df43d2359093fd8019da90f7cadb93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ac0df43d2359093fd8019da90f7cadb93">NORM_FILENAME</a>(x)&#160;&#160;&#160;(x + ((4 - (x &amp; 0b11)) &amp; 0b11))</td></tr>
<tr class="separator:ac0df43d2359093fd8019da90f7cadb93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a68189b69db6004f957e788bffd642c02"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdriver__desc__t.html">driver_desc_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a68189b69db6004f957e788bffd642c02">_ext2_driver_info</a> ()</td></tr>
<tr class="separator:a68189b69db6004f957e788bffd642c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c62a613f06d8c74885169dfb8cfc3fd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="utester_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:a2c62a613f06d8c74885169dfb8cfc3fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ba5958992cad0916f5c5cde7da082b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="utester_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:ac3ba5958992cad0916f5c5cde7da082b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3a1742ecfeaccd951a6608d43788fff"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ab3a1742ecfeaccd951a6608d43788fff">_ext2_get_disk_size</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev)</td></tr>
<tr class="separator:ab3a1742ecfeaccd951a6608d43788fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af42fc74892d7f538598a9dfcd4501ccd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#af42fc74892d7f538598a9dfcd4501ccd">_ext2_bitmap_get</a> (<a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="structbitmap.html">bitmap</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> index)</td></tr>
<tr class="separator:af42fc74892d7f538598a9dfcd4501ccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ea265adf1148a553710998c6809cb5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a28ea265adf1148a553710998c6809cb5">_ext2_bitmap_set_bit</a> (<a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="structbitmap.html">bitmap</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> index)</td></tr>
<tr class="separator:a28ea265adf1148a553710998c6809cb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d1851885a1837ea695e388e996ab1bb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a7d1851885a1837ea695e388e996ab1bb">_ext2_bitmap_unset_bit</a> (<a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="structbitmap.html">bitmap</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> index)</td></tr>
<tr class="separator:a7d1851885a1837ea695e388e996ab1bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853d9483f0f37d321c07ea1c5472fdba"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a853d9483f0f37d321c07ea1c5472fdba">_ext2_get_group_len</a> (<a class="el" href="structsuperblock__t.html">superblock_t</a> *sb)</td></tr>
<tr class="separator:a853d9483f0f37d321c07ea1c5472fdba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2417437958963f3126f55d048baaae81"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a2417437958963f3126f55d048baaae81">_ext2_get_groups_cnt</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structsuperblock__t.html">superblock_t</a> *sb)</td></tr>
<tr class="separator:a2417437958963f3126f55d048baaae81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded8027a81d47374997ce986b9d058b2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a> (<a class="el" href="structsuperblock__t.html">superblock_t</a> *sb, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index)</td></tr>
<tr class="separator:aded8027a81d47374997ce986b9d058b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3edde2501af21c6114152b32c3f44476"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a3edde2501af21c6114152b32c3f44476">_ext2_get_block_of_inode_lev0</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_block, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index)</td></tr>
<tr class="separator:a3edde2501af21c6114152b32c3f44476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b64a3a170b46c0b948f551539380bd5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a3b64a3a170b46c0b948f551539380bd5">_ext2_get_block_of_inode_lev1</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_block, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index)</td></tr>
<tr class="separator:a3b64a3a170b46c0b948f551539380bd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0afd935d31326a3d5d2d2a1d6d714840"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a0afd935d31326a3d5d2d2a1d6d714840">_ext2_get_block_of_inode_lev2</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_block, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index)</td></tr>
<tr class="separator:a0afd935d31326a3d5d2d2a1d6d714840"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa13178156da204b197f2dcc8e31491dd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index)</td></tr>
<tr class="separator:aa13178156da204b197f2dcc8e31491dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98cd58dcdb9175465e2785257b8f8833"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a98cd58dcdb9175465e2785257b8f8833">_ext2_set_block_of_inode_lev0</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_block, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> val)</td></tr>
<tr class="separator:a98cd58dcdb9175465e2785257b8f8833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad196092519f06b1895f4b4afd5ac9c27"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ad196092519f06b1895f4b4afd5ac9c27">_ext2_set_block_of_inode_lev1</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_block, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> val)</td></tr>
<tr class="separator:ad196092519f06b1895f4b4afd5ac9c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a165f50cee12361f7ec4def12eef3b48f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a165f50cee12361f7ec4def12eef3b48f">_ext2_set_block_of_inode_lev2</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_block, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> val)</td></tr>
<tr class="separator:a165f50cee12361f7ec4def12eef3b48f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e740573402cc417e6ff0d2be99806f0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a9e740573402cc417e6ff0d2be99806f0">_ext2_set_block_of_inode</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_block_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> val)</td></tr>
<tr class="separator:a9e740573402cc417e6ff0d2be99806f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84723f344c7649d96276ed822a1ae7bc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a84723f344c7649d96276ed822a1ae7bc">_ext2_find_free_block_index</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *block_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> group_index)</td></tr>
<tr class="separator:a84723f344c7649d96276ed822a1ae7bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62f46ee35f641aeaad8340d7a795f433"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a62f46ee35f641aeaad8340d7a795f433">_ext2_allocate_block_index</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *block_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> pref_group)</td></tr>
<tr class="separator:a62f46ee35f641aeaad8340d7a795f433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60e86ceec6ee897d1b22846bddca0735"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a60e86ceec6ee897d1b22846bddca0735">_ext2_free_block_index</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index)</td></tr>
<tr class="separator:a60e86ceec6ee897d1b22846bddca0735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7507c4468e3c71eb4494db81af7eaf8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ae7507c4468e3c71eb4494db81af7eaf8">_ext2_allocate_block_for_inode</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> pref_group, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *block_index)</td></tr>
<tr class="separator:ae7507c4468e3c71eb4494db81af7eaf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a703c7959974a4f4009258351a3d43f9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a703c7959974a4f4009258351a3d43f9a">ext2_read_inode</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>)</td></tr>
<tr class="separator:a703c7959974a4f4009258351a3d43f9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fa3b1f3bc96fad36b7cbb92a8521f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a63fa3b1f3bc96fad36b7cbb92a8521f3">ext2_write_inode</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>)</td></tr>
<tr class="separator:a63fa3b1f3bc96fad36b7cbb92a8521f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c32c3efd30eb011e40b944d06f623fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a7c32c3efd30eb011e40b944d06f623fa">ext2_free_inode</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>)</td></tr>
<tr class="separator:a7c32c3efd30eb011e40b944d06f623fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a934c5a0b083bf7d498debb2a4d4f2f70"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a934c5a0b083bf7d498debb2a4d4f2f70">_ext2_find_free_inode_index</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *inode_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> group_index)</td></tr>
<tr class="separator:a934c5a0b083bf7d498debb2a4d4f2f70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000b110135cd9e8c7bf6bd51ab3cd88d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a000b110135cd9e8c7bf6bd51ab3cd88d">_ext2_allocate_inode_index</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *inode_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> pref_group)</td></tr>
<tr class="separator:a000b110135cd9e8c7bf6bd51ab3cd88d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a92f28e05901682f9a46e7a111dc972"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a9a92f28e05901682f9a46e7a111dc972">_ext2_free_inode_index</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_index)</td></tr>
<tr class="separator:a9a92f28e05901682f9a46e7a111dc972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f9897eb3b2cdc7b15dab71405d597de"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a5f9897eb3b2cdc7b15dab71405d597de">_ext2_decriment_links_count</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>)</td></tr>
<tr class="separator:a5f9897eb3b2cdc7b15dab71405d597de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64961e1b5f9327d4953795643913541d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a64961e1b5f9327d4953795643913541d">_ext2_lookup_block</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index, const char *name, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *found_inode_index)</td></tr>
<tr class="separator:a64961e1b5f9327d4953795643913541d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad272a83ae1e6d86a1ec0964a65f5a59b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ad272a83ae1e6d86a1ec0964a65f5a59b">_ext2_getdirent_block</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *offset, <a class="el" href="vfs_8h.html#a6673e8f64ca9ebd7e26e6289dca06e87">dirent_t</a> *<a class="el" href="structdirent.html">dirent</a>)</td></tr>
<tr class="separator:ad272a83ae1e6d86a1ec0964a65f5a59b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cbc2689640a4954d36f2eb35f9ba575"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a2cbc2689640a4954d36f2eb35f9ba575">_ext2_get_dir_entries_count_in_block</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index)</td></tr>
<tr class="separator:a2cbc2689640a4954d36f2eb35f9ba575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8271c1d7d78c99f592b0c345552b4fae"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a8271c1d7d78c99f592b0c345552b4fae">_ext2_is_dir_empty</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir)</td></tr>
<tr class="separator:a8271c1d7d78c99f592b0c345552b4fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f6d0969922f57594263ce904050f74"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a26f6d0969922f57594263ce904050f74">_ext2_add_first_entry_to_dir_block</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index, <a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *child_dentry, const char *filename, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:a26f6d0969922f57594263ce904050f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5125878ccdb42bdce73026d2cf414a2e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a5125878ccdb42bdce73026d2cf414a2e">_ext2_add_to_dir_block</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index, <a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *child_dentry, const char *filename, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:a5125878ccdb42bdce73026d2cf414a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b24ed98eca9f2162ff5072b59f4ff6c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a0b24ed98eca9f2162ff5072b59f4ff6c">_ext2_rm_from_dir_block</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index, <a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *child_dentry)</td></tr>
<tr class="separator:a0b24ed98eca9f2162ff5072b59f4ff6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0faa31a843f1591fbb073e00a9653e2c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a0faa31a843f1591fbb073e00a9653e2c">_ext2_add_child</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir, <a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *child_dentry, const char *name, int len)</td></tr>
<tr class="separator:a0faa31a843f1591fbb073e00a9653e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0311646294c6138b27500d83485e5c68"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a0311646294c6138b27500d83485e5c68">_ext2_rm_child</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir, <a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *child_dentry)</td></tr>
<tr class="separator:a0311646294c6138b27500d83485e5c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af460c141d44aae82274d4059e7498b33"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#af460c141d44aae82274d4059e7498b33">_ext2_setup_dir</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir, <a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *parent_dir, <a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a> <a class="el" href="mode_8h.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>)</td></tr>
<tr class="separator:af460c141d44aae82274d4059e7498b33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cbb4be04e6f984153ad2aac024bd836"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a6cbb4be04e6f984153ad2aac024bd836">_ext2_setup_file</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *file, <a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a> <a class="el" href="mode_8h.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>)</td></tr>
<tr class="separator:a6cbb4be04e6f984153ad2aac024bd836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419165b0f0b008a55f349facad9ad035"><td class="memItemLeft" align="right" valign="top"><a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a419165b0f0b008a55f349facad9ad035">ext2_recognize_drive</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev)</td></tr>
<tr class="separator:a419165b0f0b008a55f349facad9ad035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc8e781247eb1304494ba6c63ea7673c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#acc8e781247eb1304494ba6c63ea7673c">ext2_prepare_fs</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev)</td></tr>
<tr class="separator:acc8e781247eb1304494ba6c63ea7673c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59d123a7cc9fbd1eaff190cc133c0d8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a59d123a7cc9fbd1eaff190cc133c0d8d">ext2_save_state</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev)</td></tr>
<tr class="separator:a59d123a7cc9fbd1eaff190cc133c0d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb5d5dd270e04331d926dc5ca9fda85f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#abb5d5dd270e04331d926dc5ca9fda85f">get_fsdata</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>)</td></tr>
<tr class="separator:abb5d5dd270e04331d926dc5ca9fda85f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64fe803fc3ab33869ac2582343983b0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a64fe803fc3ab33869ac2582343983b0d">ext2_read</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="utester_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:a64fe803fc3ab33869ac2582343983b0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf8033fa3989cd6d8b9837e3dc597d90"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#acf8033fa3989cd6d8b9837e3dc597d90">ext2_write</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="utester_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:acf8033fa3989cd6d8b9837e3dc597d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a113c69847913746fb70fc1ecd5a1b21a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a113c69847913746fb70fc1ecd5a1b21a">ext2_truncate</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:a113c69847913746fb70fc1ecd5a1b21a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab29c0a24de369a706d69663581a2ea12"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ab29c0a24de369a706d69663581a2ea12">ext2_lookup</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir, const char *name, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *res_inode_indx)</td></tr>
<tr class="separator:ab29c0a24de369a706d69663581a2ea12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34240efebfff63f0423f654653322438"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a34240efebfff63f0423f654653322438">ext2_mkdir</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir, const char *name, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len, <a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a> <a class="el" href="mode_8h.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>)</td></tr>
<tr class="separator:a34240efebfff63f0423f654653322438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54fdc6187e3300f1bfe12f6d82e3f559"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a54fdc6187e3300f1bfe12f6d82e3f559">ext2_getdirent</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *offset, <a class="el" href="vfs_8h.html#a6673e8f64ca9ebd7e26e6289dca06e87">dirent_t</a> *res)</td></tr>
<tr class="separator:a54fdc6187e3300f1bfe12f6d82e3f559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa24305353f6388284ec90083dd756cce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#aa24305353f6388284ec90083dd756cce">ext2_create</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir, const char *name, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len, <a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a> <a class="el" href="mode_8h.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>)</td></tr>
<tr class="separator:aa24305353f6388284ec90083dd756cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc615c816967a8ac853a662bdeb1c31"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a3cc615c816967a8ac853a662bdeb1c31">ext2_rm</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>)</td></tr>
<tr class="separator:a3cc615c816967a8ac853a662bdeb1c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9c672e0f12ef73f108d8a5fb70777cc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ac9c672e0f12ef73f108d8a5fb70777cc">_ext2_getdents_block</a> (<a class="el" href="structvfs__device__t.html">vfs_device_t</a> *dev, <a class="el" href="structfsdata__t.html">fsdata_t</a> fsdata, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index, <a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="utester_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inner_offset, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *scanned_bytes)</td></tr>
<tr class="separator:ac9c672e0f12ef73f108d8a5fb70777cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9641eb2a873250a030dfd41443d468"><td class="memItemLeft" align="right" valign="top"><a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a2f9641eb2a873250a030dfd41443d468">ext2_can_read</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start)</td></tr>
<tr class="separator:a2f9641eb2a873250a030dfd41443d468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a279e146e9f96ba49c1d85c0f589f3012"><td class="memItemLeft" align="right" valign="top"><a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a279e146e9f96ba49c1d85c0f589f3012">ext2_can_write</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start)</td></tr>
<tr class="separator:a279e146e9f96ba49c1d85c0f589f3012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f0545307215e9e8ea5f72c5c2ec73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#ae66f0545307215e9e8ea5f72c5c2ec73">ext2_rmdir</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *dir)</td></tr>
<tr class="separator:ae66f0545307215e9e8ea5f72c5c2ec73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af469c45b66b3d1f8d9e05927d99e0f09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#af469c45b66b3d1f8d9e05927d99e0f09">ext2_getdents</a> (<a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *<a class="el" href="structdentry.html">dentry</a>, <a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="utester_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *offset, <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> len)</td></tr>
<tr class="separator:af469c45b66b3d1f8d9e05927d99e0f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a0c0c0c270fd71c7de3952d8423b06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a38a0c0c0c270fd71c7de3952d8423b06">ext2_install</a> ()</td></tr>
<tr class="separator:a38a0c0c0c270fd71c7de3952d8423b06"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6c340d3dfe4969f99eb5ed2baf3619de"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structsuperblock__t.html">superblock_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a> [<a class="el" href="driver__manager_8h.html#a0cea68640d32312d57811eef08df8369">MAX_DEVICES_COUNT</a>]</td></tr>
<tr class="separator:a6c340d3dfe4969f99eb5ed2baf3619de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8846e2ec0e42b40c79882f9de64c542c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structgroups__info__t.html">groups_info_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a> [<a class="el" href="driver__manager_8h.html#a0cea68640d32312d57811eef08df8369">MAX_DEVICES_COUNT</a>]</td></tr>
<tr class="separator:a8846e2ec0e42b40c79882f9de64c542c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af11d5ade1069f3f4d7a086be6679b044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af11d5ade1069f3f4d7a086be6679b044">&#9670;&nbsp;</a></span>BLOCK_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLOCK_LEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">sb</td><td>)</td>
          <td>&#160;&#160;&#160;(1024 &lt;&lt; (sb-&gt;log_block_size))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00021">21</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

</div>
</div>
<a id="afc69b6e5d0cec1c42f5c7365ab30ef32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc69b6e5d0cec1c42f5c7365ab30ef32">&#9670;&nbsp;</a></span>GROUP_TABLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GROUP_TABLES&#160;&#160;&#160;<a class="el" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a>[dev-&gt;dev-&gt;id].table</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00020">20</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

</div>
</div>
<a id="adce1205ff8b13b823ae9ff542dcb5b00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adce1205ff8b13b823ae9ff542dcb5b00">&#9670;&nbsp;</a></span>MAX_BLOCK_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_BLOCK_LEN&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00016">16</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

</div>
</div>
<a id="ad2f3678bf5eae3684fc497130b946eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2f3678bf5eae3684fc497130b946eae">&#9670;&nbsp;</a></span>MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">X, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">Y&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((X) &lt; (Y)) ? (X) : (Y))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00018">18</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

</div>
</div>
<a id="ac0df43d2359093fd8019da90f7cadb93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0df43d2359093fd8019da90f7cadb93">&#9670;&nbsp;</a></span>NORM_FILENAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NORM_FILENAME</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(x + ((4 - (x &amp; 0b11)) &amp; 0b11))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00023">23</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

</div>
</div>
<a id="abc4cb8adac167448da16a169f41dbbc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc4cb8adac167448da16a169f41dbbc4">&#9670;&nbsp;</a></span>SUPERBLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SUPERBLOCK&#160;&#160;&#160;<a class="el" href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a>[dev-&gt;dev-&gt;id]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00019">19</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

</div>
</div>
<a id="a9dc3a65e10750e9b6a798a7b54918186"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dc3a65e10750e9b6a798a7b54918186">&#9670;&nbsp;</a></span>TO_EXT_BLOCKS_CNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TO_EXT_BLOCKS_CNT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">sb, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(x / (2 &lt;&lt; (sb-&gt;log_block_size)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00022">22</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0faa31a843f1591fbb073e00a9653e2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0faa31a843f1591fbb073e00a9653e2c">&#9670;&nbsp;</a></span>_ext2_add_child()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_add_child </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>child_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00719">719</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;{</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blocks_per_dir = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; blocks_per_dir; i++) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">if</span> (block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(dir, i)) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a5125878ccdb42bdce73026d2cf414a2e">_ext2_add_to_dir_block</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, block_index, child_dentry, <a class="code" href="namespacecopy__bin.html#ac19e0622db9715c974b893fdb8327374">name</a>, len) == 0) {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="keywordflow">goto</span> updated_inode;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// FIXME: group</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> new_block_index;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#ae7507c4468e3c71eb4494db81af7eaf8">_ext2_allocate_block_for_inode</a>(dir, 0, &amp;new_block_index) == 0) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a26f6d0969922f57594263ce904050f74">_ext2_add_first_entry_to_dir_block</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, new_block_index, child_dentry, <a class="code" href="namespacecopy__bin.html#ac19e0622db9715c974b893fdb8327374">name</a>, len) == 0) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">goto</span> updated_inode;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;updated_inode:</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    child_dentry-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a>++;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(child_dentry, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a26f6d0969922f57594263ce904050f74"><div class="ttname"><a href="ext2_8c.html#a26f6d0969922f57594263ce904050f74">_ext2_add_first_entry_to_dir_block</a></div><div class="ttdeci">static int _ext2_add_first_entry_to_dir_block(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index, dentry_t *child_dentry, const char *filename, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00613">ext2.c:613</a></div></div>
<div class="ttc" id="aext2_8c_html_a5125878ccdb42bdce73026d2cf414a2e"><div class="ttname"><a href="ext2_8c.html#a5125878ccdb42bdce73026d2cf414a2e">_ext2_add_to_dir_block</a></div><div class="ttdeci">static int _ext2_add_to_dir_block(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index, dentry_t *child_dentry, const char *filename, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00636">ext2.c:636</a></div></div>
<div class="ttc" id="aext2_8c_html_a9dc3a65e10750e9b6a798a7b54918186"><div class="ttname"><a href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a></div><div class="ttdeci">#define TO_EXT_BLOCKS_CNT(sb, x)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00022">ext2.c:22</a></div></div>
<div class="ttc" id="aext2_8c_html_aa13178156da204b197f2dcc8e31491dd"><div class="ttname"><a href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a></div><div class="ttdeci">static uint32_t _ext2_get_block_of_inode(dentry_t *dentry, uint32_t inode_block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00233">ext2.c:233</a></div></div>
<div class="ttc" id="aext2_8c_html_ae7507c4468e3c71eb4494db81af7eaf8"><div class="ttname"><a href="ext2_8c.html#ae7507c4468e3c71eb4494db81af7eaf8">_ext2_allocate_block_for_inode</a></div><div class="ttdeci">static int _ext2_allocate_block_for_inode(dentry_t *dentry, uint32_t pref_group, uint32_t *block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00340">ext2.c:340</a></div></div>
<div class="ttc" id="ainclude_2errno_8h_html_a3f317946e043623f9d6b93dbf60e6316"><div class="ttname"><a href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a></div><div class="ttdeci">#define EFAULT</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00017">errno.h:17</a></div></div>
<div class="ttc" id="anamespacecopy__bin_html_ac19e0622db9715c974b893fdb8327374"><div class="ttname"><a href="namespacecopy__bin.html#ac19e0622db9715c974b893fdb8327374">copy_bin.name</a></div><div class="ttdeci">string name</div><div class="ttdef"><b>Definition:</b> <a href="copy__bin_8py_source.html#l00071">copy_bin.py:71</a></div></div>
<div class="ttc" id="astructdentry_html_aa570c7b3f7c32ef505901f3a3e2931b5"><div class="ttname"><a href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">dentry::inode</a></div><div class="ttdeci">inode_t * inode</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00058">vfs.h:58</a></div></div>
<div class="ttc" id="astructdentry_html_aa7900a1e668ca69caf3c1e309947e494"><div class="ttname"><a href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dentry::dev</a></div><div class="ttdeci">vfs_device_t * dev</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00062">vfs.h:62</a></div></div>
<div class="ttc" id="astructdentry_html_ae7cb95c90d2b85eb198bf619bb55c4cc"><div class="ttname"><a href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">dentry::fsdata</a></div><div class="ttdeci">fsdata_t fsdata</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00059">vfs.h:59</a></div></div>
<div class="ttc" id="astructfsdata__t_html_a6cfecc1892722121091218778efc1a32"><div class="ttname"><a href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">fsdata_t::sb</a></div><div class="ttdeci">superblock_t * sb</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00030">vfs.h:30</a></div></div>
<div class="ttc" id="astructinode__t_html_aca3a2f4920013eac77abb86c0eeaab1d"><div class="ttname"><a href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">inode_t::links_count</a></div><div class="ttdeci">uint16_t links_count</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00100">ext2.h:100</a></div></div>
<div class="ttc" id="astructinode__t_html_aeba6143a372083aa4952c8c79fc4ffaa"><div class="ttname"><a href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">inode_t::blocks</a></div><div class="ttdeci">uint32_t blocks</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00101">ext2.h:101</a></div></div>
<div class="ttc" id="asyscall__structs_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="syscall__structs_8h_source.html#l00008">syscall_structs.h:8</a></div></div>
<div class="ttc" id="avfs_8h_html_a6732bca494a9950526100a3f2605cbcc"><div class="ttname"><a href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a></div><div class="ttdeci">#define DENTRY_DIRTY</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00048">vfs.h:48</a></div></div>
<div class="ttc" id="avfs_8h_html_a7caf5229634e02f763b50829867068dc"><div class="ttname"><a href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a></div><div class="ttdeci">void dentry_set_flag(dentry_t *dentry, uint32_t flag)</div><div class="ttdef"><b>Definition:</b> <a href="dentry_8c_source.html#l00325">dentry.c:325</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00613">_ext2_add_first_entry_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00636">_ext2_add_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00340">_ext2_allocate_block_for_inode()</a>, <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8h_source.html#l00100">inode_t::links_count</a>, <a class="el" href="copy__bin_8py_source.html#l00071">copy_bin::name</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00766">_ext2_setup_dir()</a>, <a class="el" href="ext2_8c_source.html#l00993">ext2_create()</a>, and <a class="el" href="ext2_8c_source.html#l00907">ext2_mkdir()</a>.</p>

</div>
</div>
<a id="a26f6d0969922f57594263ce904050f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f6d0969922f57594263ce904050f74">&#9670;&nbsp;</a></span>_ext2_add_first_entry_to_dir_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_add_first_entry_to_dir_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>child_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00613">613</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> (block_index == 0) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> record_name_len = <a class="code" href="ext2_8c.html#ac0df43d2359093fd8019da90f7cadb93">NORM_FILENAME</a>(len);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> min_rec_len = 8 + record_name_len;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a> new_entry;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[<a class="code" href="ext2_8h.html#a1f9f095972bc01102b7c8be7dd9f6712">DIR_ENTRY_LEN</a>];</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), <a class="code" href="ext2_8h.html#a1f9f095972bc01102b7c8be7dd9f6712">DIR_ENTRY_LEN</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)tmp_buf;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    new_entry.<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> = child_dentry-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    new_entry.<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a> = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    new_entry.<a class="code" href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">name_len</a> = len;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>((<span class="keywordtype">void</span>*)start_of_entry, (<span class="keywordtype">void</span>*)&amp;new_entry, 8);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>((<span class="keywordtype">void</span>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry + 8), (<span class="keywordtype">void</span>*)<a class="code" href="namespacefat16__formatter.html#a1b04d2b14676d110b0817f8bf2f071ef">filename</a>, len);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a>((<span class="keywordtype">void</span>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry + 8 + len), 0, record_name_len - len);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), <a class="code" href="ext2_8h.html#a1f9f095972bc01102b7c8be7dd9f6712">DIR_ENTRY_LEN</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a2c62a613f06d8c74885169dfb8cfc3fd"><div class="ttname"><a href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a></div><div class="ttdeci">static void _ext2_read_from_dev(vfs_device_t *dev, uint8_t *buf, uint32_t start, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00108">ext2.c:108</a></div></div>
<div class="ttc" id="aext2_8c_html_ac0df43d2359093fd8019da90f7cadb93"><div class="ttname"><a href="ext2_8c.html#ac0df43d2359093fd8019da90f7cadb93">NORM_FILENAME</a></div><div class="ttdeci">#define NORM_FILENAME(x)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00023">ext2.c:23</a></div></div>
<div class="ttc" id="aext2_8c_html_ac3ba5958992cad0916f5c5cde7da082b"><div class="ttname"><a href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a></div><div class="ttdeci">static void _ext2_write_to_dev(vfs_device_t *dev, uint8_t *buf, uint32_t start, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00127">ext2.c:127</a></div></div>
<div class="ttc" id="aext2_8c_html_aded8027a81d47374997ce986b9d058b2"><div class="ttname"><a href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a></div><div class="ttdeci">static uint32_t _ext2_get_block_offset(superblock_t *sb, uint32_t block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00198">ext2.c:198</a></div></div>
<div class="ttc" id="aext2_8c_html_af11d5ade1069f3f4d7a086be6679b044"><div class="ttname"><a href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a></div><div class="ttdeci">#define BLOCK_LEN(sb)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00021">ext2.c:21</a></div></div>
<div class="ttc" id="aext2_8h_html_a1f9f095972bc01102b7c8be7dd9f6712"><div class="ttname"><a href="ext2_8h.html#a1f9f095972bc01102b7c8be7dd9f6712">DIR_ENTRY_LEN</a></div><div class="ttdeci">#define DIR_ENTRY_LEN</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00112">ext2.h:112</a></div></div>
<div class="ttc" id="ainclude_2errno_8h_html_a2d1678d5a7cc8ce499643f3b8957def4"><div class="ttname"><a href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a></div><div class="ttdeci">#define EINVAL</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00025">errno.h:25</a></div></div>
<div class="ttc" id="amem_8h_html_a6008112cc5f333e4e7d75b66bf81c89c"><div class="ttname"><a href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a></div><div class="ttdeci">void memset(uint8_t *dest, uint8_t fll, uint32_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="string_8c_source.html#l00003">string.c:3</a></div></div>
<div class="ttc" id="amem_8h_html_ad2da9e2d51c0279601e740bb36ef6156"><div class="ttname"><a href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a></div><div class="ttdeci">void memcpy(uint8_t *dest, const uint8_t *src, uint32_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="string_8c_source.html#l00023">string.c:23</a></div></div>
<div class="ttc" id="anamespacefat16__formatter_html_a1b04d2b14676d110b0817f8bf2f071ef"><div class="ttname"><a href="namespacefat16__formatter.html#a1b04d2b14676d110b0817f8bf2f071ef">fat16_formatter.filename</a></div><div class="ttdeci">filename</div><div class="ttdef"><b>Definition:</b> <a href="fat16__formatter_8py_source.html#l00007">fat16_formatter.py:7</a></div></div>
<div class="ttc" id="astructdentry_html_a7315cd079d1109369c66fe804b9fd4ba"><div class="ttname"><a href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">dentry::inode_indx</a></div><div class="ttdeci">uint32_t inode_indx</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00057">vfs.h:57</a></div></div>
<div class="ttc" id="astructdir__entry__t_html"><div class="ttname"><a href="structdir__entry__t.html">dir_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00113">ext2.h:113</a></div></div>
<div class="ttc" id="astructdir__entry__t_html_a1fce9e34b6bc2f2eccf92a80d48dd97e"><div class="ttname"><a href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">dir_entry_t::inode</a></div><div class="ttdeci">uint32_t inode</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00114">ext2.h:114</a></div></div>
<div class="ttc" id="astructdir__entry__t_html_a4723d0503b408ee6b392f65aa897f520"><div class="ttname"><a href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">dir_entry_t::name_len</a></div><div class="ttdeci">uint8_t name_len</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00116">ext2.h:116</a></div></div>
<div class="ttc" id="astructdir__entry__t_html_a49408bf51b5fd67a67008f8bdca8a049"><div class="ttname"><a href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">dir_entry_t::rec_len</a></div><div class="ttdeci">uint16_t rec_len</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00115">ext2.h:115</a></div></div>
<div class="ttc" id="asyscall__structs_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="syscall__structs_8h_source.html#l00010">syscall_structs.h:10</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00112">DIR_ENTRY_LEN</a>, <a class="el" href="include_2errno_8h_source.html#l00025">EINVAL</a>, <a class="el" href="fat16__formatter_8py_source.html#l00007">fat16_formatter::filename</a>, <a class="el" href="ext2_8h_source.html#l00114">dir_entry_t::inode</a>, <a class="el" href="vfs_8h_source.html#l00057">dentry::inode_indx</a>, <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="string_8c_source.html#l00003">memset()</a>, <a class="el" href="ext2_8h_source.html#l00116">dir_entry_t::name_len</a>, <a class="el" href="ext2_8c_source.html#l00023">NORM_FILENAME</a>, <a class="el" href="ext2_8h_source.html#l00115">dir_entry_t::rec_len</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00719">_ext2_add_child()</a>.</p>

</div>
</div>
<a id="a5125878ccdb42bdce73026d2cf414a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5125878ccdb42bdce73026d2cf414a2e">&#9670;&nbsp;</a></span>_ext2_add_to_dir_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_add_to_dir_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>child_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00636">636</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;{</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">if</span> (block_index == 0) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> record_name_len = <a class="code" href="ext2_8c.html#ac0df43d2359093fd8019da90f7cadb93">NORM_FILENAME</a>(len);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> min_rec_len = 8 + record_name_len;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a> new_entry;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)tmp_buf;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_new_entry;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> == 0) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;Ext2: can&#39;t add as first entry with help of that function.&quot;</span>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_filename_len = <a class="code" href="ext2_8c.html#ac0df43d2359093fd8019da90f7cadb93">NORM_FILENAME</a>(start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">name_len</a>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> cur_rec_len = 8 + cur_filename_len;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">// We have enough place to put both records</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a> &gt;= cur_rec_len + min_rec_len) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            new_entry.<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> = child_dentry-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            new_entry.<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a> = start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a> - cur_rec_len;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            new_entry.<a class="code" href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">name_len</a> = len;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            start_of_new_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry + cur_rec_len);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a> = cur_rec_len;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordflow">goto</span> update_res;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry + start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry &gt;= (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_buf + <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>)) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;update_res:</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>((<span class="keywordtype">void</span>*)start_of_new_entry, (<span class="keywordtype">void</span>*)&amp;new_entry, 8);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>((<span class="keywordtype">void</span>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_new_entry + 8), (<span class="keywordtype">void</span>*)<a class="code" href="namespacefat16__formatter.html#a1b04d2b14676d110b0817f8bf2f071ef">filename</a>, len);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="mem_8h.html#a6008112cc5f333e4e7d75b66bf81c89c">memset</a>((<span class="keywordtype">void</span>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_new_entry + 8 + len), 0, record_name_len - len);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_adce1205ff8b13b823ae9ff542dcb5b00"><div class="ttname"><a href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a></div><div class="ttdeci">#define MAX_BLOCK_LEN</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00016">ext2.c:16</a></div></div>
<div class="ttc" id="akassert_8h_html_a43cb62099c428c65d943851885a07d6a"><div class="ttname"><a href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a></div><div class="ttdeci">void kpanic(char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="kassert_8c_source.html#l00011">kassert.c:11</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00025">EINVAL</a>, <a class="el" href="fat16__formatter_8py_source.html#l00007">fat16_formatter::filename</a>, <a class="el" href="ext2_8h_source.html#l00114">dir_entry_t::inode</a>, <a class="el" href="vfs_8h_source.html#l00057">dentry::inode_indx</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="string_8c_source.html#l00003">memset()</a>, <a class="el" href="ext2_8h_source.html#l00116">dir_entry_t::name_len</a>, <a class="el" href="ext2_8c_source.html#l00023">NORM_FILENAME</a>, <a class="el" href="ext2_8h_source.html#l00115">dir_entry_t::rec_len</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00719">_ext2_add_child()</a>.</p>

</div>
</div>
<a id="ae7507c4468e3c71eb4494db81af7eaf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7507c4468e3c71eb4494db81af7eaf8">&#9670;&nbsp;</a></span>_ext2_allocate_block_for_inode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_allocate_block_for_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pref_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns allocated block in @block_index </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00340">340</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a62f46ee35f641aeaad8340d7a795f433">_ext2_allocate_block_index</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, block_index, pref_group) == 0) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blocks_per_inode = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a9e740573402cc417e6ff0d2be99806f0">_ext2_set_block_of_inode</a>(<a class="code" href="structdentry.html">dentry</a>, blocks_per_inode, *block_index) == 0) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a> += <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>) / 512;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a62f46ee35f641aeaad8340d7a795f433"><div class="ttname"><a href="ext2_8c.html#a62f46ee35f641aeaad8340d7a795f433">_ext2_allocate_block_index</a></div><div class="ttdeci">static int _ext2_allocate_block_index(vfs_device_t *dev, fsdata_t fsdata, uint32_t *block_index, uint32_t pref_group)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00308">ext2.c:308</a></div></div>
<div class="ttc" id="aext2_8c_html_a9e740573402cc417e6ff0d2be99806f0"><div class="ttname"><a href="ext2_8c.html#a9e740573402cc417e6ff0d2be99806f0">_ext2_set_block_of_inode</a></div><div class="ttdeci">static int _ext2_set_block_of_inode(dentry_t *dentry, uint32_t inode_block_index, uint32_t val)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00276">ext2.c:276</a></div></div>
<div class="ttc" id="ainclude_2errno_8h_html_a088abe8bad2df798edad3053d719b937"><div class="ttname"><a href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a></div><div class="ttdeci">#define ENOSPC</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00031">errno.h:31</a></div></div>
<div class="ttc" id="astructdentry_html"><div class="ttname"><a href="structdentry.html">dentry</a></div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00054">vfs.h:54</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00308">_ext2_allocate_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00276">_ext2_set_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="include_2errno_8h_source.html#l00031">ENOSPC</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00719">_ext2_add_child()</a>, and <a class="el" href="ext2_8c_source.html#l00838">ext2_write()</a>.</p>

</div>
</div>
<a id="a62f46ee35f641aeaad8340d7a795f433"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62f46ee35f641aeaad8340d7a795f433">&#9670;&nbsp;</a></span>_ext2_allocate_block_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_allocate_block_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pref_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00308">308</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// TODO: change group count to real value</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> groups_cnt = 3;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; groups_cnt; i++) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#afc69b6e5d0cec1c42f5c7365ab30ef32">GROUP_TABLES</a>[(pref_group + i) % groups_cnt].free_inodes_count) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a84723f344c7649d96276ed822a1ae7bc">_ext2_find_free_block_index</a>(dev, fsdata, block_index, pref_group) == 0) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a84723f344c7649d96276ed822a1ae7bc"><div class="ttname"><a href="ext2_8c.html#a84723f344c7649d96276ed822a1ae7bc">_ext2_find_free_block_index</a></div><div class="ttdeci">static int _ext2_find_free_block_index(vfs_device_t *dev, fsdata_t fsdata, uint32_t *block_index, uint32_t group_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00292">ext2.c:292</a></div></div>
<div class="ttc" id="aext2_8c_html_afc69b6e5d0cec1c42f5c7365ab30ef32"><div class="ttname"><a href="ext2_8c.html#afc69b6e5d0cec1c42f5c7365ab30ef32">GROUP_TABLES</a></div><div class="ttdeci">#define GROUP_TABLES</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00020">ext2.c:20</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00292">_ext2_find_free_block_index()</a>, <a class="el" href="include_2errno_8h_source.html#l00031">ENOSPC</a>, and <a class="el" href="ext2_8c_source.html#l00020">GROUP_TABLES</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00340">_ext2_allocate_block_for_inode()</a>.</p>

</div>
</div>
<a id="a000b110135cd9e8c7bf6bd51ab3cd88d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000b110135cd9e8c7bf6bd51ab3cd88d">&#9670;&nbsp;</a></span>_ext2_allocate_inode_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_allocate_inode_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>inode_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pref_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00393">393</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;{</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">/* TODO: change group count to real value */</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> groups_cnt = 3;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; groups_cnt; i++) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">if</span> (fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[(pref_group + i) % groups_cnt].<a class="code" href="structgroup__desc__t.html#acd452f4934256a08d1f97db405f8a24d">free_inodes_count</a>) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a934c5a0b083bf7d498debb2a4d4f2f70">_ext2_find_free_inode_index</a>(dev, fsdata, inode_index, pref_group) == 0) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a934c5a0b083bf7d498debb2a4d4f2f70"><div class="ttname"><a href="ext2_8c.html#a934c5a0b083bf7d498debb2a4d4f2f70">_ext2_find_free_inode_index</a></div><div class="ttdeci">static int _ext2_find_free_inode_index(vfs_device_t *dev, fsdata_t fsdata, uint32_t *inode_index, uint32_t group_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00377">ext2.c:377</a></div></div>
<div class="ttc" id="astructfsdata__t_html_ab1102c361ef44bb00617f00fd4df9b6e"><div class="ttname"><a href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">fsdata_t::gt</a></div><div class="ttdeci">groups_info_t * gt</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00031">vfs.h:31</a></div></div>
<div class="ttc" id="astructgroup__desc__t_html_acd452f4934256a08d1f97db405f8a24d"><div class="ttname"><a href="structgroup__desc__t.html#acd452f4934256a08d1f97db405f8a24d">group_desc_t::free_inodes_count</a></div><div class="ttdeci">uint16_t free_inodes_count</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00059">ext2.h:59</a></div></div>
<div class="ttc" id="astructgroups__info__t_html_a35fd1f98830a3105431102d8d0465d73"><div class="ttname"><a href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">groups_info_t::table</a></div><div class="ttdeci">group_desc_t * table</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00026">vfs.h:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00377">_ext2_find_free_inode_index()</a>, <a class="el" href="include_2errno_8h_source.html#l00031">ENOSPC</a>, <a class="el" href="ext2_8h_source.html#l00059">group_desc_t::free_inodes_count</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00993">ext2_create()</a>, and <a class="el" href="ext2_8c_source.html#l00907">ext2_mkdir()</a>.</p>

</div>
</div>
<a id="af42fc74892d7f538598a9dfcd4501ccd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af42fc74892d7f538598a9dfcd4501ccd">&#9670;&nbsp;</a></span>_ext2_bitmap_get()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _ext2_bitmap_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>bitmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>UTILS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00159">159</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structbitmap.html">bitmap</a>[index / 8] &gt;&gt; (index % 8)) &amp; 1;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="ttc" id="astructbitmap_html"><div class="ttname"><a href="structbitmap.html">bitmap</a></div><div class="ttdef"><b>Definition:</b> <a href="bitmap_8h_source.html#l00014">bitmap.h:15</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00292">_ext2_find_free_block_index()</a>, and <a class="el" href="ext2_8c_source.html#l00377">_ext2_find_free_inode_index()</a>.</p>

</div>
</div>
<a id="a28ea265adf1148a553710998c6809cb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ea265adf1148a553710998c6809cb5">&#9670;&nbsp;</a></span>_ext2_bitmap_set_bit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _ext2_bitmap_set_bit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>bitmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00164">164</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="structbitmap.html">bitmap</a>[index / 8] |= (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>)(1 &lt;&lt; (index % 8));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00292">_ext2_find_free_block_index()</a>, and <a class="el" href="ext2_8c_source.html#l00377">_ext2_find_free_inode_index()</a>.</p>

</div>
</div>
<a id="a7d1851885a1837ea695e388e996ab1bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d1851885a1837ea695e388e996ab1bb">&#9670;&nbsp;</a></span>_ext2_bitmap_unset_bit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _ext2_bitmap_unset_bit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>bitmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00169">169</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="structbitmap.html">bitmap</a>[index / 8] &amp;= ~(1 &lt;&lt; (index % 8));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00322">_ext2_free_block_index()</a>, and <a class="el" href="ext2_8c_source.html#l00407">_ext2_free_inode_index()</a>.</p>

</div>
</div>
<a id="a5f9897eb3b2cdc7b15dab71405d597de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f9897eb3b2cdc7b15dab71405d597de">&#9670;&nbsp;</a></span>_ext2_decriment_links_count()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_decriment_links_count </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00438">438</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">return</span> (--<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a>) == 0;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, and <a class="el" href="ext2_8h_source.html#l00100">inode_t::links_count</a>.</p>

</div>
</div>
<a id="a68189b69db6004f957e788bffd642c02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68189b69db6004f957e788bffd642c02">&#9670;&nbsp;</a></span>_ext2_driver_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdriver__desc__t.html">driver_desc_t</a> _ext2_driver_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>INIT FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l01099">1099</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;{</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <a class="code" href="structdriver__desc__t.html">driver_desc_t</a> fs_desc;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#a379f27ac0212ab4a5598e25fc85c02a6">type</a> = <a class="code" href="driver__manager_8h.html#a43a79bc226ec77e12e968cbeb704ac34a56ef3cccc6523a90f0026dc878b3ec1f">DRIVER_FILE_SYSTEM</a>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae5b79380543325850b0d177fa72935fb">auto_start</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#af4c1826fb70fbbf3841d9368c9b973c6">is_device_driver</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae004afc2a005569b58f1024cb8ae967a">is_device_needed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#a209786dc3070a702482caa26bbc2b3e3">is_driver_needed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ac940dcbf3a2e5d91b6391ce04d178f34ac8a3be27178fe2903f1c3846db7d4bcb">DRIVER_NOTIFICATION</a>] = 0;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa6477d5d94686925802575d9d1129d20d">DRIVER_FILE_SYSTEM_RECOGNIZE</a>] = <a class="code" href="ext2_8c.html#a419165b0f0b008a55f349facad9ad035">ext2_recognize_drive</a>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aae96324b7217e4fd3973b26298f7f855e">DRIVER_FILE_SYSTEM_PREPARE_FS</a>] = <a class="code" href="ext2_8c.html#acc8e781247eb1304494ba6c63ea7673c">ext2_prepare_fs</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa4b8ae9985a5b5d19cf1ac3cc0afea933">DRIVER_FILE_SYSTEM_CAN_READ</a>] = <a class="code" href="ext2_8c.html#a2f9641eb2a873250a030dfd41443d468">ext2_can_read</a>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa247c4492b3c5826c4d489d218d448df7">DRIVER_FILE_SYSTEM_CAN_WRITE</a>] = <a class="code" href="ext2_8c.html#a279e146e9f96ba49c1d85c0f589f3012">ext2_can_write</a>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa7b559b66cb61a57cc9148c8040700610">DRIVER_FILE_SYSTEM_READ</a>] = <a class="code" href="ext2_8c.html#a64fe803fc3ab33869ac2582343983b0d">ext2_read</a>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa005cbfd39582f60f15c6c535e9900cf1">DRIVER_FILE_SYSTEM_WRITE</a>] = <a class="code" href="ext2_8c.html#acf8033fa3989cd6d8b9837e3dc597d90">ext2_write</a>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aabe40f54799620d9e1fa75ba8b0de3c1e">DRIVER_FILE_SYSTEM_OPEN</a>] = 0; <span class="comment">/* No custom open, vfs will use its code */</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa483af1a717aae810eca3349f216754c6">DRIVER_FILE_SYSTEM_TRUNCATE</a>] = <a class="code" href="ext2_8c.html#a113c69847913746fb70fc1ecd5a1b21a">ext2_truncate</a>;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa8fa1d6e8422aa91adb267537f98eac11">DRIVER_FILE_SYSTEM_MKDIR</a>] = <a class="code" href="ext2_8c.html#a34240efebfff63f0423f654653322438">ext2_mkdir</a>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aaaab87765c64d72df73145a2e4c9b53d7">DRIVER_FILE_SYSTEM_RMDIR</a>] = <a class="code" href="ext2_8c.html#ae66f0545307215e9e8ea5f72c5c2ec73">ext2_rmdir</a>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa30447e801233cbcfe853a63fa8ea8b5e">DRIVER_FILE_SYSTEM_EJECT_DEVICE</a>] = <a class="code" href="ext2_8c.html#a59d123a7cc9fbd1eaff190cc133c0d8d">ext2_save_state</a>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa3a13e2255bee3c959ab2e9e833a96211">DRIVER_FILE_SYSTEM_READ_INODE</a>] = <a class="code" href="ext2_8c.html#a703c7959974a4f4009258351a3d43f9a">ext2_read_inode</a>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa00f8410ec478990aa0c5626409ed5b87">DRIVER_FILE_SYSTEM_WRITE_INODE</a>] = <a class="code" href="ext2_8c.html#a63fa3b1f3bc96fad36b7cbb92a8521f3">ext2_write_inode</a>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa4410e5055dbf9472cc35c16b2107416d">DRIVER_FILE_SYSTEM_FREE_INODE</a>] = <a class="code" href="ext2_8c.html#a7c32c3efd30eb011e40b944d06f623fa">ext2_free_inode</a>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa37514fa7d11d2c14843fae6a9cb305cb">DRIVER_FILE_SYSTEM_GET_FSDATA</a>] = <a class="code" href="ext2_8c.html#abb5d5dd270e04331d926dc5ca9fda85f">get_fsdata</a>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa51fe980101c35a318adea76e6ea18a2b">DRIVER_FILE_SYSTEM_LOOKUP</a>] = <a class="code" href="ext2_8c.html#ab29c0a24de369a706d69663581a2ea12">ext2_lookup</a>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa88ee0deffcd8fa5318687b2d656e0b0f">DRIVER_FILE_SYSTEM_GETDENTS</a>] = <a class="code" href="ext2_8c.html#af469c45b66b3d1f8d9e05927d99e0f09">ext2_getdents</a>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aacf2fbf192da1db6c5fb718b8f67a1c1a">DRIVER_FILE_SYSTEM_CREATE</a>] = <a class="code" href="ext2_8c.html#aa24305353f6388284ec90083dd756cce">ext2_create</a>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aaf6804c43443eb74e55035953a7d29375">DRIVER_FILE_SYSTEM_UNLINK</a>] = <a class="code" href="ext2_8c.html#a3cc615c816967a8ac853a662bdeb1c31">ext2_rm</a>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aaf93234454a5bbbf3193d52d2111a0346">DRIVER_FILE_SYSTEM_IOCTL</a>] = 0;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    fs_desc.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa25de9221abe89e477351a89c3d61cccf">DRIVER_FILE_SYSTEM_MMAP</a>] = 0;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">return</span> fs_desc;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;}</div>
<div class="ttc" id="adriver__manager_8h_html_a43a79bc226ec77e12e968cbeb704ac34a56ef3cccc6523a90f0026dc878b3ec1f"><div class="ttname"><a href="driver__manager_8h.html#a43a79bc226ec77e12e968cbeb704ac34a56ef3cccc6523a90f0026dc878b3ec1f">DRIVER_FILE_SYSTEM</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00032">driver_manager.h:32</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa005cbfd39582f60f15c6c535e9900cf1"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa005cbfd39582f60f15c6c535e9900cf1">DRIVER_FILE_SYSTEM_WRITE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00096">driver_manager.h:96</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa00f8410ec478990aa0c5626409ed5b87"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa00f8410ec478990aa0c5626409ed5b87">DRIVER_FILE_SYSTEM_WRITE_INODE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_WRITE_INODE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00102">driver_manager.h:102</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa247c4492b3c5826c4d489d218d448df7"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa247c4492b3c5826c4d489d218d448df7">DRIVER_FILE_SYSTEM_CAN_WRITE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_CAN_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00094">driver_manager.h:94</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa25de9221abe89e477351a89c3d61cccf"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa25de9221abe89e477351a89c3d61cccf">DRIVER_FILE_SYSTEM_MMAP</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_MMAP</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00111">driver_manager.h:111</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa30447e801233cbcfe853a63fa8ea8b5e"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa30447e801233cbcfe853a63fa8ea8b5e">DRIVER_FILE_SYSTEM_EJECT_DEVICE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_EJECT_DEVICE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00090">driver_manager.h:90</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa37514fa7d11d2c14843fae6a9cb305cb"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa37514fa7d11d2c14843fae6a9cb305cb">DRIVER_FILE_SYSTEM_GET_FSDATA</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_GET_FSDATA</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00104">driver_manager.h:104</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa3a13e2255bee3c959ab2e9e833a96211"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa3a13e2255bee3c959ab2e9e833a96211">DRIVER_FILE_SYSTEM_READ_INODE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_READ_INODE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00101">driver_manager.h:101</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa4410e5055dbf9472cc35c16b2107416d"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa4410e5055dbf9472cc35c16b2107416d">DRIVER_FILE_SYSTEM_FREE_INODE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_FREE_INODE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00103">driver_manager.h:103</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa483af1a717aae810eca3349f216754c6"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa483af1a717aae810eca3349f216754c6">DRIVER_FILE_SYSTEM_TRUNCATE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_TRUNCATE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00097">driver_manager.h:97</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa4b8ae9985a5b5d19cf1ac3cc0afea933"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa4b8ae9985a5b5d19cf1ac3cc0afea933">DRIVER_FILE_SYSTEM_CAN_READ</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_CAN_READ</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00093">driver_manager.h:93</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa51fe980101c35a318adea76e6ea18a2b"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa51fe980101c35a318adea76e6ea18a2b">DRIVER_FILE_SYSTEM_LOOKUP</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_LOOKUP</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00105">driver_manager.h:105</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa6477d5d94686925802575d9d1129d20d"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa6477d5d94686925802575d9d1129d20d">DRIVER_FILE_SYSTEM_RECOGNIZE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_RECOGNIZE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00088">driver_manager.h:88</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa7b559b66cb61a57cc9148c8040700610"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa7b559b66cb61a57cc9148c8040700610">DRIVER_FILE_SYSTEM_READ</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_READ</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00095">driver_manager.h:95</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa88ee0deffcd8fa5318687b2d656e0b0f"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa88ee0deffcd8fa5318687b2d656e0b0f">DRIVER_FILE_SYSTEM_GETDENTS</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_GETDENTS</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00106">driver_manager.h:106</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aa8fa1d6e8422aa91adb267537f98eac11"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aa8fa1d6e8422aa91adb267537f98eac11">DRIVER_FILE_SYSTEM_MKDIR</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_MKDIR</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00098">driver_manager.h:98</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aaaab87765c64d72df73145a2e4c9b53d7"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aaaab87765c64d72df73145a2e4c9b53d7">DRIVER_FILE_SYSTEM_RMDIR</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_RMDIR</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00099">driver_manager.h:99</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aabe40f54799620d9e1fa75ba8b0de3c1e"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aabe40f54799620d9e1fa75ba8b0de3c1e">DRIVER_FILE_SYSTEM_OPEN</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00092">driver_manager.h:92</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aacf2fbf192da1db6c5fb718b8f67a1c1a"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aacf2fbf192da1db6c5fb718b8f67a1c1a">DRIVER_FILE_SYSTEM_CREATE</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_CREATE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00107">driver_manager.h:107</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aae96324b7217e4fd3973b26298f7f855e"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aae96324b7217e4fd3973b26298f7f855e">DRIVER_FILE_SYSTEM_PREPARE_FS</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_PREPARE_FS</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00089">driver_manager.h:89</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aaf6804c43443eb74e55035953a7d29375"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aaf6804c43443eb74e55035953a7d29375">DRIVER_FILE_SYSTEM_UNLINK</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_UNLINK</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00108">driver_manager.h:108</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ab79ca1342bb54a2be15e589097ee0d1aaf93234454a5bbbf3193d52d2111a0346"><div class="ttname"><a href="driver__manager_8h.html#ab79ca1342bb54a2be15e589097ee0d1aaf93234454a5bbbf3193d52d2111a0346">DRIVER_FILE_SYSTEM_IOCTL</a></div><div class="ttdeci">@ DRIVER_FILE_SYSTEM_IOCTL</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00110">driver_manager.h:110</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_ac940dcbf3a2e5d91b6391ce04d178f34ac8a3be27178fe2903f1c3846db7d4bcb"><div class="ttname"><a href="driver__manager_8h.html#ac940dcbf3a2e5d91b6391ce04d178f34ac8a3be27178fe2903f1c3846db7d4bcb">DRIVER_NOTIFICATION</a></div><div class="ttdeci">@ DRIVER_NOTIFICATION</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00049">driver_manager.h:49</a></div></div>
<div class="ttc" id="aext2_8c_html_a113c69847913746fb70fc1ecd5a1b21a"><div class="ttname"><a href="ext2_8c.html#a113c69847913746fb70fc1ecd5a1b21a">ext2_truncate</a></div><div class="ttdeci">int ext2_truncate(dentry_t *dentry, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00872">ext2.c:872</a></div></div>
<div class="ttc" id="aext2_8c_html_a279e146e9f96ba49c1d85c0f589f3012"><div class="ttname"><a href="ext2_8c.html#a279e146e9f96ba49c1d85c0f589f3012">ext2_can_write</a></div><div class="ttdeci">bool ext2_can_write(dentry_t *dentry, uint32_t start)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00806">ext2.c:806</a></div></div>
<div class="ttc" id="aext2_8c_html_a2f9641eb2a873250a030dfd41443d468"><div class="ttname"><a href="ext2_8c.html#a2f9641eb2a873250a030dfd41443d468">ext2_can_read</a></div><div class="ttdeci">bool ext2_can_read(dentry_t *dentry, uint32_t start)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00801">ext2.c:801</a></div></div>
<div class="ttc" id="aext2_8c_html_a34240efebfff63f0423f654653322438"><div class="ttname"><a href="ext2_8c.html#a34240efebfff63f0423f654653322438">ext2_mkdir</a></div><div class="ttdeci">int ext2_mkdir(dentry_t *dir, const char *name, uint32_t len, mode_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00907">ext2.c:907</a></div></div>
<div class="ttc" id="aext2_8c_html_a3cc615c816967a8ac853a662bdeb1c31"><div class="ttname"><a href="ext2_8c.html#a3cc615c816967a8ac853a662bdeb1c31">ext2_rm</a></div><div class="ttdeci">int ext2_rm(dentry_t *dentry)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l01015">ext2.c:1015</a></div></div>
<div class="ttc" id="aext2_8c_html_a419165b0f0b008a55f349facad9ad035"><div class="ttname"><a href="ext2_8c.html#a419165b0f0b008a55f349facad9ad035">ext2_recognize_drive</a></div><div class="ttdeci">bool ext2_recognize_drive(vfs_device_t *dev)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l01032">ext2.c:1032</a></div></div>
<div class="ttc" id="aext2_8c_html_a59d123a7cc9fbd1eaff190cc133c0d8d"><div class="ttname"><a href="ext2_8c.html#a59d123a7cc9fbd1eaff190cc133c0d8d">ext2_save_state</a></div><div class="ttdeci">void ext2_save_state(vfs_device_t *dev)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l01069">ext2.c:1069</a></div></div>
<div class="ttc" id="aext2_8c_html_a63fa3b1f3bc96fad36b7cbb92a8521f3"><div class="ttname"><a href="ext2_8c.html#a63fa3b1f3bc96fad36b7cbb92a8521f3">ext2_write_inode</a></div><div class="ttdeci">int ext2_write_inode(dentry_t *dentry)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00367">ext2.c:367</a></div></div>
<div class="ttc" id="aext2_8c_html_a64fe803fc3ab33869ac2582343983b0d"><div class="ttname"><a href="ext2_8c.html#a64fe803fc3ab33869ac2582343983b0d">ext2_read</a></div><div class="ttdeci">int ext2_read(dentry_t *dentry, uint8_t *buf, uint32_t start, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00811">ext2.c:811</a></div></div>
<div class="ttc" id="aext2_8c_html_a703c7959974a4f4009258351a3d43f9a"><div class="ttname"><a href="ext2_8c.html#a703c7959974a4f4009258351a3d43f9a">ext2_read_inode</a></div><div class="ttdeci">int ext2_read_inode(dentry_t *dentry)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00357">ext2.c:357</a></div></div>
<div class="ttc" id="aext2_8c_html_a7c32c3efd30eb011e40b944d06f623fa"><div class="ttname"><a href="ext2_8c.html#a7c32c3efd30eb011e40b944d06f623fa">ext2_free_inode</a></div><div class="ttdeci">int ext2_free_inode(dentry_t *dentry)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00423">ext2.c:423</a></div></div>
<div class="ttc" id="aext2_8c_html_aa24305353f6388284ec90083dd756cce"><div class="ttname"><a href="ext2_8c.html#aa24305353f6388284ec90083dd756cce">ext2_create</a></div><div class="ttdeci">int ext2_create(dentry_t *dir, const char *name, uint32_t len, mode_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00993">ext2.c:993</a></div></div>
<div class="ttc" id="aext2_8c_html_ab29c0a24de369a706d69663581a2ea12"><div class="ttname"><a href="ext2_8c.html#ab29c0a24de369a706d69663581a2ea12">ext2_lookup</a></div><div class="ttdeci">int ext2_lookup(dentry_t *dir, const char *name, uint32_t len, uint32_t *res_inode_indx)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00895">ext2.c:895</a></div></div>
<div class="ttc" id="aext2_8c_html_abb5d5dd270e04331d926dc5ca9fda85f"><div class="ttname"><a href="ext2_8c.html#abb5d5dd270e04331d926dc5ca9fda85f">get_fsdata</a></div><div class="ttdeci">fsdata_t get_fsdata(dentry_t *dentry)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l01087">ext2.c:1087</a></div></div>
<div class="ttc" id="aext2_8c_html_acc8e781247eb1304494ba6c63ea7673c"><div class="ttname"><a href="ext2_8c.html#acc8e781247eb1304494ba6c63ea7673c">ext2_prepare_fs</a></div><div class="ttdeci">int ext2_prepare_fs(vfs_device_t *dev)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l01051">ext2.c:1051</a></div></div>
<div class="ttc" id="aext2_8c_html_acf8033fa3989cd6d8b9837e3dc597d90"><div class="ttname"><a href="ext2_8c.html#acf8033fa3989cd6d8b9837e3dc597d90">ext2_write</a></div><div class="ttdeci">int ext2_write(dentry_t *dentry, uint8_t *buf, uint32_t start, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00838">ext2.c:838</a></div></div>
<div class="ttc" id="aext2_8c_html_ae66f0545307215e9e8ea5f72c5c2ec73"><div class="ttname"><a href="ext2_8c.html#ae66f0545307215e9e8ea5f72c5c2ec73">ext2_rmdir</a></div><div class="ttdeci">int ext2_rmdir(dentry_t *dir)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00929">ext2.c:929</a></div></div>
<div class="ttc" id="aext2_8c_html_af469c45b66b3d1f8d9e05927d99e0f09"><div class="ttname"><a href="ext2_8c.html#af469c45b66b3d1f8d9e05927d99e0f09">ext2_getdents</a></div><div class="ttdeci">int ext2_getdents(dentry_t *dentry, uint8_t *buf, uint32_t *offset, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00967">ext2.c:967</a></div></div>
<div class="ttc" id="astructdriver__desc__t_html"><div class="ttname"><a href="structdriver__desc__t.html">driver_desc_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00114">driver_manager.h:114</a></div></div>
<div class="ttc" id="astructdriver__desc__t_html_a209786dc3070a702482caa26bbc2b3e3"><div class="ttname"><a href="structdriver__desc__t.html#a209786dc3070a702482caa26bbc2b3e3">driver_desc_t::is_driver_needed</a></div><div class="ttdeci">bool is_driver_needed</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00120">driver_manager.h:120</a></div></div>
<div class="ttc" id="astructdriver__desc__t_html_a379f27ac0212ab4a5598e25fc85c02a6"><div class="ttname"><a href="structdriver__desc__t.html#a379f27ac0212ab4a5598e25fc85c02a6">driver_desc_t::type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00115">driver_manager.h:115</a></div></div>
<div class="ttc" id="astructdriver__desc__t_html_ae004afc2a005569b58f1024cb8ae967a"><div class="ttname"><a href="structdriver__desc__t.html#ae004afc2a005569b58f1024cb8ae967a">driver_desc_t::is_device_needed</a></div><div class="ttdeci">bool is_device_needed</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00119">driver_manager.h:119</a></div></div>
<div class="ttc" id="astructdriver__desc__t_html_ae4bb8f8c3f01526c738dd9db7a195c2e"><div class="ttname"><a href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">driver_desc_t::functions</a></div><div class="ttdeci">void * functions[32]</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00127">driver_manager.h:127</a></div></div>
<div class="ttc" id="astructdriver__desc__t_html_ae5b79380543325850b0d177fa72935fb"><div class="ttname"><a href="structdriver__desc__t.html#ae5b79380543325850b0d177fa72935fb">driver_desc_t::auto_start</a></div><div class="ttdeci">bool auto_start</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00117">driver_manager.h:117</a></div></div>
<div class="ttc" id="astructdriver__desc__t_html_af4c1826fb70fbbf3841d9368c9b973c6"><div class="ttname"><a href="structdriver__desc__t.html#af4c1826fb70fbbf3841d9368c9b973c6">driver_desc_t::is_device_driver</a></div><div class="ttdeci">bool is_device_driver</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00118">driver_manager.h:118</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="driver__manager_8h_source.html#l00117">driver_desc_t::auto_start</a>, <a class="el" href="driver__manager_8h_source.html#l00032">DRIVER_FILE_SYSTEM</a>, <a class="el" href="driver__manager_8h_source.html#l00093">DRIVER_FILE_SYSTEM_CAN_READ</a>, <a class="el" href="driver__manager_8h_source.html#l00094">DRIVER_FILE_SYSTEM_CAN_WRITE</a>, <a class="el" href="driver__manager_8h_source.html#l00107">DRIVER_FILE_SYSTEM_CREATE</a>, <a class="el" href="driver__manager_8h_source.html#l00090">DRIVER_FILE_SYSTEM_EJECT_DEVICE</a>, <a class="el" href="driver__manager_8h_source.html#l00103">DRIVER_FILE_SYSTEM_FREE_INODE</a>, <a class="el" href="driver__manager_8h_source.html#l00104">DRIVER_FILE_SYSTEM_GET_FSDATA</a>, <a class="el" href="driver__manager_8h_source.html#l00106">DRIVER_FILE_SYSTEM_GETDENTS</a>, <a class="el" href="driver__manager_8h_source.html#l00110">DRIVER_FILE_SYSTEM_IOCTL</a>, <a class="el" href="driver__manager_8h_source.html#l00105">DRIVER_FILE_SYSTEM_LOOKUP</a>, <a class="el" href="driver__manager_8h_source.html#l00098">DRIVER_FILE_SYSTEM_MKDIR</a>, <a class="el" href="driver__manager_8h_source.html#l00111">DRIVER_FILE_SYSTEM_MMAP</a>, <a class="el" href="driver__manager_8h_source.html#l00092">DRIVER_FILE_SYSTEM_OPEN</a>, <a class="el" href="driver__manager_8h_source.html#l00089">DRIVER_FILE_SYSTEM_PREPARE_FS</a>, <a class="el" href="driver__manager_8h_source.html#l00095">DRIVER_FILE_SYSTEM_READ</a>, <a class="el" href="driver__manager_8h_source.html#l00101">DRIVER_FILE_SYSTEM_READ_INODE</a>, <a class="el" href="driver__manager_8h_source.html#l00088">DRIVER_FILE_SYSTEM_RECOGNIZE</a>, <a class="el" href="driver__manager_8h_source.html#l00099">DRIVER_FILE_SYSTEM_RMDIR</a>, <a class="el" href="driver__manager_8h_source.html#l00097">DRIVER_FILE_SYSTEM_TRUNCATE</a>, <a class="el" href="driver__manager_8h_source.html#l00108">DRIVER_FILE_SYSTEM_UNLINK</a>, <a class="el" href="driver__manager_8h_source.html#l00096">DRIVER_FILE_SYSTEM_WRITE</a>, <a class="el" href="driver__manager_8h_source.html#l00102">DRIVER_FILE_SYSTEM_WRITE_INODE</a>, <a class="el" href="driver__manager_8h_source.html#l00049">DRIVER_NOTIFICATION</a>, <a class="el" href="ext2_8c_source.html#l00801">ext2_can_read()</a>, <a class="el" href="ext2_8c_source.html#l00806">ext2_can_write()</a>, <a class="el" href="ext2_8c_source.html#l00993">ext2_create()</a>, <a class="el" href="ext2_8c_source.html#l00423">ext2_free_inode()</a>, <a class="el" href="ext2_8c_source.html#l00967">ext2_getdents()</a>, <a class="el" href="ext2_8c_source.html#l00895">ext2_lookup()</a>, <a class="el" href="ext2_8c_source.html#l00907">ext2_mkdir()</a>, <a class="el" href="ext2_8c_source.html#l01051">ext2_prepare_fs()</a>, <a class="el" href="ext2_8c_source.html#l00811">ext2_read()</a>, <a class="el" href="ext2_8c_source.html#l00357">ext2_read_inode()</a>, <a class="el" href="ext2_8c_source.html#l01032">ext2_recognize_drive()</a>, <a class="el" href="ext2_8c_source.html#l01015">ext2_rm()</a>, <a class="el" href="ext2_8c_source.html#l00929">ext2_rmdir()</a>, <a class="el" href="ext2_8c_source.html#l01069">ext2_save_state()</a>, <a class="el" href="ext2_8c_source.html#l00872">ext2_truncate()</a>, <a class="el" href="ext2_8c_source.html#l00838">ext2_write()</a>, <a class="el" href="ext2_8c_source.html#l00367">ext2_write_inode()</a>, <a class="el" href="driver__manager_8h_source.html#l00127">driver_desc_t::functions</a>, <a class="el" href="ext2_8c_source.html#l01087">get_fsdata()</a>, <a class="el" href="driver__manager_8h_source.html#l00118">driver_desc_t::is_device_driver</a>, <a class="el" href="driver__manager_8h_source.html#l00119">driver_desc_t::is_device_needed</a>, <a class="el" href="driver__manager_8h_source.html#l00120">driver_desc_t::is_driver_needed</a>, and <a class="el" href="driver__manager_8h_source.html#l00115">driver_desc_t::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01135">ext2_install()</a>.</p>

</div>
</div>
<a id="a84723f344c7649d96276ed822a1ae7bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84723f344c7649d96276ed822a1ae7bc">&#9670;&nbsp;</a></span>_ext2_find_free_block_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_find_free_block_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>group_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00292">292</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> block_bitmap[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, block_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#aa1d4d1557663a71e54e63ce183d0cb10">block_bitmap</a>), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> off = 0; off &lt; <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>); off++) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ext2_8c.html#af42fc74892d7f538598a9dfcd4501ccd">_ext2_bitmap_get</a>(block_bitmap, off)) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            *block_index = fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>-&gt;<a class="code" href="structsuperblock__t.html#a83eb288cd229ff51fef58efefe7f82f0">blocks_per_group</a> * group_index + off + 1;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <a class="code" href="ext2_8c.html#a28ea265adf1148a553710998c6809cb5">_ext2_bitmap_set_bit</a>(block_bitmap, off);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, block_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#aa1d4d1557663a71e54e63ce183d0cb10">block_bitmap</a>), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a28ea265adf1148a553710998c6809cb5"><div class="ttname"><a href="ext2_8c.html#a28ea265adf1148a553710998c6809cb5">_ext2_bitmap_set_bit</a></div><div class="ttdeci">static void _ext2_bitmap_set_bit(uint8_t *bitmap, uint32_t index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00164">ext2.c:164</a></div></div>
<div class="ttc" id="aext2_8c_html_af42fc74892d7f538598a9dfcd4501ccd"><div class="ttname"><a href="ext2_8c.html#af42fc74892d7f538598a9dfcd4501ccd">_ext2_bitmap_get</a></div><div class="ttdeci">static bool _ext2_bitmap_get(uint8_t *bitmap, uint32_t index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00159">ext2.c:159</a></div></div>
<div class="ttc" id="astructgroup__desc__t_html_aa1d4d1557663a71e54e63ce183d0cb10"><div class="ttname"><a href="structgroup__desc__t.html#aa1d4d1557663a71e54e63ce183d0cb10">group_desc_t::block_bitmap</a></div><div class="ttdeci">uint32_t block_bitmap</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00055">ext2.h:55</a></div></div>
<div class="ttc" id="astructsuperblock__t_html_a83eb288cd229ff51fef58efefe7f82f0"><div class="ttname"><a href="structsuperblock__t.html#a83eb288cd229ff51fef58efefe7f82f0">superblock_t::blocks_per_group</a></div><div class="ttdeci">uint32_t blocks_per_group</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00017">ext2.h:17</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00159">_ext2_bitmap_get()</a>, <a class="el" href="ext2_8c_source.html#l00164">_ext2_bitmap_set_bit()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8h_source.html#l00055">group_desc_t::block_bitmap</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00017">superblock_t::blocks_per_group</a>, <a class="el" href="include_2errno_8h_source.html#l00031">ENOSPC</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00308">_ext2_allocate_block_index()</a>.</p>

</div>
</div>
<a id="a934c5a0b083bf7d498debb2a4d4f2f70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a934c5a0b083bf7d498debb2a4d4f2f70">&#9670;&nbsp;</a></span>_ext2_find_free_inode_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_find_free_inode_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>inode_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>group_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00377">377</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> inode_bitmap[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, inode_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#ae44f82fab803868aaf16e068ad935943">inode_bitmap</a>), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> off = 0; off &lt; <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>); off++) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ext2_8c.html#af42fc74892d7f538598a9dfcd4501ccd">_ext2_bitmap_get</a>(inode_bitmap, off)) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            *inode_index = <a class="code" href="ext2_8c.html#abc4cb8adac167448da16a169f41dbbc4">SUPERBLOCK</a>-&gt;inodes_per_group * group_index + off + 1;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <a class="code" href="ext2_8c.html#a28ea265adf1148a553710998c6809cb5">_ext2_bitmap_set_bit</a>(inode_bitmap, off);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, inode_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#ae44f82fab803868aaf16e068ad935943">inode_bitmap</a>), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_abc4cb8adac167448da16a169f41dbbc4"><div class="ttname"><a href="ext2_8c.html#abc4cb8adac167448da16a169f41dbbc4">SUPERBLOCK</a></div><div class="ttdeci">#define SUPERBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00019">ext2.c:19</a></div></div>
<div class="ttc" id="astructgroup__desc__t_html_ae44f82fab803868aaf16e068ad935943"><div class="ttname"><a href="structgroup__desc__t.html#ae44f82fab803868aaf16e068ad935943">group_desc_t::inode_bitmap</a></div><div class="ttdeci">uint32_t inode_bitmap</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00056">ext2.h:56</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00159">_ext2_bitmap_get()</a>, <a class="el" href="ext2_8c_source.html#l00164">_ext2_bitmap_set_bit()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="include_2errno_8h_source.html#l00031">ENOSPC</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, <a class="el" href="ext2_8h_source.html#l00056">group_desc_t::inode_bitmap</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, <a class="el" href="ext2_8c_source.html#l00019">SUPERBLOCK</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00393">_ext2_allocate_inode_index()</a>.</p>

</div>
</div>
<a id="a60e86ceec6ee897d1b22846bddca0735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60e86ceec6ee897d1b22846bddca0735">&#9670;&nbsp;</a></span>_ext2_free_block_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_free_block_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00322">322</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    block_index--;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> group_index = block_index / block_len;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> off = block_index % block_len;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> block_bitmap[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, block_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#aa1d4d1557663a71e54e63ce183d0cb10">block_bitmap</a>), block_len);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="ext2_8c.html#a7d1851885a1837ea695e388e996ab1bb">_ext2_bitmap_unset_bit</a>(block_bitmap, off);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, block_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#aa1d4d1557663a71e54e63ce183d0cb10">block_bitmap</a>), block_len);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a7d1851885a1837ea695e388e996ab1bb"><div class="ttname"><a href="ext2_8c.html#a7d1851885a1837ea695e388e996ab1bb">_ext2_bitmap_unset_bit</a></div><div class="ttdeci">static void _ext2_bitmap_unset_bit(uint8_t *bitmap, uint32_t index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00169">ext2.c:169</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00169">_ext2_bitmap_unset_bit()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8h_source.html#l00055">group_desc_t::block_bitmap</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00423">ext2_free_inode()</a>, and <a class="el" href="ext2_8c_source.html#l00872">ext2_truncate()</a>.</p>

</div>
</div>
<a id="a9a92f28e05901682f9a46e7a111dc972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a92f28e05901682f9a46e7a111dc972">&#9670;&nbsp;</a></span>_ext2_free_inode_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_free_inode_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00407">407</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    inode_index--;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inodes_per_group = fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>-&gt;<a class="code" href="structsuperblock__t.html#a9c53c3bf74e319bf4fe60313d2afe456">inodes_per_group</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> group_index = inode_index / inodes_per_group;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> off = inode_index % inodes_per_group;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> inode_bitmap[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, inode_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#ae44f82fab803868aaf16e068ad935943">inode_bitmap</a>), block_len);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="ext2_8c.html#a7d1851885a1837ea695e388e996ab1bb">_ext2_bitmap_unset_bit</a>(inode_bitmap, off);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, inode_bitmap, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[group_index].<a class="code" href="structgroup__desc__t.html#ae44f82fab803868aaf16e068ad935943">inode_bitmap</a>), block_len);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="ttc" id="astructsuperblock__t_html_a9c53c3bf74e319bf4fe60313d2afe456"><div class="ttname"><a href="structsuperblock__t.html#a9c53c3bf74e319bf4fe60313d2afe456">superblock_t::inodes_per_group</a></div><div class="ttdeci">uint32_t inodes_per_group</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00019">ext2.h:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00169">_ext2_bitmap_unset_bit()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, <a class="el" href="ext2_8h_source.html#l00056">group_desc_t::inode_bitmap</a>, <a class="el" href="ext2_8h_source.html#l00019">superblock_t::inodes_per_group</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00423">ext2_free_inode()</a>.</p>

</div>
</div>
<a id="aa13178156da204b197f2dcc8e31491dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa13178156da204b197f2dcc8e31491dd">&#9670;&nbsp;</a></span>_ext2_get_block_of_inode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _ext2_get_block_of_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00233">233</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>) / 4;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (inode_block_index &lt; 12) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[inode_block_index];</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inode_block_index &lt; 12 + block_len) { <span class="comment">// single indirect</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ext2_8c.html#a3edde2501af21c6114152b32c3f44476">_ext2_get_block_of_inode_lev0</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[12], inode_block_index - 12);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inode_block_index &lt; 12 + block_len + block_len * block_len) { <span class="comment">// double indirect</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ext2_8c.html#a3b64a3a170b46c0b948f551539380bd5">_ext2_get_block_of_inode_lev1</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[13], inode_block_index - 12 - block_len);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// triple indirect</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ext2_8c.html#a0afd935d31326a3d5d2d2a1d6d714840">_ext2_get_block_of_inode_lev2</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[14], inode_block_index - (12 + block_len + block_len * block_len));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a0afd935d31326a3d5d2d2a1d6d714840"><div class="ttname"><a href="ext2_8c.html#a0afd935d31326a3d5d2d2a1d6d714840">_ext2_get_block_of_inode_lev2</a></div><div class="ttdeci">static uint32_t _ext2_get_block_of_inode_lev2(dentry_t *dentry, uint32_t cur_block, uint32_t inode_block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00221">ext2.c:221</a></div></div>
<div class="ttc" id="aext2_8c_html_a3b64a3a170b46c0b948f551539380bd5"><div class="ttname"><a href="ext2_8c.html#a3b64a3a170b46c0b948f551539380bd5">_ext2_get_block_of_inode_lev1</a></div><div class="ttdeci">static uint32_t _ext2_get_block_of_inode_lev1(dentry_t *dentry, uint32_t cur_block, uint32_t inode_block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00211">ext2.c:211</a></div></div>
<div class="ttc" id="aext2_8c_html_a3edde2501af21c6114152b32c3f44476"><div class="ttname"><a href="ext2_8c.html#a3edde2501af21c6114152b32c3f44476">_ext2_get_block_of_inode_lev0</a></div><div class="ttdeci">static uint32_t _ext2_get_block_of_inode_lev0(dentry_t *dentry, uint32_t cur_block, uint32_t inode_block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00203">ext2.c:203</a></div></div>
<div class="ttc" id="astructinode__t_html_a558808bd75e706a5c78229a2c0f270ff"><div class="ttname"><a href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">inode_t::block</a></div><div class="ttdeci">uint32_t block[15]</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00104">ext2.h:104</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00203">_ext2_get_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l00211">_ext2_get_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00221">_ext2_get_block_of_inode_lev2()</a>, <a class="el" href="ext2_8h_source.html#l00104">inode_t::block</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00719">_ext2_add_child()</a>, <a class="el" href="ext2_8c_source.html#l00541">_ext2_is_dir_empty()</a>, <a class="el" href="ext2_8c_source.html#l00748">_ext2_rm_child()</a>, <a class="el" href="ext2_8c_source.html#l00423">ext2_free_inode()</a>, <a class="el" href="ext2_8c_source.html#l00967">ext2_getdents()</a>, <a class="el" href="ext2_8c_source.html#l00949">ext2_getdirent()</a>, <a class="el" href="ext2_8c_source.html#l00895">ext2_lookup()</a>, <a class="el" href="ext2_8c_source.html#l00811">ext2_read()</a>, <a class="el" href="ext2_8c_source.html#l00872">ext2_truncate()</a>, and <a class="el" href="ext2_8c_source.html#l00838">ext2_write()</a>.</p>

</div>
</div>
<a id="a3edde2501af21c6114152b32c3f44476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3edde2501af21c6114152b32c3f44476">&#9670;&nbsp;</a></span>_ext2_get_block_of_inode_lev0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _ext2_get_block_of_inode_lev0 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>cur_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00203">203</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset = inode_block_index;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> res;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)&amp;res, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, cur_block) + offset * 4, 4);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, and <a class="el" href="ext2_8c_source.html#l00211">_ext2_get_block_of_inode_lev1()</a>.</p>

</div>
</div>
<a id="a3b64a3a170b46c0b948f551539380bd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b64a3a170b46c0b948f551539380bd5">&#9670;&nbsp;</a></span>_ext2_get_block_of_inode_lev1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _ext2_get_block_of_inode_lev1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>cur_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00211">211</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> lev_contain = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>) / 4;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset = inode_block_index / lev_contain;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset_inner = inode_block_index % lev_contain;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> res;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)&amp;res, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, cur_block) + offset * 4, 4);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> res ? <a class="code" href="ext2_8c.html#a3edde2501af21c6114152b32c3f44476">_ext2_get_block_of_inode_lev0</a>(<a class="code" href="structdentry.html">dentry</a>, res, offset_inner) : 0;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00203">_ext2_get_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, and <a class="el" href="ext2_8c_source.html#l00221">_ext2_get_block_of_inode_lev2()</a>.</p>

</div>
</div>
<a id="a0afd935d31326a3d5d2d2a1d6d714840"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0afd935d31326a3d5d2d2a1d6d714840">&#9670;&nbsp;</a></span>_ext2_get_block_of_inode_lev2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _ext2_get_block_of_inode_lev2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>cur_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00221">221</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>) / 4;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> lev_contain = block_len * block_len;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset = inode_block_index / lev_contain;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset_inner = inode_block_index % lev_contain;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> res;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)&amp;res, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, cur_block) + offset * 4, 4);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">return</span> res ? <a class="code" href="ext2_8c.html#a3b64a3a170b46c0b948f551539380bd5">_ext2_get_block_of_inode_lev1</a>(<a class="code" href="structdentry.html">dentry</a>, res, offset_inner) : 0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00211">_ext2_get_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>.</p>

</div>
</div>
<a id="aded8027a81d47374997ce986b9d058b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded8027a81d47374997ce986b9d058b2">&#9670;&nbsp;</a></span>_ext2_get_block_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _ext2_get_block_offset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsuperblock__t.html">superblock_t</a> *&#160;</td>
          <td class="paramname"><em>sb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>BLOCK FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00198">198</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ext2_8h.html#ac5a3192d315d69b7ab2a21ab206da32f">SUPERBLOCK_START</a> + (block_index - 1) * <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(sb);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="ttc" id="aext2_8h_html_ac5a3192d315d69b7ab2a21ab206da32f"><div class="ttname"><a href="ext2_8h.html#ac5a3192d315d69b7ab2a21ab206da32f">SUPERBLOCK_START</a></div><div class="ttdeci">#define SUPERBLOCK_START</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00006">ext2.h:6</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, and <a class="el" href="ext2_8h_source.html#l00006">SUPERBLOCK_START</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00613">_ext2_add_first_entry_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00636">_ext2_add_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00292">_ext2_find_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00377">_ext2_find_free_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00322">_ext2_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00407">_ext2_free_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00203">_ext2_get_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l00211">_ext2_get_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00221">_ext2_get_block_of_inode_lev2()</a>, <a class="el" href="ext2_8c_source.html#l00516">_ext2_get_dir_entries_count_in_block()</a>, <a class="el" href="ext2_8c_source.html#l00569">_ext2_getdents_block()</a>, <a class="el" href="ext2_8c_source.html#l00483">_ext2_getdirent_block()</a>, <a class="el" href="ext2_8c_source.html#l00449">_ext2_lookup_block()</a>, <a class="el" href="ext2_8c_source.html#l00683">_ext2_rm_from_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00247">_ext2_set_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l00254">_ext2_set_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00264">_ext2_set_block_of_inode_lev2()</a>, <a class="el" href="ext2_8c_source.html#l01051">ext2_prepare_fs()</a>, <a class="el" href="ext2_8c_source.html#l00811">ext2_read()</a>, <a class="el" href="ext2_8c_source.html#l00357">ext2_read_inode()</a>, <a class="el" href="ext2_8c_source.html#l01069">ext2_save_state()</a>, <a class="el" href="ext2_8c_source.html#l00838">ext2_write()</a>, and <a class="el" href="ext2_8c_source.html#l00367">ext2_write_inode()</a>.</p>

</div>
</div>
<a id="a2cbc2689640a4954d36f2eb35f9ba575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cbc2689640a4954d36f2eb35f9ba575">&#9670;&nbsp;</a></span>_ext2_get_dir_entries_count_in_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_get_dir_entries_count_in_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00516">516</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;{</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="kassert_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(block_index != 0);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> internal_offset = 0;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), block_len);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_buf + internal_offset);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        internal_offset += start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> != 0) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            result++;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">if</span> (internal_offset &gt;= block_len) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="ttc" id="akassert_8h_html_aca68c0d4ac8df0838e209fb5300f7be3"><div class="ttname"><a href="kassert_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a></div><div class="ttdeci">#define ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="kassert_8h_source.html#l00016">kassert.h:16</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="kassert_8h_source.html#l00016">ASSERT</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00114">dir_entry_t::inode</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00115">dir_entry_t::rec_len</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00541">_ext2_is_dir_empty()</a>.</p>

</div>
</div>
<a id="ab3a1742ecfeaccd951a6608d43788fff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3a1742ecfeaccd951a6608d43788fff">&#9670;&nbsp;</a></span>_ext2_get_disk_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _ext2_get_disk_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00149">149</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> (*get_size)(<a class="code" href="structdevice__t.html">device_t</a> * d) = <a class="code" href="driver__manager_8h.html#a621ce2927c9942fb5588924a08eb344f">drivers</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#aff7ef7ad8994221acb6b96c25dd207a8">driver_id</a>].<a class="code" href="structdriver__t.html#a1e42c2d6b8552290bbf31e6bf1b8fe46">desc</a>.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#a6e15d86e8592a28700f6b16c38b08999afbacdef920e226a30e3405d47c71b428">DRIVER_STORAGE_CAPACITY</a>];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> get_size(dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="ttc" id="adriver__manager_8h_html_a621ce2927c9942fb5588924a08eb344f"><div class="ttname"><a href="driver__manager_8h.html#a621ce2927c9942fb5588924a08eb344f">drivers</a></div><div class="ttdeci">driver_t drivers[256]</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8c_source.html#l00011">driver_manager.c:11</a></div></div>
<div class="ttc" id="adriver__manager_8h_html_a6e15d86e8592a28700f6b16c38b08999afbacdef920e226a30e3405d47c71b428"><div class="ttname"><a href="driver__manager_8h.html#a6e15d86e8592a28700f6b16c38b08999afbacdef920e226a30e3405d47c71b428">DRIVER_STORAGE_CAPACITY</a></div><div class="ttdeci">@ DRIVER_STORAGE_CAPACITY</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00064">driver_manager.h:64</a></div></div>
<div class="ttc" id="astructdevice__t_html"><div class="ttname"><a href="structdevice__t.html">device_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00150">driver_manager.h:150</a></div></div>
<div class="ttc" id="astructdevice__t_html_aff7ef7ad8994221acb6b96c25dd207a8"><div class="ttname"><a href="structdevice__t.html#aff7ef7ad8994221acb6b96c25dd207a8">device_t::driver_id</a></div><div class="ttdeci">int16_t driver_id</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00154">driver_manager.h:154</a></div></div>
<div class="ttc" id="astructdriver__t_html_a1e42c2d6b8552290bbf31e6bf1b8fe46"><div class="ttname"><a href="structdriver__t.html#a1e42c2d6b8552290bbf31e6bf1b8fe46">driver_t::desc</a></div><div class="ttdeci">driver_desc_t desc</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00133">driver_manager.h:133</a></div></div>
<div class="ttc" id="astructvfs__device__t_html_a7d55f55d8ecf251fc986269079650c2d"><div class="ttname"><a href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">vfs_device_t::dev</a></div><div class="ttdeci">device_t * dev</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00036">vfs.h:36</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="driver__manager_8h_source.html#l00133">driver_t::desc</a>, <a class="el" href="vfs_8h_source.html#l00036">vfs_device_t::dev</a>, <a class="el" href="driver__manager_8h_source.html#l00154">device_t::driver_id</a>, <a class="el" href="driver__manager_8h_source.html#l00064">DRIVER_STORAGE_CAPACITY</a>, <a class="el" href="driver__manager_8c_source.html#l00011">drivers</a>, and <a class="el" href="driver__manager_8h_source.html#l00127">driver_desc_t::functions</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00183">_ext2_get_groups_cnt()</a>.</p>

</div>
</div>
<a id="a853d9483f0f37d321c07ea1c5472fdba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853d9483f0f37d321c07ea1c5472fdba">&#9670;&nbsp;</a></span>_ext2_get_group_len()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> _ext2_get_group_len </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsuperblock__t.html">superblock_t</a> *&#160;</td>
          <td class="paramname"><em>sb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>GROUPS FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00178">178</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(sb) * <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(sb) * 8;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00183">_ext2_get_groups_cnt()</a>.</p>

</div>
</div>
<a id="a2417437958963f3126f55d048baaae81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2417437958963f3126f55d048baaae81">&#9670;&nbsp;</a></span>_ext2_get_groups_cnt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_get_groups_cnt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsuperblock__t.html">superblock_t</a> *&#160;</td>
          <td class="paramname"><em>sb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00183">183</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> sz = <a class="code" href="ext2_8c.html#ab3a1742ecfeaccd951a6608d43788fff">_ext2_get_disk_size</a>(dev) - <a class="code" href="ext2_8h.html#ac5a3192d315d69b7ab2a21ab206da32f">SUPERBLOCK_START</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> ans = sz / <a class="code" href="ext2_8c.html#a853d9483f0f37d321c07ea1c5472fdba">_ext2_get_group_len</a>(sb);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">/* TODO: Work with the last smaller group. */</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// if (sz % get_group_len()) {</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">//     ans++;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a853d9483f0f37d321c07ea1c5472fdba"><div class="ttname"><a href="ext2_8c.html#a853d9483f0f37d321c07ea1c5472fdba">_ext2_get_group_len</a></div><div class="ttdeci">static uint32_t _ext2_get_group_len(superblock_t *sb)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00178">ext2.c:178</a></div></div>
<div class="ttc" id="aext2_8c_html_ab3a1742ecfeaccd951a6608d43788fff"><div class="ttname"><a href="ext2_8c.html#ab3a1742ecfeaccd951a6608d43788fff">_ext2_get_disk_size</a></div><div class="ttdeci">static uint32_t _ext2_get_disk_size(vfs_device_t *dev)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00149">ext2.c:149</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00149">_ext2_get_disk_size()</a>, <a class="el" href="ext2_8c_source.html#l00178">_ext2_get_group_len()</a>, and <a class="el" href="ext2_8h_source.html#l00006">SUPERBLOCK_START</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01051">ext2_prepare_fs()</a>.</p>

</div>
</div>
<a id="ac9c672e0f12ef73f108d8a5fb70777cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9c672e0f12ef73f108d8a5fb70777cc">&#9670;&nbsp;</a></span>_ext2_getdents_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_getdents_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inner_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>scanned_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>_ext2_getdents_block puts dents into @buf from block with index @block_index. @block_index: index block to put from @buf: result buffer @len: len of the buffer @buf @inner_offset: offset of block, shows the start from where to start @scanned_bytes: keeps the result value how many bytes were scanned in this block. return: returns an error (if return &lt; 0) or count of bytes written to @buf. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00569">569</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;{</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (block_index == 0) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">int</span> already_read = 0;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), block_len);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_buf + inner_offset);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> record_name_len = <a class="code" href="ext2_8c.html#ac0df43d2359093fd8019da90f7cadb93">NORM_FILENAME</a>(start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">name_len</a>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> real_rec_len = 8 + record_name_len + 1;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span> (real_rec_len &gt; len) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="comment">/*  There is no space to put this element in the buffer.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">                If we havn&#39;t written anything, that means we can&#39;t fit</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">                the elem in the buf, so, return an error */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">if</span> (already_read == 0) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">return</span> already_read;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        inner_offset += start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        *scanned_bytes += start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> != 0) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="comment">// Change it here, to have the correct copied data.</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a> = real_rec_len;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>(<a class="code" href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a> + already_read, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)start_of_entry, real_rec_len);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <a class="code" href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>[already_read + real_rec_len - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            already_read += real_rec_len;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            len -= real_rec_len;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span> (inner_offset &gt;= block_len) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">return</span> already_read;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">return</span> already_read;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div>
<div class="ttc" id="acat_2main_8c_html_a78a05cf530dddc61e7a26aefe187bd31"><div class="ttname"><a href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a></div><div class="ttdeci">char buf[512]</div><div class="ttdef"><b>Definition:</b> <a href="cat_2main_8c_source.html#l00004">main.c:4</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="cat_2main_8c_source.html#l00004">buf</a>, <a class="el" href="include_2errno_8h_source.html#l00025">EINVAL</a>, <a class="el" href="ext2_8h_source.html#l00114">dir_entry_t::inode</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="ext2_8h_source.html#l00116">dir_entry_t::name_len</a>, <a class="el" href="ext2_8c_source.html#l00023">NORM_FILENAME</a>, <a class="el" href="ext2_8h_source.html#l00115">dir_entry_t::rec_len</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00967">ext2_getdents()</a>.</p>

</div>
</div>
<a id="ad272a83ae1e6d86a1ec0964a65f5a59b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad272a83ae1e6d86a1ec0964a65f5a59b">&#9670;&nbsp;</a></span>_ext2_getdirent_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_getdirent_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#a6673e8f64ca9ebd7e26e6289dca06e87">dirent_t</a> *&#160;</td>
          <td class="paramname"><em>dirent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00483">483</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (block_index == 0) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> internal_offset = *offset % block_len;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), block_len);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_buf + internal_offset);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        internal_offset += start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        *offset += start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> != 0) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordtype">int</span> name_len = start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">name_len</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordflow">if</span> (name_len &gt; 251) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <a class="code" href="include_2drivers_2x86_2display_8h.html#a3a0750b7c0a8273a6127da120a5e0ff8">kprintf</a>(<span class="stringliteral">&quot;[VFS] Full name len is unsupported\n&quot;</span>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                name_len = 251;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="mem_8h.html#ad2da9e2d51c0279601e740bb36ef6156">memcpy</a>(<a class="code" href="structdirent.html">dirent</a>-&gt;<a class="code" href="structdirent.html#a9bbac6b9acae5b3166058873f878a08d">name</a>, (<span class="keywordtype">char</span>*)start_of_entry + 8, name_len);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <a class="code" href="structdirent.html">dirent</a>-&gt;<a class="code" href="structdirent.html#a9bbac6b9acae5b3166058873f878a08d">name</a>[name_len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">if</span> (internal_offset &gt;= block_len) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div>
<div class="ttc" id="ainclude_2drivers_2x86_2display_8h_html_a3a0750b7c0a8273a6127da120a5e0ff8"><div class="ttname"><a href="include_2drivers_2x86_2display_8h.html#a3a0750b7c0a8273a6127da120a5e0ff8">kprintf</a></div><div class="ttdeci">void kprintf(const char *string,...)</div><div class="ttdef"><b>Definition:</b> <a href="kernel_2drivers_2x86_2display_8c_source.html#l00100">display.c:100</a></div></div>
<div class="ttc" id="astructdirent_html"><div class="ttname"><a href="structdirent.html">dirent</a></div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00039">vfs.h:39</a></div></div>
<div class="ttc" id="astructdirent_html_a9bbac6b9acae5b3166058873f878a08d"><div class="ttname"><a href="structdirent.html#a9bbac6b9acae5b3166058873f878a08d">dirent::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00044">vfs.h:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00025">EINVAL</a>, <a class="el" href="ext2_8h_source.html#l00114">dir_entry_t::inode</a>, <a class="el" href="kernel_2drivers_2x86_2display_8c_source.html#l00100">kprintf()</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="string_8c_source.html#l00023">memcpy()</a>, <a class="el" href="vfs_8h_source.html#l00044">dirent::name</a>, <a class="el" href="ext2_8h_source.html#l00116">dir_entry_t::name_len</a>, <a class="el" href="ext2_8h_source.html#l00115">dir_entry_t::rec_len</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00949">ext2_getdirent()</a>.</p>

</div>
</div>
<a id="a8271c1d7d78c99f592b0c345552b4fae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8271c1d7d78c99f592b0c345552b4fae">&#9670;&nbsp;</a></span>_ext2_is_dir_empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> _ext2_is_dir_empty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00541">541</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;{</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> end_block_index = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index = 0; block_index &lt; end_block_index; block_index++) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> data_block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(dir, block_index);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        result += <a class="code" href="ext2_8c.html#a2cbc2689640a4954d36f2eb35f9ba575">_ext2_get_dir_entries_count_in_block</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, data_block_index);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">/* 2 here is because don&#39;t count . and .. */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span> (result &gt; 2) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a2cbc2689640a4954d36f2eb35f9ba575"><div class="ttname"><a href="ext2_8c.html#a2cbc2689640a4954d36f2eb35f9ba575">_ext2_get_dir_entries_count_in_block</a></div><div class="ttdeci">static int _ext2_get_dir_entries_count_in_block(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00516">ext2.c:516</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00516">_ext2_get_dir_entries_count_in_block()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00929">ext2_rmdir()</a>.</p>

</div>
</div>
<a id="a64961e1b5f9327d4953795643913541d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64961e1b5f9327d4953795643913541d">&#9670;&nbsp;</a></span>_ext2_lookup_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_lookup_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>found_inode_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>DIR FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00449">449</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;{</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (block_index == 0) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)tmp_buf;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> == 0) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">name_len</a> == len) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordtype">bool</span> is_name_same = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a4723d0503b408ee6b392f65aa897f520">name_len</a>; i++) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                is_name_same &amp;= (<a class="code" href="namespacecopy__bin.html#ac19e0622db9715c974b893fdb8327374">name</a>[i] == *((<span class="keywordtype">char</span>*)start_of_entry + 8 + i));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span> (is_name_same) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                *found_inode_index = start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry + start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry &gt;= (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_buf + <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>)) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00025">EINVAL</a>, <a class="el" href="ext2_8h_source.html#l00114">dir_entry_t::inode</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="copy__bin_8py_source.html#l00071">copy_bin::name</a>, <a class="el" href="ext2_8h_source.html#l00116">dir_entry_t::name_len</a>, <a class="el" href="ext2_8h_source.html#l00115">dir_entry_t::rec_len</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00895">ext2_lookup()</a>.</p>

</div>
</div>
<a id="a2c62a613f06d8c74885169dfb8cfc3fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c62a613f06d8c74885169dfb8cfc3fd">&#9670;&nbsp;</a></span>_ext2_read_from_dev()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _ext2_read_from_dev </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>DRIVE RELATED FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00108">108</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    void (*<a class="code" href="syscalls_8c.html#a4b18d2ebe6f1360b6e70b51d90f89ff9">read</a>)(<a class="code" href="structdevice__t.html">device_t</a> * d, <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> s, <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> * r) = <a class="code" href="driver__manager_8h.html#a621ce2927c9942fb5588924a08eb344f">drivers</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#aff7ef7ad8994221acb6b96c25dd207a8">driver_id</a>].<a class="code" href="structdriver__t.html#a1e42c2d6b8552290bbf31e6bf1b8fe46">desc</a>.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#a6e15d86e8592a28700f6b16c38b08999a4f85aa71fa1b138e3a56545bc4f92d3e">DRIVER_STORAGE_READ</a>];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">int</span> already_read = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> sector = start / 512;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start_offset = start % 512;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[512];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    while (len) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="syscalls_8c.html#a4b18d2ebe6f1360b6e70b51d90f89ff9">read</a>(dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>, sector, tmp_buf);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(512 - start_offset, len); i++) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>[already_read++] = tmp_buf[start_offset + i];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        len -= <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(512 - start_offset, len);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        sector++;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        start_offset = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="ttc" id="adriver__manager_8h_html_a6e15d86e8592a28700f6b16c38b08999a4f85aa71fa1b138e3a56545bc4f92d3e"><div class="ttname"><a href="driver__manager_8h.html#a6e15d86e8592a28700f6b16c38b08999a4f85aa71fa1b138e3a56545bc4f92d3e">DRIVER_STORAGE_READ</a></div><div class="ttdeci">@ DRIVER_STORAGE_READ</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00061">driver_manager.h:61</a></div></div>
<div class="ttc" id="aext2_8c_html_ad2f3678bf5eae3684fc497130b946eae"><div class="ttname"><a href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a></div><div class="ttdeci">#define MIN(X, Y)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00018">ext2.c:18</a></div></div>
<div class="ttc" id="asyscalls_8c_html_a4b18d2ebe6f1360b6e70b51d90f89ff9"><div class="ttname"><a href="syscalls_8c.html#a4b18d2ebe6f1360b6e70b51d90f89ff9">read</a></div><div class="ttdeci">int read(int fd, char *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> <a href="syscalls_8c_source.html#l00024">syscalls.c:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cat_2main_8c_source.html#l00004">buf</a>, <a class="el" href="driver__manager_8h_source.html#l00133">driver_t::desc</a>, <a class="el" href="vfs_8h_source.html#l00036">vfs_device_t::dev</a>, <a class="el" href="driver__manager_8h_source.html#l00154">device_t::driver_id</a>, <a class="el" href="driver__manager_8h_source.html#l00061">DRIVER_STORAGE_READ</a>, <a class="el" href="driver__manager_8c_source.html#l00011">drivers</a>, <a class="el" href="driver__manager_8h_source.html#l00127">driver_desc_t::functions</a>, <a class="el" href="ext2_8c_source.html#l00018">MIN</a>, and <a class="el" href="syscalls_8c_source.html#l00024">read()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00613">_ext2_add_first_entry_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00636">_ext2_add_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00292">_ext2_find_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00377">_ext2_find_free_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00322">_ext2_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00407">_ext2_free_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00203">_ext2_get_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l00211">_ext2_get_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00221">_ext2_get_block_of_inode_lev2()</a>, <a class="el" href="ext2_8c_source.html#l00516">_ext2_get_dir_entries_count_in_block()</a>, <a class="el" href="ext2_8c_source.html#l00569">_ext2_getdents_block()</a>, <a class="el" href="ext2_8c_source.html#l00483">_ext2_getdirent_block()</a>, <a class="el" href="ext2_8c_source.html#l00449">_ext2_lookup_block()</a>, <a class="el" href="ext2_8c_source.html#l00683">_ext2_rm_from_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00254">_ext2_set_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00264">_ext2_set_block_of_inode_lev2()</a>, <a class="el" href="ext2_8c_source.html#l01051">ext2_prepare_fs()</a>, <a class="el" href="ext2_8c_source.html#l00811">ext2_read()</a>, <a class="el" href="ext2_8c_source.html#l00357">ext2_read_inode()</a>, and <a class="el" href="ext2_8c_source.html#l01032">ext2_recognize_drive()</a>.</p>

</div>
</div>
<a id="a0311646294c6138b27500d83485e5c68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0311646294c6138b27500d83485e5c68">&#9670;&nbsp;</a></span>_ext2_rm_child()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_rm_child </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>child_dentry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00748">748</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blocks_per_dir = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; blocks_per_dir; i++) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">if</span> (block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(dir, i)) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a0b24ed98eca9f2162ff5072b59f4ff6c">_ext2_rm_from_dir_block</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, block_index, child_dentry) == 0) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                child_dentry-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a>--;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(child_dentry, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a03e689f378f643d16ea7537918528a48">ENOENT</a>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a0b24ed98eca9f2162ff5072b59f4ff6c"><div class="ttname"><a href="ext2_8c.html#a0b24ed98eca9f2162ff5072b59f4ff6c">_ext2_rm_from_dir_block</a></div><div class="ttdeci">static int _ext2_rm_from_dir_block(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index, dentry_t *child_dentry)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00683">ext2.c:683</a></div></div>
<div class="ttc" id="ainclude_2errno_8h_html_a03e689f378f643d16ea7537918528a48"><div class="ttname"><a href="include_2errno_8h.html#a03e689f378f643d16ea7537918528a48">ENOENT</a></div><div class="ttdeci">#define ENOENT</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00005">errno.h:5</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00683">_ext2_rm_from_dir_block()</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="include_2errno_8h_source.html#l00005">ENOENT</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8h_source.html#l00100">inode_t::links_count</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01015">ext2_rm()</a>, and <a class="el" href="ext2_8c_source.html#l00929">ext2_rmdir()</a>.</p>

</div>
</div>
<a id="a0b24ed98eca9f2162ff5072b59f4ff6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b24ed98eca9f2162ff5072b59f4ff6c">&#9670;&nbsp;</a></span>_ext2_rm_from_dir_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_rm_from_dir_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsdata__t.html">fsdata_t</a>&#160;</td>
          <td class="paramname"><em>fsdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>child_dentry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00683">683</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;{</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (block_index == 0) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[<a class="code" href="ext2_8c.html#adce1205ff8b13b823ae9ff542dcb5b00">MAX_BLOCK_LEN</a>];</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)tmp_buf;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="structdir__entry__t.html">dir_entry_t</a>* prev_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)0;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">if</span> (start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> == child_dentry-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a>) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment">/* FIXME: just fix that */</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">if</span> (!prev_entry) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <a class="code" href="kassert_8h.html#a43cb62099c428c65d943851885a07d6a">kpanic</a>(<span class="stringliteral">&quot;Ext2: can&#39;t delete first entry.&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <span class="comment">/* deleting entry */</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a1fce9e34b6bc2f2eccf92a80d48dd97e">inode</a> = 0;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            prev_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a> += start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, tmp_buf, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, block_index), <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>));</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        prev_entry = start_of_entry;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        start_of_entry = (<a class="code" href="structdir__entry__t.html">dir_entry_t</a>*)((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry + start_of_entry-&gt;<a class="code" href="structdir__entry__t.html#a49408bf51b5fd67a67008f8bdca8a049">rec_len</a>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)start_of_entry &gt;= (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)tmp_buf + <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>)) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00025">EINVAL</a>, <a class="el" href="ext2_8h_source.html#l00114">dir_entry_t::inode</a>, <a class="el" href="vfs_8h_source.html#l00057">dentry::inode_indx</a>, <a class="el" href="kassert_8c_source.html#l00011">kpanic()</a>, <a class="el" href="ext2_8c_source.html#l00016">MAX_BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00115">dir_entry_t::rec_len</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00748">_ext2_rm_child()</a>.</p>

</div>
</div>
<a id="a9e740573402cc417e6ff0d2be99806f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e740573402cc417e6ff0d2be99806f0">&#9670;&nbsp;</a></span>_ext2_set_block_of_inode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int _ext2_set_block_of_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00276">276</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>) / 4;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (inode_block_index &lt; 12) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[inode_block_index] = val;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inode_block_index &lt; 12 + block_len) { <span class="comment">// single indirect</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ext2_8c.html#a98cd58dcdb9175465e2785257b8f8833">_ext2_set_block_of_inode_lev0</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[12], inode_block_index - 12, val);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inode_block_index &lt; 12 + block_len + block_len * block_len) { <span class="comment">// double indirect</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ext2_8c.html#ad196092519f06b1895f4b4afd5ac9c27">_ext2_set_block_of_inode_lev1</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[13], inode_block_index - 12 - block_len, val);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// triple indirect</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ext2_8c.html#a165f50cee12361f7ec4def12eef3b48f">_ext2_set_block_of_inode_lev2</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a558808bd75e706a5c78229a2c0f270ff">block</a>[14], inode_block_index - (12 + block_len + block_len * block_len), val);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a165f50cee12361f7ec4def12eef3b48f"><div class="ttname"><a href="ext2_8c.html#a165f50cee12361f7ec4def12eef3b48f">_ext2_set_block_of_inode_lev2</a></div><div class="ttdeci">static int _ext2_set_block_of_inode_lev2(dentry_t *dentry, uint32_t cur_block, uint32_t inode_block_index, uint32_t val)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00264">ext2.c:264</a></div></div>
<div class="ttc" id="aext2_8c_html_a98cd58dcdb9175465e2785257b8f8833"><div class="ttname"><a href="ext2_8c.html#a98cd58dcdb9175465e2785257b8f8833">_ext2_set_block_of_inode_lev0</a></div><div class="ttdeci">static int _ext2_set_block_of_inode_lev0(dentry_t *dentry, uint32_t cur_block, uint32_t inode_block_index, uint32_t val)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00247">ext2.c:247</a></div></div>
<div class="ttc" id="aext2_8c_html_ad196092519f06b1895f4b4afd5ac9c27"><div class="ttname"><a href="ext2_8c.html#ad196092519f06b1895f4b4afd5ac9c27">_ext2_set_block_of_inode_lev1</a></div><div class="ttdeci">static int _ext2_set_block_of_inode_lev1(dentry_t *dentry, uint32_t cur_block, uint32_t inode_block_index, uint32_t val)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00254">ext2.c:254</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00247">_ext2_set_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l00254">_ext2_set_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00264">_ext2_set_block_of_inode_lev2()</a>, <a class="el" href="ext2_8h_source.html#l00104">inode_t::block</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00340">_ext2_allocate_block_for_inode()</a>.</p>

</div>
</div>
<a id="a98cd58dcdb9175465e2785257b8f8833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98cd58dcdb9175465e2785257b8f8833">&#9670;&nbsp;</a></span>_ext2_set_block_of_inode_lev0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_set_block_of_inode_lev0 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>cur_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00247">247</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset = inode_block_index;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)&amp;val, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, cur_block) + offset * 4, 4);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00276">_ext2_set_block_of_inode()</a>, and <a class="el" href="ext2_8c_source.html#l00254">_ext2_set_block_of_inode_lev1()</a>.</p>

</div>
</div>
<a id="ad196092519f06b1895f4b4afd5ac9c27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad196092519f06b1895f4b4afd5ac9c27">&#9670;&nbsp;</a></span>_ext2_set_block_of_inode_lev1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_set_block_of_inode_lev1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>cur_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00254">254</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> lev_contain = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>) / 4;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset = inode_block_index / lev_contain;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset_inner = inode_block_index % lev_contain;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> res;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)&amp;res, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, cur_block) + offset * 4, 4);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> res ? <a class="code" href="ext2_8c.html#a98cd58dcdb9175465e2785257b8f8833">_ext2_set_block_of_inode_lev0</a>(<a class="code" href="structdentry.html">dentry</a>, res, offset_inner, val) : -1;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00247">_ext2_set_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00276">_ext2_set_block_of_inode()</a>, and <a class="el" href="ext2_8c_source.html#l00264">_ext2_set_block_of_inode_lev2()</a>.</p>

</div>
</div>
<a id="a165f50cee12361f7ec4def12eef3b48f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a165f50cee12361f7ec4def12eef3b48f">&#9670;&nbsp;</a></span>_ext2_set_block_of_inode_lev2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_set_block_of_inode_lev2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>cur_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_block_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00264">264</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>) / 4;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> lev_contain = block_len * block_len;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset = inode_block_index / lev_contain;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> offset_inner = inode_block_index % lev_contain;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> res;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)&amp;res, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, cur_block) + offset * 4, 4);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">return</span> res ? <a class="code" href="ext2_8c.html#ad196092519f06b1895f4b4afd5ac9c27">_ext2_set_block_of_inode_lev1</a>(<a class="code" href="structdentry.html">dentry</a>, res, offset_inner, val) : -1;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00254">_ext2_set_block_of_inode_lev1()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00276">_ext2_set_block_of_inode()</a>.</p>

</div>
</div>
<a id="af460c141d44aae82274d4059e7498b33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af460c141d44aae82274d4059e7498b33">&#9670;&nbsp;</a></span>_ext2_setup_dir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_setup_dir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>parent_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00766">766</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;{</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a1c4f9ec5d915951d176c80807f1b7f86">mode</a> = <a class="code" href="edit_2main_8c.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#abcde5f0fce4e39254b0e25c32998cf88">uid</a> = 0; <span class="comment">// FIXME: uid of real user</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a> = 0;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a> = 0;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(dir, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a0faa31a843f1591fbb073e00a9653e2c">_ext2_add_child</a>(dir, dir, <span class="stringliteral">&quot;.&quot;</span>, 1) &lt; 0) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a0faa31a843f1591fbb073e00a9653e2c">_ext2_add_child</a>(dir, parent_dir, <span class="stringliteral">&quot;..&quot;</span>, 2) &lt; 0) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;}</div>
<div class="ttc" id="aedit_2main_8c_html_a6b29e4f37f4482274af785ad5ffe96a7"><div class="ttname"><a href="edit_2main_8c.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a></div><div class="ttdeci">uint32_t mode</div><div class="ttdef"><b>Definition:</b> <a href="edit_2main_8c_source.html#l00018">main.c:18</a></div></div>
<div class="ttc" id="aext2_8c_html_a0faa31a843f1591fbb073e00a9653e2c"><div class="ttname"><a href="ext2_8c.html#a0faa31a843f1591fbb073e00a9653e2c">_ext2_add_child</a></div><div class="ttdeci">static int _ext2_add_child(dentry_t *dir, dentry_t *child_dentry, const char *name, int len)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00719">ext2.c:719</a></div></div>
<div class="ttc" id="astructinode__t_html_a1c4f9ec5d915951d176c80807f1b7f86"><div class="ttname"><a href="structinode__t.html#a1c4f9ec5d915951d176c80807f1b7f86">inode_t::mode</a></div><div class="ttdeci">mode_t mode</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00092">ext2.h:92</a></div></div>
<div class="ttc" id="astructinode__t_html_abcde5f0fce4e39254b0e25c32998cf88"><div class="ttname"><a href="structinode__t.html#abcde5f0fce4e39254b0e25c32998cf88">inode_t::uid</a></div><div class="ttdeci">uint16_t uid</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00093">ext2.h:93</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00719">_ext2_add_child()</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8h_source.html#l00100">inode_t::links_count</a>, <a class="el" href="ext2_8h_source.html#l00092">inode_t::mode</a>, <a class="el" href="edit_2main_8c_source.html#l00018">mode</a>, and <a class="el" href="ext2_8h_source.html#l00093">inode_t::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00907">ext2_mkdir()</a>.</p>

</div>
</div>
<a id="a6cbb4be04e6f984153ad2aac024bd836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cbb4be04e6f984153ad2aac024bd836">&#9670;&nbsp;</a></span>_ext2_setup_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _ext2_setup_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>FILE FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00786">786</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;{</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    file-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#a1c4f9ec5d915951d176c80807f1b7f86">mode</a> = <a class="code" href="edit_2main_8c.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    file-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#abcde5f0fce4e39254b0e25c32998cf88">uid</a> = 0; <span class="comment">// FIXME: uid of real user</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    file-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a> = 0;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    file-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a> = 0;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    file-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">size</a> = 0;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(file, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;}</div>
<div class="ttc" id="astructinode__t_html_ac49d528d08a3a85cc264653680b1715d"><div class="ttname"><a href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">inode_t::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00094">ext2.h:94</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8h_source.html#l00100">inode_t::links_count</a>, <a class="el" href="ext2_8h_source.html#l00092">inode_t::mode</a>, <a class="el" href="edit_2main_8c_source.html#l00018">mode</a>, <a class="el" href="ext2_8h_source.html#l00094">inode_t::size</a>, and <a class="el" href="ext2_8h_source.html#l00093">inode_t::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00993">ext2_create()</a>.</p>

</div>
</div>
<a id="ac3ba5958992cad0916f5c5cde7da082b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3ba5958992cad0916f5c5cde7da082b">&#9670;&nbsp;</a></span>_ext2_write_to_dev()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _ext2_write_to_dev </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00127">127</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    void (*<a class="code" href="syscalls_8c.html#a4b18d2ebe6f1360b6e70b51d90f89ff9">read</a>)(<a class="code" href="structdevice__t.html">device_t</a> * d, <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> s, <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> * r) = <a class="code" href="driver__manager_8h.html#a621ce2927c9942fb5588924a08eb344f">drivers</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#aff7ef7ad8994221acb6b96c25dd207a8">driver_id</a>].<a class="code" href="structdriver__t.html#a1e42c2d6b8552290bbf31e6bf1b8fe46">desc</a>.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#a6e15d86e8592a28700f6b16c38b08999a4f85aa71fa1b138e3a56545bc4f92d3e">DRIVER_STORAGE_READ</a>];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    void (*<a class="code" href="syscalls_8c.html#aa83b64b3bf5f26dbb15d064001ef8654">write</a>)(<a class="code" href="structdevice__t.html">device_t</a> * d, <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> s, <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> * r, <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> siz) = <a class="code" href="driver__manager_8h.html#a621ce2927c9942fb5588924a08eb344f">drivers</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#aff7ef7ad8994221acb6b96c25dd207a8">driver_id</a>].<a class="code" href="structdriver__t.html#a1e42c2d6b8552290bbf31e6bf1b8fe46">desc</a>.<a class="code" href="structdriver__desc__t.html#ae4bb8f8c3f01526c738dd9db7a195c2e">functions</a>[<a class="code" href="driver__manager_8h.html#a6e15d86e8592a28700f6b16c38b08999a0117369dd06fed342ac671572ea39829">DRIVER_STORAGE_WRITE</a>];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">int</span> already_written = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> sector = start / 512;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start_offset = start % 512;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> tmp_buf[512];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    while (len != 0) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span> (start_offset != 0 || len &lt; 512) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <a class="code" href="syscalls_8c.html#a4b18d2ebe6f1360b6e70b51d90f89ff9">read</a>(dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>, sector, tmp_buf);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(512 - start_offset, len); i++) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            tmp_buf[start_offset + i] = <a class="code" href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a>[already_written++];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="syscalls_8c.html#aa83b64b3bf5f26dbb15d064001ef8654">write</a>(dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>, sector, tmp_buf, 512);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        len -= <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(512 - start_offset, len);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        sector++;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        start_offset = 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="ttc" id="adriver__manager_8h_html_a6e15d86e8592a28700f6b16c38b08999a0117369dd06fed342ac671572ea39829"><div class="ttname"><a href="driver__manager_8h.html#a6e15d86e8592a28700f6b16c38b08999a0117369dd06fed342ac671572ea39829">DRIVER_STORAGE_WRITE</a></div><div class="ttdeci">@ DRIVER_STORAGE_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00062">driver_manager.h:62</a></div></div>
<div class="ttc" id="asyscalls_8c_html_aa83b64b3bf5f26dbb15d064001ef8654"><div class="ttname"><a href="syscalls_8c.html#aa83b64b3bf5f26dbb15d064001ef8654">write</a></div><div class="ttdeci">int write(int fd, const void *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> <a href="syscalls_8c_source.html#l00029">syscalls.c:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cat_2main_8c_source.html#l00004">buf</a>, <a class="el" href="driver__manager_8h_source.html#l00133">driver_t::desc</a>, <a class="el" href="vfs_8h_source.html#l00036">vfs_device_t::dev</a>, <a class="el" href="driver__manager_8h_source.html#l00154">device_t::driver_id</a>, <a class="el" href="driver__manager_8h_source.html#l00061">DRIVER_STORAGE_READ</a>, <a class="el" href="driver__manager_8h_source.html#l00062">DRIVER_STORAGE_WRITE</a>, <a class="el" href="driver__manager_8c_source.html#l00011">drivers</a>, <a class="el" href="driver__manager_8h_source.html#l00127">driver_desc_t::functions</a>, <a class="el" href="ext2_8c_source.html#l00018">MIN</a>, <a class="el" href="syscalls_8c_source.html#l00024">read()</a>, and <a class="el" href="syscalls_8c_source.html#l00029">write()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l00613">_ext2_add_first_entry_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00636">_ext2_add_to_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00292">_ext2_find_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00377">_ext2_find_free_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00322">_ext2_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00407">_ext2_free_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00683">_ext2_rm_from_dir_block()</a>, <a class="el" href="ext2_8c_source.html#l00247">_ext2_set_block_of_inode_lev0()</a>, <a class="el" href="ext2_8c_source.html#l01069">ext2_save_state()</a>, <a class="el" href="ext2_8c_source.html#l00838">ext2_write()</a>, and <a class="el" href="ext2_8c_source.html#l00367">ext2_write_inode()</a>.</p>

</div>
</div>
<a id="a2f9641eb2a873250a030dfd41443d468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9641eb2a873250a030dfd41443d468">&#9670;&nbsp;</a></span>ext2_can_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> ext2_can_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>API FUNTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00801">801</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;{</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a279e146e9f96ba49c1d85c0f589f3012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a279e146e9f96ba49c1d85c0f589f3012">&#9670;&nbsp;</a></span>ext2_can_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> ext2_can_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00806">806</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;{</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="aa24305353f6388284ec90083dd756cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa24305353f6388284ec90083dd756cce">&#9670;&nbsp;</a></span>ext2_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00993">993</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;{</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> new_file_inode_indx = 0;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a000b110135cd9e8c7bf6bd51ab3cd88d">_ext2_allocate_inode_index</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, &amp;new_file_inode_indx, 0) &lt; 0) {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="structdentry.html">dentry_t</a>* new_file = <a class="code" href="vfs_8h.html#ac0aedc0c189c361d51354aa240ee4e30">dentry_get</a>(dir-&gt;<a class="code" href="structdentry.html#a5f1758d4cfa6f2d5d746de2192f61338">dev_indx</a>, new_file_inode_indx);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a6cbb4be04e6f984153ad2aac024bd836">_ext2_setup_file</a>(new_file, <a class="code" href="edit_2main_8c.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>) &lt; 0) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="vfs_8h.html#a7b69e608ff6502aa7604cb61d1e85d3e">dentry_put</a>(new_file);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a0faa31a843f1591fbb073e00a9653e2c">_ext2_add_child</a>(dir, new_file, <a class="code" href="namespacecopy__bin.html#ac19e0622db9715c974b893fdb8327374">name</a>, len) &lt; 0) {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <a class="code" href="vfs_8h.html#a7b69e608ff6502aa7604cb61d1e85d3e">dentry_put</a>(new_file);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="vfs_8h.html#a7b69e608ff6502aa7604cb61d1e85d3e">dentry_put</a>(new_file);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a000b110135cd9e8c7bf6bd51ab3cd88d"><div class="ttname"><a href="ext2_8c.html#a000b110135cd9e8c7bf6bd51ab3cd88d">_ext2_allocate_inode_index</a></div><div class="ttdeci">static int _ext2_allocate_inode_index(vfs_device_t *dev, fsdata_t fsdata, uint32_t *inode_index, uint32_t pref_group)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00393">ext2.c:393</a></div></div>
<div class="ttc" id="aext2_8c_html_a6cbb4be04e6f984153ad2aac024bd836"><div class="ttname"><a href="ext2_8c.html#a6cbb4be04e6f984153ad2aac024bd836">_ext2_setup_file</a></div><div class="ttdeci">static int _ext2_setup_file(dentry_t *file, mode_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00786">ext2.c:786</a></div></div>
<div class="ttc" id="astructdentry_html_a5f1758d4cfa6f2d5d746de2192f61338"><div class="ttname"><a href="structdentry.html#a5f1758d4cfa6f2d5d746de2192f61338">dentry::dev_indx</a></div><div class="ttdeci">uint32_t dev_indx</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00061">vfs.h:61</a></div></div>
<div class="ttc" id="avfs_8h_html_a7b69e608ff6502aa7604cb61d1e85d3e"><div class="ttname"><a href="vfs_8h.html#a7b69e608ff6502aa7604cb61d1e85d3e">dentry_put</a></div><div class="ttdeci">void dentry_put(dentry_t *dentry)</div><div class="ttdef"><b>Definition:</b> <a href="dentry_8c_source.html#l00301">dentry.c:301</a></div></div>
<div class="ttc" id="avfs_8h_html_ac0aedc0c189c361d51354aa240ee4e30"><div class="ttname"><a href="vfs_8h.html#ac0aedc0c189c361d51354aa240ee4e30">dentry_get</a></div><div class="ttdeci">dentry_t * dentry_get(uint32_t dev_indx, uint32_t inode_indx)</div><div class="ttdef"><b>Definition:</b> <a href="dentry_8c_source.html#l00240">dentry.c:240</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00719">_ext2_add_child()</a>, <a class="el" href="ext2_8c_source.html#l00393">_ext2_allocate_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00786">_ext2_setup_file()</a>, <a class="el" href="dentry_8c_source.html#l00240">dentry_get()</a>, <a class="el" href="dentry_8c_source.html#l00301">dentry_put()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00061">dentry::dev_indx</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00031">ENOSPC</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="edit_2main_8c_source.html#l00018">mode</a>, and <a class="el" href="copy__bin_8py_source.html#l00071">copy_bin::name</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a7c32c3efd30eb011e40b944d06f623fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c32c3efd30eb011e40b944d06f623fa">&#9670;&nbsp;</a></span>ext2_free_inode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_free_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00423">423</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="kassert_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a5d1923813933d33cedb7df4aaee6cf84">d_count</a> == 0 &amp;&amp; <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a> == 0);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_per_dir = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">/* freeing all data blocks */</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> block_index = 0; block_index &lt; block_per_dir; block_index++) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> data_block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(<a class="code" href="structdentry.html">dentry</a>, block_index);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="ext2_8c.html#a60e86ceec6ee897d1b22846bddca0735">_ext2_free_block_index</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, data_block_index);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="ext2_8c.html#a9a92f28e05901682f9a46e7a111dc972">_ext2_free_inode_index</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a60e86ceec6ee897d1b22846bddca0735"><div class="ttname"><a href="ext2_8c.html#a60e86ceec6ee897d1b22846bddca0735">_ext2_free_block_index</a></div><div class="ttdeci">static int _ext2_free_block_index(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00322">ext2.c:322</a></div></div>
<div class="ttc" id="aext2_8c_html_a9a92f28e05901682f9a46e7a111dc972"><div class="ttname"><a href="ext2_8c.html#a9a92f28e05901682f9a46e7a111dc972">_ext2_free_inode_index</a></div><div class="ttdeci">static int _ext2_free_inode_index(vfs_device_t *dev, fsdata_t fsdata, uint32_t inode_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00407">ext2.c:407</a></div></div>
<div class="ttc" id="astructdentry_html_a5d1923813933d33cedb7df4aaee6cf84"><div class="ttname"><a href="structdentry.html#a5d1923813933d33cedb7df4aaee6cf84">dentry::d_count</a></div><div class="ttdeci">uint32_t d_count</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00055">vfs.h:55</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00322">_ext2_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00407">_ext2_free_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="kassert_8h_source.html#l00016">ASSERT</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00055">dentry::d_count</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="vfs_8h_source.html#l00057">dentry::inode_indx</a>, <a class="el" href="ext2_8h_source.html#l00100">inode_t::links_count</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="af469c45b66b3d1f8d9e05927d99e0f09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af469c45b66b3d1f8d9e05927d99e0f09">&#9670;&nbsp;</a></span>ext2_getdents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_getdents </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00967">967</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;{</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start_block_index = *offset / block_len;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> end_block_index = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> read_offset = *offset % block_len;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> already_read = 0;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index = start_block_index; block_index &lt; end_block_index; block_index++) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> data_block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(<a class="code" href="structdentry.html">dentry</a>, block_index);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> read_from_block = <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(len, block_len - read_offset);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordtype">int</span> act_read = <a class="code" href="ext2_8c.html#ac9c672e0f12ef73f108d8a5fb70777cc">_ext2_getdents_block</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, data_block_index, <a class="code" href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a> + already_read, read_from_block, read_offset, offset);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">if</span> (act_read &lt; 0) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (already_read == 0) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">return</span> act_read;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">return</span> already_read;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        len -= act_read;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        already_read += act_read;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        read_offset = 0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">return</span> already_read;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_ac9c672e0f12ef73f108d8a5fb70777cc"><div class="ttname"><a href="ext2_8c.html#ac9c672e0f12ef73f108d8a5fb70777cc">_ext2_getdents_block</a></div><div class="ttdeci">static int _ext2_getdents_block(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index, uint8_t *buf, uint32_t len, uint32_t inner_offset, uint32_t *scanned_bytes)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00569">ext2.c:569</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00569">_ext2_getdents_block()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="cat_2main_8c_source.html#l00004">buf</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8c_source.html#l00018">MIN</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a54fdc6187e3300f1bfe12f6d82e3f559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54fdc6187e3300f1bfe12f6d82e3f559">&#9670;&nbsp;</a></span>ext2_getdirent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_getdirent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#a6673e8f64ca9ebd7e26e6289dca06e87">dirent_t</a> *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00949">949</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;{</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blocks_per_dir = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (*offset &gt;= blocks_per_dir * block_len) {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index = *offset / block_len; block_index &lt; blocks_per_dir; block_index++) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> data_block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(dir, block_index);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#ad272a83ae1e6d86a1ec0964a65f5a59b">_ext2_getdirent_block</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, data_block_index, offset, res) == 0) {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_ad272a83ae1e6d86a1ec0964a65f5a59b"><div class="ttname"><a href="ext2_8c.html#ad272a83ae1e6d86a1ec0964a65f5a59b">_ext2_getdirent_block</a></div><div class="ttdeci">static int _ext2_getdirent_block(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index, uint32_t *offset, dirent_t *dirent)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00483">ext2.c:483</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00483">_ext2_getdirent_block()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

</div>
</div>
<a id="a38a0c0c0c270fd71c7de3952d8423b06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38a0c0c0c270fd71c7de3952d8423b06">&#9670;&nbsp;</a></span>ext2_install()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ext2_install </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l01135">1135</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;{</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <a class="code" href="driver__manager_8h.html#a07f0227062aa3bd216d5d0f4dada2ae1">driver_install</a>(<a class="code" href="ext2_8c.html#a68189b69db6004f957e788bffd642c02">_ext2_driver_info</a>());</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;}</div>
<div class="ttc" id="adriver__manager_8h_html_a07f0227062aa3bd216d5d0f4dada2ae1"><div class="ttname"><a href="driver__manager_8h.html#a07f0227062aa3bd216d5d0f4dada2ae1">driver_install</a></div><div class="ttdeci">void driver_install(driver_desc_t t_driver_info)</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8c_source.html#l00062">driver_manager.c:62</a></div></div>
<div class="ttc" id="aext2_8c_html_a68189b69db6004f957e788bffd642c02"><div class="ttname"><a href="ext2_8c.html#a68189b69db6004f957e788bffd642c02">_ext2_driver_info</a></div><div class="ttdeci">driver_desc_t _ext2_driver_info()</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l01099">ext2.c:1099</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>, and <a class="el" href="driver__manager_8c_source.html#l00062">driver_install()</a>.</p>

<p class="reference">Referenced by <a class="el" href="kernel_8c_source.html#l00066">stage3()</a>.</p>

</div>
</div>
<a id="ab29c0a24de369a706d69663581a2ea12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab29c0a24de369a706d69663581a2ea12">&#9670;&nbsp;</a></span>ext2_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *&#160;</td>
          <td class="paramname"><em>res_inode_indx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00895">895</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;{</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_per_dir = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> block_index = 0; block_index &lt; block_per_dir; block_index++) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> data_block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(dir, block_index);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a64961e1b5f9327d4953795643913541d">_ext2_lookup_block</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, data_block_index, <a class="code" href="namespacecopy__bin.html#ac19e0622db9715c974b893fdb8327374">name</a>, len, res_inode_indx) == 0) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a03e689f378f643d16ea7537918528a48">ENOENT</a>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a64961e1b5f9327d4953795643913541d"><div class="ttname"><a href="ext2_8c.html#a64961e1b5f9327d4953795643913541d">_ext2_lookup_block</a></div><div class="ttdeci">static int _ext2_lookup_block(vfs_device_t *dev, fsdata_t fsdata, uint32_t block_index, const char *name, uint32_t len, uint32_t *found_inode_index)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00449">ext2.c:449</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00449">_ext2_lookup_block()</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="include_2errno_8h_source.html#l00005">ENOENT</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="copy__bin_8py_source.html#l00071">copy_bin::name</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a34240efebfff63f0423f654653322438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34240efebfff63f0423f654653322438">&#9670;&nbsp;</a></span>ext2_mkdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_mkdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ext2_8h.html#af456ddc19314d0bde5426f9027e96b05">mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00907">907</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;{</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> new_dir_inode_indx = 0;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a000b110135cd9e8c7bf6bd51ab3cd88d">_ext2_allocate_inode_index</a>(dir-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, dir-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, &amp;new_dir_inode_indx, 0) &lt; 0) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a088abe8bad2df798edad3053d719b937">ENOSPC</a>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="structdentry.html">dentry_t</a>* new_dir = <a class="code" href="vfs_8h.html#ac0aedc0c189c361d51354aa240ee4e30">dentry_get</a>(dir-&gt;<a class="code" href="structdentry.html#a5f1758d4cfa6f2d5d746de2192f61338">dev_indx</a>, new_dir_inode_indx);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#af460c141d44aae82274d4059e7498b33">_ext2_setup_dir</a>(new_dir, dir, <a class="code" href="edit_2main_8c.html#a6b29e4f37f4482274af785ad5ffe96a7">mode</a>) &lt; 0) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <a class="code" href="vfs_8h.html#a7b69e608ff6502aa7604cb61d1e85d3e">dentry_put</a>(new_dir);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a0faa31a843f1591fbb073e00a9653e2c">_ext2_add_child</a>(dir, new_dir, <a class="code" href="namespacecopy__bin.html#ac19e0622db9715c974b893fdb8327374">name</a>, len) &lt; 0) {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <a class="code" href="vfs_8h.html#a7b69e608ff6502aa7604cb61d1e85d3e">dentry_put</a>(new_dir);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="vfs_8h.html#a7b69e608ff6502aa7604cb61d1e85d3e">dentry_put</a>(new_dir);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_af460c141d44aae82274d4059e7498b33"><div class="ttname"><a href="ext2_8c.html#af460c141d44aae82274d4059e7498b33">_ext2_setup_dir</a></div><div class="ttdeci">static int _ext2_setup_dir(dentry_t *dir, dentry_t *parent_dir, mode_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00766">ext2.c:766</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00719">_ext2_add_child()</a>, <a class="el" href="ext2_8c_source.html#l00393">_ext2_allocate_inode_index()</a>, <a class="el" href="ext2_8c_source.html#l00766">_ext2_setup_dir()</a>, <a class="el" href="dentry_8c_source.html#l00240">dentry_get()</a>, <a class="el" href="dentry_8c_source.html#l00301">dentry_put()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00061">dentry::dev_indx</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00031">ENOSPC</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="edit_2main_8c_source.html#l00018">mode</a>, and <a class="el" href="copy__bin_8py_source.html#l00071">copy_bin::name</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="acc8e781247eb1304494ba6c63ea7673c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc8e781247eb1304494ba6c63ea7673c">&#9670;&nbsp;</a></span>ext2_prepare_fs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_prepare_fs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l01051">1051</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;{</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <a class="code" href="structsuperblock__t.html">superblock_t</a>* <a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a> = (<a class="code" href="structsuperblock__t.html">superblock_t</a>*)<a class="code" href="kmalloc_8h.html#afec98775e8113dc6d98f75a582c3646f">kmalloc</a>(<a class="code" href="ext2_8h.html#a7ad91ab9a5e5c3e063d493ca15116251">SUPERBLOCK_LEN</a>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>, <a class="code" href="ext2_8h.html#ac5a3192d315d69b7ab2a21ab206da32f">SUPERBLOCK_START</a>, <a class="code" href="ext2_8h.html#a7ad91ab9a5e5c3e063d493ca15116251">SUPERBLOCK_LEN</a>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">id</a>] = <a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="comment">// FIXME: for now we consider that we have at max 5 groups</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> groups_cnt = <a class="code" href="ext2_8c.html#a2417437958963f3126f55d048baaae81">_ext2_get_groups_cnt</a>(dev, <a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> group_table_len = groups_cnt * <a class="code" href="ext2_8h.html#af07772921e2371be82a282589dcf4fb2">GROUP_LEN</a>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <a class="code" href="structgroup__desc__t.html">group_desc_t</a>* group_table = (<a class="code" href="structgroup__desc__t.html">group_desc_t</a>*)<a class="code" href="kmalloc_8h.html#afec98775e8113dc6d98f75a582c3646f">kmalloc</a>(group_table_len);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)group_table, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>, 2), group_table_len);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <a class="code" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">id</a>].<a class="code" href="structgroups__info__t.html#a7a4ec228e9aaf2b41dae66b51f1dc98b">count</a> = groups_cnt;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">id</a>].<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a> = group_table;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a2417437958963f3126f55d048baaae81"><div class="ttname"><a href="ext2_8c.html#a2417437958963f3126f55d048baaae81">_ext2_get_groups_cnt</a></div><div class="ttdeci">static int _ext2_get_groups_cnt(vfs_device_t *dev, superblock_t *sb)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00183">ext2.c:183</a></div></div>
<div class="ttc" id="aext2_8c_html_a6c340d3dfe4969f99eb5ed2baf3619de"><div class="ttname"><a href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a></div><div class="ttdeci">static superblock_t * _ext2_superblocks[MAX_DEVICES_COUNT]</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00025">ext2.c:25</a></div></div>
<div class="ttc" id="aext2_8c_html_a8846e2ec0e42b40c79882f9de64c542c"><div class="ttname"><a href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a></div><div class="ttdeci">static groups_info_t _ext2_group_table_info[MAX_DEVICES_COUNT]</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00026">ext2.c:26</a></div></div>
<div class="ttc" id="aext2_8h_html_a7ad91ab9a5e5c3e063d493ca15116251"><div class="ttname"><a href="ext2_8h.html#a7ad91ab9a5e5c3e063d493ca15116251">SUPERBLOCK_LEN</a></div><div class="ttdeci">#define SUPERBLOCK_LEN</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00007">ext2.h:7</a></div></div>
<div class="ttc" id="aext2_8h_html_af07772921e2371be82a282589dcf4fb2"><div class="ttname"><a href="ext2_8h.html#af07772921e2371be82a282589dcf4fb2">GROUP_LEN</a></div><div class="ttdeci">#define GROUP_LEN</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00053">ext2.h:53</a></div></div>
<div class="ttc" id="aext2__lite_8c_html_a5139f4835903bb5500b4baf891c4c514"><div class="ttname"><a href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a></div><div class="ttdeci">superblock_t superblock</div><div class="ttdef"><b>Definition:</b> <a href="ext2__lite_8c_source.html#l00008">ext2_lite.c:8</a></div></div>
<div class="ttc" id="akmalloc_8h_html_afec98775e8113dc6d98f75a582c3646f"><div class="ttname"><a href="kmalloc_8h.html#afec98775e8113dc6d98f75a582c3646f">kmalloc</a></div><div class="ttdeci">void * kmalloc(uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="kmalloc_8c_source.html#l00053">kmalloc.c:53</a></div></div>
<div class="ttc" id="astructdevice__t_html_adc38f6c9096a1b37257a93ac547733ea"><div class="ttname"><a href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">device_t::id</a></div><div class="ttdeci">uint8_t id</div><div class="ttdef"><b>Definition:</b> <a href="driver__manager_8h_source.html#l00151">driver_manager.h:151</a></div></div>
<div class="ttc" id="astructgroup__desc__t_html"><div class="ttname"><a href="structgroup__desc__t.html">group_desc_t</a></div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00054">ext2.h:54</a></div></div>
<div class="ttc" id="astructgroups__info__t_html_a7a4ec228e9aaf2b41dae66b51f1dc98b"><div class="ttname"><a href="structgroups__info__t.html#a7a4ec228e9aaf2b41dae66b51f1dc98b">groups_info_t::count</a></div><div class="ttdeci">uint32_t count</div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00025">vfs.h:25</a></div></div>
<div class="ttc" id="astructsuperblock__t_html"><div class="ttname"><a href="structsuperblock__t.html">superblock_t</a></div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00008">ext2.h:8</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00183">_ext2_get_groups_cnt()</a>, <a class="el" href="ext2_8c_source.html#l00026">_ext2_group_table_info</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00025">_ext2_superblocks</a>, <a class="el" href="vfs_8h_source.html#l00025">groups_info_t::count</a>, <a class="el" href="vfs_8h_source.html#l00036">vfs_device_t::dev</a>, <a class="el" href="ext2_8h_source.html#l00053">GROUP_LEN</a>, <a class="el" href="driver__manager_8h_source.html#l00151">device_t::id</a>, <a class="el" href="kmalloc_8c_source.html#l00053">kmalloc()</a>, <a class="el" href="ext2__lite_8c_source.html#l00008">superblock</a>, <a class="el" href="ext2_8h_source.html#l00007">SUPERBLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00006">SUPERBLOCK_START</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a64fe803fc3ab33869ac2582343983b0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64fe803fc3ab33869ac2582343983b0d">&#9670;&nbsp;</a></span>ext2_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00811">811</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;{</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blocks_allocated = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start_block_index = start / block_len;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> end_block_index = <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>((start + len - 1) / block_len, blocks_allocated - 1);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">if</span> (start &gt;= <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">size</a>) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> have_to_read = <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(len, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">size</a> - start);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> read_offset = start % block_len;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> already_read = 0;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> virt_block_index = start_block_index; virt_block_index &lt;= end_block_index; virt_block_index++) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> data_block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(<a class="code" href="structdentry.html">dentry</a>, virt_block_index);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> read_from_block = <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(have_to_read, block_len - read_offset);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, <a class="code" href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a> + already_read, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, data_block_index) + read_offset, read_from_block);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        have_to_read -= read_from_block;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        already_read += read_from_block;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        read_offset = 0;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">return</span> already_read;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="cat_2main_8c_source.html#l00004">buf</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8c_source.html#l00018">MIN</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, <a class="el" href="ext2_8h_source.html#l00094">inode_t::size</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a703c7959974a4f4009258351a3d43f9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a703c7959974a4f4009258351a3d43f9a">&#9670;&nbsp;</a></span>ext2_read_inode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_read_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>INODE FUNCTIONS </p>

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00357">357</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;{</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inodes_per_group = <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>-&gt;<a class="code" href="structsuperblock__t.html#a9c53c3bf74e319bf4fe60313d2afe456">inodes_per_group</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> holder_group = (<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a> - 1) / inodes_per_group;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> pos_inside_group = (<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a> - 1) % inodes_per_group;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_start = <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[holder_group].<a class="code" href="structgroup__desc__t.html#a1b9397f4fd42ddb4dc13d323ac642383">inode_table</a>) + (pos_inside_group * <a class="code" href="ext2_8h.html#a0ee19d50310bec0d74d03a156333b75c">INODE_LEN</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>, inode_start, <a class="code" href="ext2_8h.html#a0ee19d50310bec0d74d03a156333b75c">INODE_LEN</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="ttc" id="aext2_8h_html_a0ee19d50310bec0d74d03a156333b75c"><div class="ttname"><a href="ext2_8h.html#a0ee19d50310bec0d74d03a156333b75c">INODE_LEN</a></div><div class="ttdeci">#define INODE_LEN</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00089">ext2.h:89</a></div></div>
<div class="ttc" id="astructgroup__desc__t_html_a1b9397f4fd42ddb4dc13d323ac642383"><div class="ttname"><a href="structgroup__desc__t.html#a1b9397f4fd42ddb4dc13d323ac642383">group_desc_t::inode_table</a></div><div class="ttdeci">uint32_t inode_table</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00057">ext2.h:57</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="vfs_8h_source.html#l00057">dentry::inode_indx</a>, <a class="el" href="ext2_8h_source.html#l00089">INODE_LEN</a>, <a class="el" href="ext2_8h_source.html#l00057">group_desc_t::inode_table</a>, <a class="el" href="ext2_8h_source.html#l00019">superblock_t::inodes_per_group</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a419165b0f0b008a55f349facad9ad035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419165b0f0b008a55f349facad9ad035">&#9670;&nbsp;</a></span>ext2_recognize_drive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="include_2types_8h.html#ad5c9d4ba3dc37783a528b0925dc981a0">bool</a> ext2_recognize_drive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l01032">1032</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;{</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="structsuperblock__t.html">superblock_t</a>* <a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a> = (<a class="code" href="structsuperblock__t.html">superblock_t</a>*)<a class="code" href="kmalloc_8h.html#afec98775e8113dc6d98f75a582c3646f">kmalloc</a>(<a class="code" href="ext2_8h.html#a7ad91ab9a5e5c3e063d493ca15116251">SUPERBLOCK_LEN</a>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="ext2_8c.html#a2c62a613f06d8c74885169dfb8cfc3fd">_ext2_read_from_dev</a>(dev, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>, <a class="code" href="ext2_8h.html#ac5a3192d315d69b7ab2a21ab206da32f">SUPERBLOCK_START</a>, <a class="code" href="ext2_8h.html#a7ad91ab9a5e5c3e063d493ca15116251">SUPERBLOCK_LEN</a>);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>-&gt;<a class="code" href="structsuperblock__t.html#a0ec18b1cbae8685174af1119d4601ed0">magic</a> != 0xEF53) {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <a class="code" href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>-&gt;<a class="code" href="structsuperblock__t.html#aa814b082d917c22ad67cb325d1745e5c">rev_level</a> != 0) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <a class="code" href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;}</div>
<div class="ttc" id="akmalloc_8h_html_a069f85a5001d71bc44d8be6532a4e432"><div class="ttname"><a href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a></div><div class="ttdeci">void kfree(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="kmalloc_8c_source.html#l00087">kmalloc.c:87</a></div></div>
<div class="ttc" id="astructsuperblock__t_html_a0ec18b1cbae8685174af1119d4601ed0"><div class="ttname"><a href="structsuperblock__t.html#a0ec18b1cbae8685174af1119d4601ed0">superblock_t::magic</a></div><div class="ttdeci">uint16_t magic</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00024">ext2.h:24</a></div></div>
<div class="ttc" id="astructsuperblock__t_html_aa814b082d917c22ad67cb325d1745e5c"><div class="ttname"><a href="structsuperblock__t.html#aa814b082d917c22ad67cb325d1745e5c">superblock_t::rev_level</a></div><div class="ttdeci">uint32_t rev_level</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00031">ext2.h:31</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00108">_ext2_read_from_dev()</a>, <a class="el" href="kmalloc_8c_source.html#l00087">kfree()</a>, <a class="el" href="kmalloc_8c_source.html#l00053">kmalloc()</a>, <a class="el" href="ext2_8h_source.html#l00024">superblock_t::magic</a>, <a class="el" href="ext2_8h_source.html#l00031">superblock_t::rev_level</a>, <a class="el" href="ext2__lite_8c_source.html#l00008">superblock</a>, <a class="el" href="ext2_8h_source.html#l00007">SUPERBLOCK_LEN</a>, and <a class="el" href="ext2_8h_source.html#l00006">SUPERBLOCK_START</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a3cc615c816967a8ac853a662bdeb1c31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cc615c816967a8ac853a662bdeb1c31">&#9670;&nbsp;</a></span>ext2_rm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_rm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l01015">1015</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;{</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="structdentry.html">dentry_t</a>* parent_dir = <a class="code" href="vfs_8h.html#af3851d9466c6d7064d13a78c766dffa9">dentry_get_parent</a>(<a class="code" href="structdentry.html">dentry</a>);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (!parent_dir) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#add669d31505a077f769cff8e66c780b3">EPERM</a>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a0311646294c6138b27500d83485e5c68">_ext2_rm_child</a>(parent_dir, <a class="code" href="structdentry.html">dentry</a>) &lt; 0) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="log_8h.html#a5ed8e2adc6340d877478a62cc1d448c9">log</a>(<span class="stringliteral">&quot;free from ext2&quot;</span>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a0311646294c6138b27500d83485e5c68"><div class="ttname"><a href="ext2_8c.html#a0311646294c6138b27500d83485e5c68">_ext2_rm_child</a></div><div class="ttdeci">static int _ext2_rm_child(dentry_t *dir, dentry_t *child_dentry)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00748">ext2.c:748</a></div></div>
<div class="ttc" id="ainclude_2errno_8h_html_add669d31505a077f769cff8e66c780b3"><div class="ttname"><a href="include_2errno_8h.html#add669d31505a077f769cff8e66c780b3">EPERM</a></div><div class="ttdeci">#define EPERM</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00004">errno.h:4</a></div></div>
<div class="ttc" id="alog_8h_html_a5ed8e2adc6340d877478a62cc1d448c9"><div class="ttname"><a href="log_8h.html#a5ed8e2adc6340d877478a62cc1d448c9">log</a></div><div class="ttdeci">void log(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8c_source.html#l00062">log.c:62</a></div></div>
<div class="ttc" id="avfs_8h_html_af3851d9466c6d7064d13a78c766dffa9"><div class="ttname"><a href="vfs_8h.html#af3851d9466c6d7064d13a78c766dffa9">dentry_get_parent</a></div><div class="ttdeci">dentry_t * dentry_get_parent(dentry_t *dentry)</div><div class="ttdef"><b>Definition:</b> <a href="dentry_8c_source.html#l00207">dentry.c:207</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00748">_ext2_rm_child()</a>, <a class="el" href="dentry_8c_source.html#l00207">dentry_get_parent()</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00004">EPERM</a>, and <a class="el" href="log_8c_source.html#l00062">log()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="ae66f0545307215e9e8ea5f72c5c2ec73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f0545307215e9e8ea5f72c5c2ec73">&#9670;&nbsp;</a></span>ext2_rmdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_rmdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00929">929</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="structdentry.html">dentry_t</a>* parent_dir = <a class="code" href="vfs_8h.html#af3851d9466c6d7064d13a78c766dffa9">dentry_get_parent</a>(dir);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">if</span> (!parent_dir) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#add669d31505a077f769cff8e66c780b3">EPERM</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a8271c1d7d78c99f592b0c345552b4fae">_ext2_is_dir_empty</a>(dir)) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ext2_8c.html#a0311646294c6138b27500d83485e5c68">_ext2_rm_child</a>(parent_dir, dir) &lt; 0) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#a3f317946e043623f9d6b93dbf60e6316">EFAULT</a>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        parent_dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a>--;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        dir-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aca3a2f4920013eac77abb86c0eeaab1d">links_count</a>--;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="include_2errno_8h.html#aa0f602f3fd369a6fede82190710b9c5c">ENOTEMPTY</a>;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div>
<div class="ttc" id="aext2_8c_html_a8271c1d7d78c99f592b0c345552b4fae"><div class="ttname"><a href="ext2_8c.html#a8271c1d7d78c99f592b0c345552b4fae">_ext2_is_dir_empty</a></div><div class="ttdeci">static bool _ext2_is_dir_empty(dentry_t *dir)</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8c_source.html#l00541">ext2.c:541</a></div></div>
<div class="ttc" id="ainclude_2errno_8h_html_aa0f602f3fd369a6fede82190710b9c5c"><div class="ttname"><a href="include_2errno_8h.html#aa0f602f3fd369a6fede82190710b9c5c">ENOTEMPTY</a></div><div class="ttdeci">#define ENOTEMPTY</div><div class="ttdef"><b>Definition:</b> <a href="include_2errno_8h_source.html#l00042">errno.h:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00541">_ext2_is_dir_empty()</a>, <a class="el" href="ext2_8c_source.html#l00748">_ext2_rm_child()</a>, <a class="el" href="dentry_8c_source.html#l00207">dentry_get_parent()</a>, <a class="el" href="include_2errno_8h_source.html#l00017">EFAULT</a>, <a class="el" href="include_2errno_8h_source.html#l00042">ENOTEMPTY</a>, <a class="el" href="include_2errno_8h_source.html#l00004">EPERM</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, and <a class="el" href="ext2_8h_source.html#l00100">inode_t::links_count</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a59d123a7cc9fbd1eaff190cc133c0d8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59d123a7cc9fbd1eaff190cc133c0d8d">&#9670;&nbsp;</a></span>ext2_save_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ext2_save_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvfs__device__t.html">vfs_device_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l01069">1069</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;{</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">id</a>]) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="structsuperblock__t.html">superblock_t</a>* <a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a> = <a class="code" href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">id</a>];</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">// FIXME: for now we consider that we have at max 5 groups</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> group_table_len = <a class="code" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">id</a>].<a class="code" href="structgroups__info__t.html#a7a4ec228e9aaf2b41dae66b51f1dc98b">count</a> * <a class="code" href="ext2_8h.html#af07772921e2371be82a282589dcf4fb2">GROUP_LEN</a>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="structgroup__desc__t.html">group_desc_t</a>* group_table = <a class="code" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a>[dev-&gt;<a class="code" href="structvfs__device__t.html#a7d55f55d8ecf251fc986269079650c2d">dev</a>-&gt;<a class="code" href="structdevice__t.html#adc38f6c9096a1b37257a93ac547733ea">id</a>].<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)group_table, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>, 2), group_table_len);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <a class="code" href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(group_table);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(dev, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>, <a class="code" href="ext2_8h.html#ac5a3192d315d69b7ab2a21ab206da32f">SUPERBLOCK_START</a>, <a class="code" href="ext2_8h.html#a7ad91ab9a5e5c3e063d493ca15116251">SUPERBLOCK_LEN</a>);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="kmalloc_8h.html#a069f85a5001d71bc44d8be6532a4e432">kfree</a>(<a class="code" href="ext2__lite_8c.html#a5139f4835903bb5500b4baf891c4c514">superblock</a>);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00026">_ext2_group_table_info</a>, <a class="el" href="ext2_8c_source.html#l00025">_ext2_superblocks</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="vfs_8h_source.html#l00025">groups_info_t::count</a>, <a class="el" href="vfs_8h_source.html#l00036">vfs_device_t::dev</a>, <a class="el" href="ext2_8h_source.html#l00053">GROUP_LEN</a>, <a class="el" href="driver__manager_8h_source.html#l00151">device_t::id</a>, <a class="el" href="kmalloc_8c_source.html#l00087">kfree()</a>, <a class="el" href="ext2__lite_8c_source.html#l00008">superblock</a>, <a class="el" href="ext2_8h_source.html#l00007">SUPERBLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00006">SUPERBLOCK_START</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a113c69847913746fb70fc1ecd5a1b21a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a113c69847913746fb70fc1ecd5a1b21a">&#9670;&nbsp;</a></span>ext2_truncate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_truncate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00872">872</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;{</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">size</a> &lt;= len) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> last_written_byte = len - 1;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> last_written_block_index = last_written_byte / block_len;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start_block_index = last_written_block_index + 1;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blocks_allocated = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_index, virt_block_index = start_block_index; virt_block_index &lt; blocks_allocated; virt_block_index++) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(<a class="code" href="structdentry.html">dentry</a>, virt_block_index);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <a class="code" href="ext2_8c.html#a60e86ceec6ee897d1b22846bddca0735">_ext2_free_block_index</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>, block_index);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">size</a> = len;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#adc55fcc7e4b0177e9a5dba4ccc73a4f5">mtime</a> = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="time__manager_8h.html#a0e5c110b97320485caab71ccf42bb142">timeman_now</a>();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div>
<div class="ttc" id="astructinode__t_html_adc55fcc7e4b0177e9a5dba4ccc73a4f5"><div class="ttname"><a href="structinode__t.html#adc55fcc7e4b0177e9a5dba4ccc73a4f5">inode_t::mtime</a></div><div class="ttdeci">uint32_t mtime</div><div class="ttdef"><b>Definition:</b> <a href="ext2_8h_source.html#l00097">ext2.h:97</a></div></div>
<div class="ttc" id="atime__manager_8h_html_a0e5c110b97320485caab71ccf42bb142"><div class="ttname"><a href="time__manager_8h.html#a0e5c110b97320485caab71ccf42bb142">timeman_now</a></div><div class="ttdeci">time_t timeman_now()</div><div class="ttdef"><b>Definition:</b> <a href="time__manager_8c_source.html#l00087">time_manager.c:87</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00322">_ext2_free_block_index()</a>, <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8h_source.html#l00097">inode_t::mtime</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, <a class="el" href="ext2_8h_source.html#l00094">inode_t::size</a>, <a class="el" href="time__manager_8c_source.html#l00087">timeman_now()</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="acf8033fa3989cd6d8b9837e3dc597d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf8033fa3989cd6d8b9837e3dc597d90">&#9670;&nbsp;</a></span>ext2_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00838">838</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keyword">const</span> <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> block_len = <a class="code" href="ext2_8c.html#af11d5ade1069f3f4d7a086be6679b044">BLOCK_LEN</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start_block_index = start / block_len;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> end_block_index = (start + len) / block_len;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> write_offset = start % block_len;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> to_write = len;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> already_written = 0;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> blocks_allocated = <a class="code" href="ext2_8c.html#a9dc3a65e10750e9b6a798a7b54918186">TO_EXT_BLOCKS_CNT</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#aeba6143a372083aa4952c8c79fc4ffaa">blocks</a>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> data_block_index, virt_block_index = start_block_index; virt_block_index &lt;= end_block_index; virt_block_index++) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> write_to_block = <a class="code" href="ext2_8c.html#ad2f3678bf5eae3684fc497130b946eae">MIN</a>(to_write, block_len - write_offset);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span> (blocks_allocated &lt;= virt_block_index) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <a class="code" href="ext2_8c.html#ae7507c4468e3c71eb4494db81af7eaf8">_ext2_allocate_block_for_inode</a>(<a class="code" href="structdentry.html">dentry</a>, 0, &amp;data_block_index);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            data_block_index = <a class="code" href="ext2_8c.html#aa13178156da204b197f2dcc8e31491dd">_ext2_get_block_of_inode</a>(<a class="code" href="structdentry.html">dentry</a>, virt_block_index);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, <a class="code" href="cat_2main_8c.html#a78a05cf530dddc61e7a26aefe187bd31">buf</a> + already_written, <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, data_block_index) + write_offset, write_to_block);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        to_write -= write_to_block;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        already_written += write_to_block;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        write_offset = 0;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">size</a> &lt; start + len) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#ac49d528d08a3a85cc264653680b1715d">size</a> = start + len;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>-&gt;<a class="code" href="structinode__t.html#adc55fcc7e4b0177e9a5dba4ccc73a4f5">mtime</a> = (<a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)<a class="code" href="time__manager_8h.html#a0e5c110b97320485caab71ccf42bb142">timeman_now</a>();</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="vfs_8h.html#a7caf5229634e02f763b50829867068dc">dentry_set_flag</a>(<a class="code" href="structdentry.html">dentry</a>, <a class="code" href="vfs_8h.html#a6732bca494a9950526100a3f2605cbcc">DENTRY_DIRTY</a>);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">return</span> already_written;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00340">_ext2_allocate_block_for_inode()</a>, <a class="el" href="ext2_8c_source.html#l00233">_ext2_get_block_of_inode()</a>, <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="ext2_8c_source.html#l00021">BLOCK_LEN</a>, <a class="el" href="ext2_8h_source.html#l00101">inode_t::blocks</a>, <a class="el" href="cat_2main_8c_source.html#l00004">buf</a>, <a class="el" href="vfs_8h_source.html#l00048">DENTRY_DIRTY</a>, <a class="el" href="dentry_8c_source.html#l00325">dentry_set_flag()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="ext2_8c_source.html#l00018">MIN</a>, <a class="el" href="ext2_8h_source.html#l00097">inode_t::mtime</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, <a class="el" href="ext2_8h_source.html#l00094">inode_t::size</a>, <a class="el" href="time__manager_8c_source.html#l00087">timeman_now()</a>, and <a class="el" href="ext2_8c_source.html#l00022">TO_EXT_BLOCKS_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="a63fa3b1f3bc96fad36b7cbb92a8521f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63fa3b1f3bc96fad36b7cbb92a8521f3">&#9670;&nbsp;</a></span>ext2_write_inode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ext2_write_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00367">367</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inodes_per_group = <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>-&gt;<a class="code" href="structsuperblock__t.html#a9c53c3bf74e319bf4fe60313d2afe456">inodes_per_group</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> holder_group = (<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a> - 1) / inodes_per_group;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> pos_inside_group = (<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a7315cd079d1109369c66fe804b9fd4ba">inode_indx</a> - 1) % inodes_per_group;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="syscall__structs_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> inode_start = <a class="code" href="ext2_8c.html#aded8027a81d47374997ce986b9d058b2">_ext2_get_block_offset</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a>, <a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#ae7cb95c90d2b85eb198bf619bb55c4cc">fsdata</a>.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a>-&gt;<a class="code" href="structgroups__info__t.html#a35fd1f98830a3105431102d8d0465d73">table</a>[holder_group].<a class="code" href="structgroup__desc__t.html#a1b9397f4fd42ddb4dc13d323ac642383">inode_table</a>) + (pos_inside_group * <a class="code" href="ext2_8h.html#a0ee19d50310bec0d74d03a156333b75c">INODE_LEN</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="ext2_8c.html#ac3ba5958992cad0916f5c5cde7da082b">_ext2_write_to_dev</a>(<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa7900a1e668ca69caf3c1e309947e494">dev</a>, (<a class="code" href="syscall__structs_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>*)<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#aa570c7b3f7c32ef505901f3a3e2931b5">inode</a>, inode_start, <a class="code" href="ext2_8h.html#a0ee19d50310bec0d74d03a156333b75c">INODE_LEN</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00198">_ext2_get_block_offset()</a>, <a class="el" href="ext2_8c_source.html#l00127">_ext2_write_to_dev()</a>, <a class="el" href="vfs_8h_source.html#l00062">dentry::dev</a>, <a class="el" href="vfs_8h_source.html#l00059">dentry::fsdata</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, <a class="el" href="vfs_8h_source.html#l00058">dentry::inode</a>, <a class="el" href="vfs_8h_source.html#l00057">dentry::inode_indx</a>, <a class="el" href="ext2_8h_source.html#l00089">INODE_LEN</a>, <a class="el" href="ext2_8h_source.html#l00057">group_desc_t::inode_table</a>, <a class="el" href="ext2_8h_source.html#l00019">superblock_t::inodes_per_group</a>, <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>, and <a class="el" href="vfs_8h_source.html#l00026">groups_info_t::table</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<a id="abb5d5dd270e04331d926dc5ca9fda85f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5d5dd270e04331d926dc5ca9fda85f">&#9670;&nbsp;</a></span>get_fsdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfsdata__t.html">fsdata_t</a> get_fsdata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vfs_8h.html#adb8466457632801d904444d0c7e8c272">dentry_t</a> *&#160;</td>
          <td class="paramname"><em>dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l01087">1087</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="structfsdata__t.html">fsdata_t</a> fsdata;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    fsdata.<a class="code" href="structfsdata__t.html#a6cfecc1892722121091218778efc1a32">sb</a> = <a class="code" href="ext2_8c.html#a6c340d3dfe4969f99eb5ed2baf3619de">_ext2_superblocks</a>[<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a5f1758d4cfa6f2d5d746de2192f61338">dev_indx</a>];</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    fsdata.<a class="code" href="structfsdata__t.html#ab1102c361ef44bb00617f00fd4df9b6e">gt</a> = &amp;<a class="code" href="ext2_8c.html#a8846e2ec0e42b40c79882f9de64c542c">_ext2_group_table_info</a>[<a class="code" href="structdentry.html">dentry</a>-&gt;<a class="code" href="structdentry.html#a5f1758d4cfa6f2d5d746de2192f61338">dev_indx</a>];</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">return</span> fsdata;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;}</div>
<div class="ttc" id="astructfsdata__t_html"><div class="ttname"><a href="structfsdata__t.html">fsdata_t</a></div><div class="ttdef"><b>Definition:</b> <a href="vfs_8h_source.html#l00029">vfs.h:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8c_source.html#l00026">_ext2_group_table_info</a>, <a class="el" href="ext2_8c_source.html#l00025">_ext2_superblocks</a>, <a class="el" href="vfs_8h_source.html#l00061">dentry::dev_indx</a>, <a class="el" href="vfs_8h_source.html#l00031">fsdata_t::gt</a>, and <a class="el" href="vfs_8h_source.html#l00030">fsdata_t::sb</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01099">_ext2_driver_info()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8846e2ec0e42b40c79882f9de64c542c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8846e2ec0e42b40c79882f9de64c542c">&#9670;&nbsp;</a></span>_ext2_group_table_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structgroups__info__t.html">groups_info_t</a> _ext2_group_table_info[<a class="el" href="driver__manager_8h.html#a0cea68640d32312d57811eef08df8369">MAX_DEVICES_COUNT</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00026">26</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01051">ext2_prepare_fs()</a>, <a class="el" href="ext2_8c_source.html#l01069">ext2_save_state()</a>, and <a class="el" href="ext2_8c_source.html#l01087">get_fsdata()</a>.</p>

</div>
</div>
<a id="a6c340d3dfe4969f99eb5ed2baf3619de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c340d3dfe4969f99eb5ed2baf3619de">&#9670;&nbsp;</a></span>_ext2_superblocks</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsuperblock__t.html">superblock_t</a>* _ext2_superblocks[<a class="el" href="driver__manager_8h.html#a0cea68640d32312d57811eef08df8369">MAX_DEVICES_COUNT</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ext2_8c_source.html#l00025">25</a> of file <a class="el" href="ext2_8c_source.html">ext2.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8c_source.html#l01051">ext2_prepare_fs()</a>, <a class="el" href="ext2_8c_source.html#l01069">ext2_save_state()</a>, and <a class="el" href="ext2_8c_source.html#l01087">get_fsdata()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 26 2021 19:11:30 for oneOS by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
